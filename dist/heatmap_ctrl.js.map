{"version":3,"sources":["../src/heatmap_ctrl.js"],"names":["MetricsPanelCtrl","moment","_","HeatmapCtrl","$scope","$injector","$timeout","$interval","variableSrv","timeSrv","firstLoad","overviewModel","groupMarkerList","focusModel","groupList","initialiseConfig","initialisePanelDefaults","initialisePredefinedMetricOptionList","initialiseMetricsColorList","events","on","onInitEditMode","bind","onDataReceived","config","apiAddress","dateFormat","colorCount","maxLuminanceChange","marginBetweenOverviewAndFocus","startingGreyColor","endingGrayColor","sortOrder","intervalTimer","initialiseOverviewConfig","initialiseFocusAreaConfig","initialiseFocusGraphConfig","overview","topAndBottomPadding","metricFontSize","timeFontSize","marginBetweenLabelsAndOverview","decompressedPointWidth","compressedPointWidth","ungroupedPointHeight","groupedPointHeight","verticalMarginBetweenMetrics","horizontalMarginBetweenMetrics","marginBetweenGroups","groupBarWidth","singleAttributeGroupSizeWidth","multipleAttributeGroupSizeWidth","marginBetweenMarkerAndGroup","marginBetweenMetricAndGroupSize","focusArea","color","focusAreaSize","xCrossSize","focusGraph","maxWidth","maxHeight","groupedPointWidth","ungroupedPointWidth","metricMaxHeight","marginBetweenMetrics","panelDefaults","predefinedMetricList","name","query","defaults","panel","predefinedMetricOptionList","forEach","metric","push","metricList","colorList","luminanceChange","i","changeColorLuminance","hex","lum","String","replace","length","rgb","c","parseInt","substr","Math","round","min","max","toString","index","isCustom","predefinedMetric","JSON","parse","stringify","scope","elem","initialiseControl","initialiseUIElements","enumList","linkingMode","X_CROSS","NORMAL_CROSS","CHANGE_COLOR","groupingMode","SINGLE","MULTIPLE","isGrouped","initialiseOverviewCanvasCursor","overviewCursor","overviewCanvas","getElementByID","overviewContext","getCanvasContext","focusAreaCanvas","focusAreaContext","timeIndicatorCanvas","timeIndicatorContext","focusGraphWidth","focusGraphHeight","focusGraphContainer","id","find","canvas","getContext","addEditorTab","data","isUpdatingVariable","load","isLoading","$apply","loadCount","fromDate","getDateInSeconds","timeRange","from","_d","toDate","to","getDataFromAPI","processRawData","date","getTime","xmlHttp","XMLHttpRequest","onreadystatechange","readyState","status","responseText","result","url","encodeURIComponent","open","send","includes","convertDataToFloat","initialiseMetricMinMaxTotal","initialiseColorMap","initiliseOverviewData","initialiseOverviewGroups","initialiseCompressedTimeIndexes","renderOverview","instance","values","value","parseFloat","point","checkAndSetOverviewMinMax","layerRange","colorMap","getColorMap","Map","threshold","average","set","populateOverviewData","calculateInstanceMetricTotalMinMax","sortOverviewData","metricIndex","metricInstance","newInstance","search","initaliseNewInstance","total","getThresholdAverage","map","isBetween","target","start","end","sort","first","second","initialiseSingleAttributeGroups","initialiseMultiAttributeGroups","group","initialiseNewSingleAttributeGroups","instanceList","initialiseSingleAttributeGroupsColor","initialiseSingleAttributeInstanceGroupList","markerX","originalColor","groupIndex","initialiseNewMultiAttributeGroup","initialiseMultiAttributeGroupsColor","instanceMetric","groupMetric","colorStep","greyValue","overviewMetric","compressedTimeIndexList","initialiseInstanceCompressedTimeRangeList","compressedIndexRangeList","range","presviousRange","pointIndex","thresholdAverage","initialiseNewCompressedTimeRange","clearFocusArea","drawOverview","hasFocus","clearRect","width","height","setOverviewCanvasSize","focusGraphMarginTop","overviewCanvasHeight","drawOverviewData","setOverviewContextLabelFont","labelTextHeight","measureText","overviewStartY","setOverviewWidth","setOverviewHeight","setOverviewContextTimeFont","getDateString","toDateWidth","overviewWidth","isCompressed","getMaxMetricLength","overviewCanvasWidth","setGroupedOverviewCanvasWidth","instanceWithMostPoints","maxBy","getMaxGroupSizeBarLength","getMaxMultiAttributeGroupSize","largestGroup","groupCount","getMaxGroupCount","overviewHeight","metricWithMostGroups","font","overviewEndY","setOverviewMetricStartXAndEndX","drawGroupedOverview","drawUngroupedOverview","drawMetricLabels","drawToDateLabel","previousMetric","startX","endX","maxGroupSizeBarLength","overviewInstanceHeight","drawGroupOverviewWrapper","metricIndexList","getAllMetricIndexList","drawGroupSize","drawMetricSeparator","drawOverviewInstance","y","instanceIndex","pointHeight","marginBetweenInstances","endY","drawOverviewInstancePoints","rangeIndex","drawOverviewInstancePoint","pointWidth","x","getColorFromMap","fillStyle","fillRect","Array","keys","label","labelWidth","drawSingleAttributeGroupSize","drawMultipleAttributeGroupSize","drawGroupSizeWrapper","fillText","groupSizeWidth","startY","beginPath","moveTo","lineTo","closePath","fill","maxEndX","strokeStyle","stroke","drawGroupBars","drawGroupBarAtPosition","floor","format","drawFocusArea","changeGroupingSelection","isSelected","showFocus","evt","setOverviewMousePosition","hoveredGroup","hoveredMarker","found","checkMouseIsOnGroupAndSetGroupSelected","drawTimeIndicators","clearTimeIndicator","checkAndSetSelectedOverviewMarker","focusAreaIsFixed","drawFocus","mousePosition","getMousePos","rect","getBoundingClientRect","clientX","left","clientY","top","overviewIndex","selectedMetric","mousePositionXOffset","checkAndSetSelectedGroup","checkGroupIsSelected","markerIndex","marker","drawTimeIndicatorWrapper","drawSelectedTimeLabel","horizontalLineY","verticalLineX","compressedTimeIndex","checkSelectedPointAndDrawTimeLabel","addOrRemoveGroupToFocus","drawSelectedGroupsMarkers","startFocusMarkerInterval","stopInterval","drawFocusGraph","fixFocusArea","focusGroup","overviewGroup","remove","addGroupToFocus","overviewInstance","metricWithMostData","focusedIndexList","focusInstance","getFocusInstance","drawOverviewGroupMarker","focusGroupWithInterval","initialiseFocusMarkerInterval","stopOverviewMarkerInterval","stopFocusMarkerInterval","currentOverviewMarkerInterval","cancel","overviewGroupWithInterval","overviewMarkerX","overviewGroupWithIntervalList","currentFocusMarkerInterval","focusMarkerX","drawGroupFocusMarkers","focusMarkerMovingBackwards","handleFocusMarkerMovingBackwardCase","handleFocusMarkerMovingForwardCase","marginBetweenMarkers","checkMouseIsInMetric","size","getFocusAreaSize","minimumTopY","focusStartY","offset","getFocusAreaOffset","focusStartX","strokeRect","sourceMetricIndex","initialiseFocusGraphData","getFocusGraphPointWidth","focusGraphRow","focusRowHeight","offsetHeight","setFocusFromAndToDate","positionFocusFromAndToDate","drawFocusGraphData","autoSrollFocusGraph","checkInstanceInFocus","getIndexesOfPointsInFocus","indexes","indexList","initialiseFocusInstanceData","addFocusMetrics","initialiseInstanceLayers","focusMetric","layerList","layer","valueList","fromIndex","toIndex","focusedFromDate","focusedToDate","canvasStartX","offsetLeft","fromDateWidth","fromDateLeftMargin","toDateLeftMargin","focusGraphMarkerWidth","markerSize","focusGraphMarkerHeight","drawGroupedFocusGraph","drawUngroupedFocusGraph","showDetails","drawGroupedFocusMarker","context","groupWithMarkerList","instanceGroup","instanceGroupIndex","drawGroupedFocusMarkerWrapper","drawGroupedFocusGraphWrapper","drawFocusGraphInstance","layerIndex","previousX","previousValue","valueIndex","moveContextBasedOnValue","graphBeginX","rowCount","scrollTop","scrollByInstance","getHoveredInstance","focusModelInstance","startOverviewMarkerInterval","initialiseOverviewMarkerInterval","overviewMarkerMovingBackwards","handleOverviewMarkerMovingBackwardCase","handleOverviewMarkerMovingForwardCase","event","preventDefault","updateVariable","variables","v","setOptionAsCurrent","text","variableUpdated","templateUrl"],"mappings":"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","sourcesContent":["import { MetricsPanelCtrl } from \"app/plugins/sdk\";\nimport \"./heatmap.css!\";\nimport moment from \"moment\";\nimport _ from \"lodash\";\n\nexport class HeatmapCtrl extends MetricsPanelCtrl {\n    constructor($scope, $injector, $timeout, $interval, variableSrv, timeSrv) {\n        super($scope, $injector);\n        this.$timeout = $timeout;\n        this.$interval = $interval;\n        this.variableSrv = variableSrv;\n        this.timeSrv = timeSrv;\n\n        this.firstLoad = true;\n        this.overviewModel = {};\n        this.overviewModel.groupMarkerList = [];\n        this.focusModel = {};\n        this.focusModel.groupList = [];\n\n        this.initialiseConfig();\n        this.initialisePanelDefaults();\n        this.initialisePredefinedMetricOptionList();\n        this.initialiseMetricsColorList();\n\n        this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n        this.events.on(\"data-received\", this.onDataReceived.bind(this));\n    }\n\n    initialiseConfig() {\n        this.config = {\n            apiAddress: \"http://localhost:3000/api/datasources/proxy/1/api/v1/query_range?query=\",\n            dateFormat: \"DD/MM/YY HH:mm:ss\",\n            colorCount: 4,\n            maxLuminanceChange: 0.8,\n            marginBetweenOverviewAndFocus: 20,\n\n            startingGreyColor: 240,\n            endingGrayColor: 80,\n\n            // determines which the order of attributes to use for sorting\n            sortOrder: [0, 1, 2],\n            intervalTimer: 70\n        }\n\n        this.initialiseOverviewConfig();\n        this.initialiseFocusAreaConfig();\n        this.initialiseFocusGraphConfig();\n    }\n\n    initialiseOverviewConfig() {\n        this.config.overview = {\n            topAndBottomPadding: 20,\n            metricFontSize: 12,\n            timeFontSize: 10,\n            marginBetweenLabelsAndOverview: 10,\n            decompressedPointWidth: 1,\n            compressedPointWidth: 1,\n            ungroupedPointHeight: 1,\n            groupedPointHeight: 5,\n            verticalMarginBetweenMetrics: 2,\n            horizontalMarginBetweenMetrics: 30,\n            marginBetweenGroups: 10,\n            groupBarWidth: 9,\n            singleAttributeGroupSizeWidth: 1,\n            multipleAttributeGroupSizeWidth: 2,\n            marginBetweenMarkerAndGroup: 15,\n            marginBetweenMetricAndGroupSize: 20\n        }\n    }\n\n    initialiseFocusAreaConfig() {\n        this.config.focusArea = {\n            color: \"Aqua\",\n            focusAreaSize: 20,\n            xCrossSize: 15\n        }\n    }\n\n    initialiseFocusGraphConfig() {\n        this.config.focusGraph = {\n            maxWidth: 10000,\n            maxHeight: 10000,\n            groupedPointWidth: 3,\n            ungroupedPointWidth: 20,\n            metricMaxHeight: 30,\n            marginBetweenMetrics: 10,\n            maxHeight: 10000,\n            markerSize: 20,\n            marginBetweenMarkers: 20\n        }\n    }\n\n    initialisePanelDefaults() {\n        this.panelDefaults = {\n            predefinedMetricList: [\n                {\n                    name: \"CPU\",\n                    query: \"node_load1{job='node'}\"\n                },\n\n                {\n                    name: \"Memory\",\n                    query: \"100 - (node_memory_MemFree_bytes{job='node'} - node_memory_Cached_bytes{job='node'}) * 100 / (node_memory_MemTotal_bytes{job='node'} + node_memory_Buffers_bytes{job='node'})\",\n                },\n\n                {\n                    name: \"Disk\",\n                    query: \"100 - (sum by (instance) (node_filesystem_avail_bytes{job='node',device!~'(?:rootfs|/dev/loop.+)', mountpoint!~'(?:/mnt/nfs/|/run|/var/run|/cdrom).*'})) * 100 / (sum by (instance) (node_filesystem_size_bytes{job='node',device!~'rootfs'}))\",\n                },\n\n                {\n                    name: \"Network\",\n                    query: \"sum by (instance) (node_network_receive_bytes_total{job='node',device!~'^(?:docker|vboxnet|veth|lo).*'})\",\n                },\n\n                {\n                    name: \"Disk Temperature\",\n                    query: \"sum by (instance) (smartmon_temperature_celsius_raw_value{job='node',smart_id='194'})\",\n                }\n            ]\n        };\n\n        _.defaults(this.panel, this.panelDefaults);\n        this.panel.predefinedMetricList = this.panelDefaults.predefinedMetricList;\n    }\n\n    initialisePredefinedMetricOptionList() {\n        this.predefinedMetricOptionList = [];\n\n        this.panelDefaults.predefinedMetricList.forEach((metric) => {\n            this.predefinedMetricOptionList.push(metric.name);\n        });\n    }\n\n    initialiseMetricsColorList() {\n        this.panel.metricList.forEach((metric) => {\n            metric.colorList = [];\n            metric.colorList.push(metric.color);\n            var luminanceChange = -this.config.maxLuminanceChange / this.config.colorCount;\n\n            for (var i = 0; i < this.config.colorCount - 1; ++i) {\n                var color = this.changeColorLuminance(metric.color, i * luminanceChange);\n                metric.colorList.push(color);\n            }\n        });\n    }\n\n    changeColorLuminance(hex, lum) {\n        hex = String(hex).replace(/[^0-9a-f]/gi, '');\n\n        if (hex.length < 6) {\n            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n        }\n\n        lum = lum || 0;\n        var rgb = \"#\", c, i;\n\n        for (i = 0; i < 3; i++) {\n            c = parseInt(hex.substr(i * 2, 2), 16);\n            c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\n            rgb += (\"00\" + c).substr(c.length);\n        }\n\n        return rgb;\n    }\n\n    selectPredefinedMetric(index) {\n        var metric = this.panel.metricList[index];\n\n        if (!metric.isCustom) {\n            for (var i = 0; i < this.panel.predefinedMetricList.length; ++i) {\n                var predefinedMetric = this.panel.predefinedMetricList[i];\n\n                if (metric.name == predefinedMetric.name) {\n                    this.panel.metricList[index] = JSON.parse(JSON.stringify(predefinedMetric));\n                    break;\n                }\n            }\n        }\n    }\n\n    link(scope, elem) {\n        this.scope = scope;\n        this.elem = elem;\n\n        this.initialiseControl();\n        this.initialiseUIElements();\n    }\n\n    initialiseControl() {\n        this.enumList = {\n            linkingMode: {\n                X_CROSS: \"1\",\n                NORMAL_CROSS: \"2\",\n                CHANGE_COLOR: \"3\",\n            },\n\n            groupingMode: {\n                SINGLE: \"1\",\n                MULTIPLE: \"2\",\n            }\n        };\n\n        this.linkingMode = this.enumList.linkingMode.X_CROSS;\n        this.groupingMode = this.enumList.groupingMode.SINGLE;\n        this.isGrouped = true;\n        this.initialiseOverviewCanvasCursor();\n    }\n\n    initialiseOverviewCanvasCursor() {\n        this.overviewCursor = \"crosshair\";\n    }\n\n    initialiseUIElements() {\n        // overview\n        this.overviewCanvas = this.getElementByID(\"overviewCanvas\");\n        this.overviewContext = this.getCanvasContext(this.overviewCanvas);\n\n        // focus area + overview group markers\n        this.focusAreaCanvas = this.getElementByID(\"focusAreaCanvas\");\n        this.focusAreaContext = this.getCanvasContext(this.focusAreaCanvas);\n\n        // overview time indicator\n        this.timeIndicatorCanvas = this.getElementByID(\"timeIndicatorCanvas\");\n        this.timeIndicatorContext = this.getCanvasContext(this.timeIndicatorCanvas);\n\n        // focus graph\n        this.focusGraphWidth = this.config.focusGraph.maxWidth;\n        this.focusGraphHeight = this.config.focusGraph.maxHeight;\n        this.focusGraphContainer = this.getElementByID(\"focusGraphContainer\");\n    }\n\n    getElementByID(id) {\n        var find = this.elem.find(\"#\" + id);\n        return find[0];\n    }\n\n    getCanvasContext(canvas) {\n        return canvas.getContext(\"2d\");\n    }\n\n    onInitEditMode() {\n        this.addEditorTab('Options', 'public/plugins/buw-heatmap-panel/editor.html', 2);\n    }\n\n    onDataReceived(data) {\n        if (this.isUpdatingVariable) {\n            this.isUpdatingVariable = false;\n        } else {\n            this.load();\n        }\n    }\n\n    load() {\n        this.$timeout(() => {\n            this.isLoading = true;\n\n            this.scope.$apply();\n\n            this.overviewModel.metricList = [];\n\n            this.panel.metricList.forEach(() => {\n                this.overviewModel.metricList.push(null);\n            });\n\n            this.loadCount = 0;\n            this.fromDate = this.getDateInSeconds(this.timeSrv.timeRange().from._d);\n            this.toDate = this.getDateInSeconds(this.timeSrv.timeRange().to._d);\n\n            this.panel.metricList.forEach((metric, index) => {\n                this.getDataFromAPI(metric.query, index);\n            });\n\n            this.processRawData();\n        });\n    }\n\n    getDateInSeconds(date) {\n        return Math.round(date.getTime() / 1000);\n    }\n\n    getDataFromAPI(query, index) {\n        var xmlHttp = new XMLHttpRequest();\n\n        xmlHttp.onreadystatechange = () => {\n            // received response\n            if (xmlHttp.readyState == 4) {\n                ++this.loadCount;\n\n                if (xmlHttp.status == 200) {\n                    var metric = {}\n                    metric.data = JSON.parse(xmlHttp.responseText).data.result;\n                    this.overviewModel.metricList[index] = metric;\n                }\n            }\n        }\n\n        var url = this.config.apiAddress + encodeURIComponent(query) + \"&start=\" + this.fromDate + \"&end=\" + this.toDate + \"&step=60\";\n        xmlHttp.open(\"GET\", url, true);\n        xmlHttp.send(null);\n    }\n\n    processRawData() {\n        this.$timeout(() => {\n            if (this.loadCount < this.overviewModel.metricList.length) {\n                this.processRawData.bind(this)();\n            } else {\n                this.isLoading = false;\n\n                if (!this.overviewModel.metricList.includes(null)) {\n                    this.convertDataToFloat();\n                    this.initialiseMetricMinMaxTotal();\n                    this.initialiseColorMap();\n                    this.initiliseOverviewData();\n                    this.initialiseOverviewGroups();\n                    this.initialiseCompressedTimeIndexes();\n                    this.renderOverview();\n                }\n            }\n        }, 100);\n    }\n\n    convertDataToFloat() {\n        this.overviewModel.metricList.forEach((metric) => {\n            metric.data.forEach((instance) => {\n                instance.values.forEach((value) => {\n                    value[0] = parseFloat(value[0]);\n                    value[1] = parseFloat(value[1]);\n                });\n            });\n        });\n    }\n\n    initialiseMetricMinMaxTotal() {\n        this.overviewModel.metricList.forEach((metric) => {\n            metric.min = -1;\n            metric.max = -1;\n\n            metric.data.forEach((instance) => {\n                instance.values.forEach((point) => {\n                    this.checkAndSetOverviewMinMax(metric, point);\n                });\n            });\n        });\n    }\n\n    checkAndSetOverviewMinMax(metric, point) {\n        var value = point[1];\n\n        if (metric.min == -1) {\n            metric.min = value;\n            metric.max = value;\n        } else {\n            if (value < metric.min) {\n                metric.min = value;\n            }\n\n            if (value > metric.max) {\n                metric.max = value;\n            }\n        }\n    }\n\n    initialiseColorMap() {\n        this.overviewModel.metricList.forEach((metric, index) => {\n            var colorList = this.panel.metricList[index].colorList;\n            metric.layerRange = metric.max / colorList.length;\n\n            // map a range of values to a color\n            metric.colorMap = this.getColorMap(metric, colorList);\n        });\n    }\n\n    getColorMap(metric, colorList) {\n        var colorMap = new Map();\n\n        for (var i = 0; i < colorList.length; ++i) {\n            var threshold = {};\n            threshold.min = i * metric.layerRange;\n            threshold.max = threshold.min + metric.layerRange;\n            threshold.average = (threshold.max + threshold.min) / 2;\n            colorMap.set(threshold, colorList[i]);\n        }\n\n        return colorMap;\n    }\n\n    initiliseOverviewData() {\n        this.overviewModel.data = [];\n        this.populateOverviewData();\n        this.calculateInstanceMetricTotalMinMax();\n        this.sortOverviewData();\n    }\n\n    populateOverviewData() {\n        this.overviewModel.metricList.forEach((metric, metricIndex) => {\n            metric.data.forEach((metricInstance) => {\n                var newInstance = _.find(this.overviewModel.data, (search) => {\n                    return metricInstance.metric.instance == search.instance;\n                });\n\n                if (!newInstance) {\n                    newInstance = this.initaliseNewInstance(metricInstance);\n                }\n\n                metricInstance.values.forEach((value) => {\n                    var point = {};\n                    point.date = value[0];\n                    point.value = value[1];\n                    newInstance.metricList[metricIndex].data.push(point);\n                });\n            });\n        });\n    }\n\n    initaliseNewInstance(metricInstance) {\n        var newInstance = {};\n        newInstance.instance = metricInstance.metric.instance;\n\n        newInstance.metricList = [];\n\n        for (var i = 0; i < this.overviewModel.metricList.length; ++i) {\n            var metric = {};\n            metric.data = [];\n            newInstance.metricList.push(metric);\n        }\n\n        this.overviewModel.data.push(newInstance);\n        return newInstance;\n    }\n\n    calculateInstanceMetricTotalMinMax() {\n        this.overviewModel.data.forEach((instance) => {\n            instance.metricList.forEach((metric, metricIndex) => {\n                metric.total = 0;\n                metric.min = -1;\n                metric.max = -1;\n\n                metric.data.forEach((point) => {\n                    // sum the \"threshold\" average of each data point instead of the actual value of the data point \n                    metric.total += this.getThresholdAverage(point.value, this.overviewModel.metricList[metricIndex].colorMap);\n\n                    if (metric.min == -1 || point.value < metric.min) {\n                        metric.min = point.value;\n                    }\n\n                    if (metric.max == -1 || point.value > metric.max) {\n                        metric.max = point.value;\n                    }\n                })\n            });\n        });\n    }\n\n    getThresholdAverage(value, map) {\n        var result;\n\n        map.forEach((color, threshold) => {\n            if (this.isBetween(value, threshold.min, threshold.max)) {\n                result = threshold.average;\n            }\n        });\n\n        return result;\n    }\n\n    isBetween(target, start, end) {\n        return start <= target && target <= end;\n    }\n\n    sortOverviewData() {\n        this.overviewModel.data.sort((first, second) => {\n            for (var i = 0; i < this.config.sortOrder.length; ++i) {\n                var metricIndex = this.config.sortOrder[i];\n\n                if (first.metricList[metricIndex].total != second.metricList[metricIndex].total) {\n                    return first.metricList[metricIndex].total - second.metricList[metricIndex].total;\n                }\n            }\n\n            return 0;\n        });\n    }\n\n    initialiseOverviewGroups() {\n        this.initialiseSingleAttributeGroups();\n        this.initialiseMultiAttributeGroups();\n    }\n\n    initialiseSingleAttributeGroups() {\n        this.overviewModel.metricList.forEach((metric, metricIndex) => {\n            metric.groupList = [];\n\n            this.overviewModel.data.forEach((instance) => {\n                var group = _.find(metric.groupList, (search) => {\n                    return instance.metricList[metricIndex].total == search.total;\n                });\n\n                if (!group) {\n                    group = this.initialiseNewSingleAttributeGroups(instance, metricIndex);\n                    metric.groupList.push(group);\n                }\n\n                group.instanceList.push(instance);\n            });\n\n            metric.groupList.sort((first, second) => {\n                return first.total - second.total;\n            });\n\n            this.initialiseSingleAttributeGroupsColor(metric, metricIndex);\n        });\n\n        this.initialiseSingleAttributeInstanceGroupList();\n    }\n\n    initialiseNewSingleAttributeGroups(instance, metricIndex) {\n        var group = {};\n        group.instanceList = [];\n        group.markerX = 0;\n        group.total = instance.metricList[metricIndex].total;\n        return group;\n    }\n\n    initialiseSingleAttributeGroupsColor(metric, metricIndex) {\n        var luminanceChange = -this.config.maxLuminanceChange / metric.groupList.length;\n        var originalColor = this.panel.metricList[metricIndex].colorList[0];\n\n        metric.groupList.forEach((group, groupIndex) => {\n            group.color = this.changeColorLuminance(originalColor, groupIndex * luminanceChange);\n        });\n    }\n\n    initialiseSingleAttributeInstanceGroupList() {\n        this.overviewModel.data.forEach((instance) => {\n            instance.groupList = [];\n\n            this.overviewModel.metricList.forEach((metric, metricIndex) => {\n                for (var i = 0; i < metric.groupList.length; ++i) {\n                    var group = metric.groupList[i];\n\n                    if (instance.metricList[metricIndex].total == group.total) {\n                        instance.groupList.push(group);\n                        break;\n                    }\n                }\n            });\n        });\n    }\n\n    initialiseMultiAttributeGroups() {\n        this.overviewModel.groupList = [];\n\n        this.overviewModel.data.forEach((instance) => {\n            var group = _.find(this.overviewModel.groupList, (search) => {\n                for (var i = 0; i < instance.metricList.length; ++i) {\n                    if (instance.metricList[i].total != search.metricList[i].total) {\n                        return false;\n                    }\n                }\n\n                return true;\n            });\n\n            if (!group) {\n                group = this.initialiseNewMultiAttributeGroup(instance);\n                this.overviewModel.groupList.push(group);\n            }\n\n            group.instanceList.push(instance);\n        });\n\n        this.initialiseMultiAttributeGroupsColor();\n    }\n\n    initialiseNewMultiAttributeGroup(instance) {\n        var group = {};\n        group.metricList = [];\n        group.instanceList = [];\n        group.markerX = 0;\n\n        instance.metricList.forEach((instanceMetric) => {\n            var groupMetric = {};\n            groupMetric.total = instanceMetric.total;\n            group.metricList.push(groupMetric);\n        });\n\n        return group;\n    }\n\n    initialiseMultiAttributeGroupsColor() {\n        var colorStep = (this.config.startingGreyColor - this.config.endingGrayColor) / this.overviewModel.groupList.length;\n\n        this.overviewModel.groupList.forEach((group, groupIndex) => {\n            var greyValue = Math.round(this.config.startingGreyColor - colorStep * groupIndex);\n            group.color = \"rgba(\" + greyValue + \", \" + greyValue + \", \" + greyValue + \", 1)\";\n        });\n    }\n\n    initialiseCompressedTimeIndexes() {\n        this.overviewModel.metricList.forEach((overviewMetric, metricIndex) => {\n            overviewMetric.compressedTimeIndexList = [0];\n\n            this.overviewModel.data.forEach((instance) => {\n                this.initialiseInstanceCompressedTimeRangeList(instance, overviewMetric, metricIndex);\n            });\n\n            this.overviewModel.data.forEach((instance) => {\n                var instanceMetric = instance.metricList[metricIndex];\n\n                instanceMetric.compressedIndexRangeList.forEach((range) => {\n                    if (!overviewMetric.compressedTimeIndexList.includes(range.end)) {\n                        overviewMetric.compressedTimeIndexList.push(range.end);\n                    }\n                });\n            });\n\n            overviewMetric.compressedTimeIndexList.sort((first, second) => {\n                return first - second;\n            });\n        });\n    }\n\n    initialiseInstanceCompressedTimeRangeList(instance, overviewMetric, metricIndex) {\n        var instanceMetric = instance.metricList[metricIndex];\n        instanceMetric.compressedIndexRangeList = [];\n        var presviousRange;\n\n        instanceMetric.data.forEach((point, pointIndex) => {\n            var thresholdAverage = this.getThresholdAverage(point.value, overviewMetric.colorMap);\n\n            if (pointIndex == 0) {\n                presviousRange = this.initialiseNewCompressedTimeRange(instanceMetric, thresholdAverage);\n            } else {\n                if (thresholdAverage != presviousRange.value || pointIndex == instanceMetric.data.length - 1) {\n                    presviousRange.end = pointIndex;\n\n                    if (thresholdAverage != presviousRange.value) {\n                        presviousRange = this.initialiseNewCompressedTimeRange(instanceMetric, thresholdAverage);\n                    }\n                }\n            }\n        });\n    }\n\n    initialiseNewCompressedTimeRange(instanceMetric, thresholdAverage) {\n        var range = {};\n        instanceMetric.compressedIndexRangeList.push(range);\n        range.value = thresholdAverage;\n        return range;\n    }\n\n    renderOverview() {\n        if (this.overviewModel.data.length > 0) {\n            this.clearFocusArea();\n            this.drawOverview();\n        }\n    }\n\n    clearFocusArea() {\n        this.hasFocus = false;\n        this.focusAreaContext.clearRect(0, 0, this.focusAreaCanvas.width, this.focusAreaCanvas.height);\n    }\n\n    drawOverview() {\n        this.$timeout(() => {\n            this.overviewContext.clearRect(0, 0, this.overviewCanvas.width, this.overviewCanvas.height);\n            this.setOverviewCanvasSize();\n            this.focusGraphMarginTop = this.overviewCanvasHeight + this.config.marginBetweenOverviewAndFocus;\n            this.drawOverviewData();\n        });\n    }\n\n    setOverviewCanvasSize() {\n        this.setOverviewContextLabelFont();\n        this.overviewModel.labelTextHeight = this.overviewContext.measureText(\"M\").width;\n        this.overviewModel.overviewStartY = this.overviewModel.labelTextHeight + this.config.overview.marginBetweenLabelsAndOverview;\n        this.setOverviewWidth();\n        this.setOverviewHeight();\n        this.scope.$apply();\n    }\n\n    setOverviewWidth() {\n        this.setOverviewContextTimeFont();\n        this.overviewModel.toDate = this.getDateString(this.toDate * 1000);\n        this.overviewModel.toDateWidth = this.overviewContext.measureText(this.overviewModel.toDate).width;\n        this.overviewModel.overviewWidth = this.config.overview.marginBetweenMarkerAndGroup * this.overviewModel.metricList.length +\n            this.config.overview.horizontalMarginBetweenMetrics * (this.overviewModel.metricList.length - 1);\n\n        // total width of overiew graph (groupsize excluded)\n        if (this.isCompressed) {\n            this.overviewModel.metricList.forEach((metric) => {\n                this.overviewModel.overviewWidth += metric.compressedTimeIndexList.length * this.config.overview.compressedPointWidth;\n            });\n        } else {\n            this.overviewModel.overviewWidth += this.getMaxMetricLength() * this.overviewModel.metricList.length * this.config.overview.decompressedPointWidth;\n        }\n\n        this.overviewCanvasWidth = this.overviewModel.overviewWidth;\n\n        if (this.isGrouped) {\n            this.setGroupedOverviewCanvasWidth();\n        } else {\n            this.overviewCanvasWidth += this.overviewModel.toDateWidth / 2;\n        }\n    }\n\n    getMaxMetricLength() {\n        var length = 0;\n\n        this.overviewModel.metricList.forEach((metric) => {\n            var instanceWithMostPoints = _.maxBy(metric.data, (point) => {\n                return point.values.length;\n            });\n\n            length = instanceWithMostPoints.values.length;\n        });\n\n        return length;\n    }\n\n    setGroupedOverviewCanvasWidth() {\n        this.overviewCanvasWidth += this.config.overview.marginBetweenMarkerAndGroup * this.overviewModel.metricList.length;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.overviewCanvasWidth += this.config.overview.marginBetweenMetricAndGroupSize * this.overviewModel.metricList.length;\n\n            this.overviewModel.metricList.forEach((metric) => {\n                this.overviewCanvasWidth += this.getMaxGroupSizeBarLength(metric) * this.config.overview.singleAttributeGroupSizeWidth;\n            });\n        } else {\n            this.overviewCanvasWidth += this.config.overview.marginBetweenMetricAndGroupSize +\n                this.getMaxMultiAttributeGroupSize() * this.config.overview.multipleAttributeGroupSizeWidth;\n        }\n    }\n\n    getMaxGroupSizeBarLength(metric) {\n        var largestGroup = _.maxBy(metric.groupList, (group) => {\n            return group.instanceList.length;\n        });\n\n        return largestGroup.instanceList.length * this.config.overview.singleAttributeGroupSizeWidth;\n    }\n\n    getMaxMultiAttributeGroupSize() {\n        var result = 0;\n\n        this.overviewModel.groupList.forEach((group) => {\n            if (group.instanceList.length > result) {\n                result = group.instanceList.length;\n            }\n        });\n\n        return result;\n    }\n\n    setOverviewHeight() {\n        // height of tallest graph\n        if (this.isGrouped) {\n            var groupCount = this.getMaxGroupCount();\n            this.overviewModel.overviewHeight = groupCount * (this.config.overview.groupedPointHeight + this.config.overview.marginBetweenGroups);\n        } else {\n            this.overviewModel.overviewHeight = this.overviewModel.data.length * this.config.overview.ungroupedPointHeight;\n        }\n\n        // 2 = Metric and time labels\n        this.overviewCanvasHeight = this.overviewModel.overviewHeight +\n            (this.overviewModel.labelTextHeight + this.config.overview.marginBetweenLabelsAndOverview) * 2;\n    }\n\n    getMaxGroupCount() {\n        var groupCount;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            var metricWithMostGroups = _.maxBy(this.overviewModel.metricList, (metric) => {\n                return metric.groupList.length;\n            });\n\n            groupCount = metricWithMostGroups.groupList.length;\n        } else {\n            groupCount = this.overviewModel.groupList.length;\n        }\n\n        return groupCount;\n    }\n\n    setOverviewContextLabelFont() {\n        this.overviewContext.font = \"bold \" + this.config.overview.metricFontSize + \"px Arial\";\n    }\n\n    drawOverviewData() {\n        this.overviewModel.overviewEndY = 0;\n        this.setOverviewMetricStartXAndEndX();\n\n        if (this.isGrouped) {\n            this.drawGroupedOverview();\n        } else {\n            this.drawUngroupedOverview();\n        }\n\n        this.drawMetricLabels();\n        this.drawToDateLabel();\n    }\n\n    setOverviewMetricStartXAndEndX() {\n        this.overviewModel.metricList.forEach((metric, index) => {\n            if (index > 0) {\n                var previousMetric = this.overviewModel.metricList[index - 1];\n                metric.startX = previousMetric.endX + this.config.overview.horizontalMarginBetweenMetrics;\n\n                if (this.isGrouped) {\n                    metric.startX += this.config.overview.marginBetweenMarkerAndGroup;\n\n                    if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n                        var maxGroupSizeBarLength = this.getMaxGroupSizeBarLength(previousMetric);\n                        metric.startX += maxGroupSizeBarLength + this.config.overview.marginBetweenMetricAndGroupSize;\n                    }\n                }\n            } else {\n                metric.startX = this.config.overview.marginBetweenMarkerAndGroup;\n            }\n\n            if (this.isCompressed) {\n                metric.endX = metric.startX + metric.compressedTimeIndexList.length * this.config.overview.compressedPointWidth;\n            } else {\n                metric.endX = metric.startX + this.getMaxMetricLength() * this.config.overview.decompressedPointWidth;\n            }\n        });\n    }\n\n    drawGroupedOverview() {\n        this.overviewModel.overviewInstanceHeight = this.config.overview.groupedPointHeight;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.overviewModel.metricList.forEach((metric, metricIndex) => {\n                metric.groupList.forEach((group, groupIndex) => {\n                    this.drawGroupOverviewWrapper(group, groupIndex, [metricIndex]);\n                });\n            });\n        } else {\n            this.overviewModel.groupList.forEach((group, groupIndex) => {\n                var metricIndexList = this.getAllMetricIndexList();\n                this.drawGroupOverviewWrapper(group, groupIndex, metricIndexList);\n            });\n        }\n\n        this.drawGroupSize();\n        this.drawMetricSeparator();\n    }\n\n    drawGroupOverviewWrapper(group, groupIndex, metricIndexList) {\n        var instance = group.instanceList[0];\n        this.drawOverviewInstance(instance, groupIndex, this.config.overview.groupedPointHeight, this.config.overview.marginBetweenGroups, metricIndexList);\n        group.y = instance.y;\n    }\n\n    drawOverviewInstance(instance, instanceIndex, pointHeight, marginBetweenInstances, metricIndexList) {\n        instance.y = this.overviewModel.overviewStartY + instanceIndex * (pointHeight + marginBetweenInstances);\n        var endY = instance.y + pointHeight;\n\n        if (endY > this.overviewModel.overviewEndY) {\n            this.overviewModel.overviewEndY = endY;\n        }\n\n        metricIndexList.forEach((metricIndex) => {\n            this.drawOverviewInstancePoints(instance, metricIndex, pointHeight);\n        });\n    }\n\n    drawOverviewInstancePoints(instance, metricIndex, pointHeight) {\n        var overviewMetric = this.overviewModel.metricList[metricIndex];\n        var instanceMetric = instance.metricList[metricIndex];\n\n        if (this.isCompressed) {\n            overviewMetric.compressedTimeIndexList.forEach((pointIndex, rangeIndex) => {\n                var point = instanceMetric.data[pointIndex];\n\n                if (point) {\n                    this.drawOverviewInstancePoint(instance, metricIndex, overviewMetric, point, rangeIndex, this.config.overview.compressedPointWidth, pointHeight);\n                }\n            });\n        } else {\n            instanceMetric.data.forEach((point, pointIndex) => {\n                this.drawOverviewInstancePoint(instance, metricIndex, overviewMetric, point, pointIndex, this.config.overview.decompressedPointWidth, pointHeight);\n            });\n        }\n    }\n\n    drawOverviewInstancePoint(instance, metricIndex, overviewMetric, point, pointIndex, pointWidth, pointHeight) {\n        point.x = overviewMetric.startX + pointIndex * pointWidth;\n        point.color = this.getColorFromMap(point.value, this.overviewModel.metricList[metricIndex].colorMap);\n        this.overviewContext.fillStyle = point.color;\n        this.overviewContext.fillRect(point.x, instance.y, pointWidth, pointHeight);\n    }\n\n    getColorFromMap(value, map) {\n        var result;\n\n        map.forEach((color, threshold) => {\n            if (this.isBetween(value, threshold.min, threshold.max)) {\n                result = color;\n            }\n        });\n\n        return result;\n    }\n\n    getAllMetricIndexList() {\n        return Array.from(Array(this.overviewModel.metricList.length).keys());\n    }\n\n    drawGroupSize() {\n        this.setOverviewContextLabelFont();\n        var label = \"Groups size\";\n        var labelWidth = this.overviewContext.measureText(label).width;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.drawSingleAttributeGroupSize(labelWidth);\n        } else {\n            this.drawMultipleAttributeGroupSize(labelWidth);\n        }\n    }\n\n    drawSingleAttributeGroupSize(labelWidth) {\n        this.overviewModel.metricList.forEach((metric) => {\n            var startX = metric.endX + this.config.overview.marginBetweenMetricAndGroupSize;\n            var maxGroupSizeBarLength = this.getMaxGroupSizeBarLength(metric);\n\n            metric.groupList.forEach((group, groupIndex) => {\n                this.drawGroupSizeWrapper(startX, group, groupIndex, this.config.overview.singleAttributeGroupSizeWidth);\n            });\n\n            this.overviewContext.fillStyle = \"black\";\n            this.overviewContext.fillText(\"Groups size\", (startX * 2 + maxGroupSizeBarLength - labelWidth) / 2, this.overviewModel.labelTextHeight);\n        });\n    }\n\n    drawGroupSizeWrapper(startX, group, groupIndex, groupSizeWidth) {\n        var endX = startX + group.instanceList.length * groupSizeWidth;\n        var startY = this.overviewModel.overviewStartY +\n            groupIndex * (this.config.overview.groupedPointHeight + this.config.overview.marginBetweenGroups);\n        var endY = startY + this.config.overview.groupedPointHeight;\n        this.overviewContext.beginPath();\n        this.overviewContext.moveTo(startX, startY);\n        this.overviewContext.lineTo(endX, startY);\n        this.overviewContext.lineTo(endX, endY);\n        this.overviewContext.lineTo(startX, endY);\n        this.overviewContext.closePath();\n        this.overviewContext.fillStyle = \"black\";\n        this.overviewContext.fill();\n        return endX;\n    }\n\n    drawMultipleAttributeGroupSize(labelWidth) {\n        var startX = this.overviewModel.overviewWidth + this.config.overview.horizontalMarginBetweenMetrics;\n        var maxEndX = 0;\n\n        this.overviewModel.groupList.forEach((group, groupIndex) => {\n            var endX = this.drawGroupSizeWrapper(startX, group, groupIndex, this.config.overview.multipleAttributeGroupSizeWidth);\n\n            if (endX > maxEndX) {\n                maxEndX = endX;\n            }\n        });\n\n        this.overviewContext.fillStyle = \"black\";\n        this.overviewContext.fillText(\"Groups size\", (startX + maxEndX - labelWidth) / 2, this.overviewModel.labelTextHeight);\n    }\n\n    drawMetricSeparator() {\n        this.overviewContext.strokeStyle = \"gray\";\n\n        for (var i = 0; i < this.overviewModel.metricList.length; ++i) {\n            var metric = this.overviewModel.metricList[i];\n            var x = metric.endX + this.config.overview.horizontalMarginBetweenMetrics / 2;\n\n            if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n                var maxGroupSizeBarLength = this.getMaxGroupSizeBarLength(metric);\n                x += this.config.overview.marginBetweenMetricAndGroupSize + maxGroupSizeBarLength;\n            }\n\n            this.overviewContext.beginPath();\n            this.overviewContext.moveTo(x, this.overviewModel.overviewStartY);\n            this.overviewContext.lineTo(x, this.overviewModel.overviewStartY + this.overviewModel.overviewHeight);\n            this.overviewContext.stroke();\n            this.overviewContext.closePath();\n        }\n    }\n\n    drawUngroupedOverview() {\n        this.overviewModel.overviewInstanceHeight = this.config.overview.ungroupedPointHeight;\n\n        this.overviewModel.data.forEach((instance, instanceIndex) => {\n            var metricIndexList = this.getAllMetricIndexList();\n            this.drawOverviewInstance(instance, instanceIndex, this.config.overview.ungroupedPointHeight, 0, metricIndexList);\n        });\n\n        this.drawGroupBars();\n    }\n\n    drawGroupBars() {\n        for (var i = 1; i < this.overviewModel.metricList.length; ++i) {\n            var x = this.overviewModel.metricList[i].startX - this.config.overview.horizontalMarginBetweenMetrics / 2;\n            this.drawGroupBarAtPosition(x);\n        }\n    }\n\n    drawGroupBarAtPosition(x) {\n        var y = this.overviewModel.overviewStartY;\n\n        this.overviewModel.groupList.forEach((group) => {\n            this.overviewContext.fillStyle = group.color;\n            var height = group.instanceList.length * this.config.overview.ungroupedPointHeight;\n            this.overviewContext.fillRect(x - Math.floor(this.config.overview.groupBarWidth / 2), y,\n                this.config.overview.groupBarWidth, height);\n            y += height;\n        });\n    }\n\n    drawMetricLabels() {\n        this.setOverviewContextLabelFont();\n        this.overviewContext.fillStyle = \"black\";\n\n        for (var i = 0; i < this.overviewModel.metricList.length; ++i) {\n            var metric = this.overviewModel.metricList[i];\n            var label = this.panel.metricList[i].name;\n            var width = this.overviewContext.measureText(label).width;\n            this.overviewContext.fillText(label, (metric.startX + metric.endX - width) / 2, this.overviewModel.labelTextHeight);\n        }\n    }\n\n    drawToDateLabel() {\n        this.setOverviewContextTimeFont();\n        var y = this.overviewModel.overviewStartY + this.overviewModel.overviewHeight + this.config.overview.marginBetweenLabelsAndOverview;\n        var metric = this.overviewModel.metricList[this.overviewModel.metricList.length - 1];\n        this.overviewContext.fillStyle = \"black\";\n        this.overviewContext.fillText(this.overviewModel.toDate, metric.endX - this.overviewModel.toDateWidth / 2, y);\n    }\n\n    setOverviewContextTimeFont() {\n        this.overviewContext.font = \"italic \" + this.config.overview.timeFontSize + \"px Arial\";\n    }\n\n    getDateString(date) {\n        return moment(date).format(this.config.dateFormat);\n    }\n\n    selectOverviewMode() {\n        this.drawOverview();\n    }\n\n    selectLinker() {\n        this.drawFocusArea();\n    }\n\n    selectGroupingMode() {\n        this.changeGroupingSelection();\n    }\n\n    changeGroupingSelection() {\n        this.drawOverview();\n        this.focusModel.groupList = [];\n\n        this.overviewModel.groupList.forEach((group) => {\n            group.isSelected = false;\n        })\n\n        this.overviewModel.metricList.forEach((metric) => {\n            if (metric.groupList) {\n                metric.groupList.forEach((group) => {\n                    group.isSelected = false;\n                });\n            }\n        });\n\n        this.showFocus = false;\n    }\n\n    groupUngroup() {\n        this.isGrouped = !this.isGrouped;\n        this.changeGroupingSelection();\n    }\n\n    compressDecompress() {\n        this.isCompressed = !this.isCompressed;\n        this.drawOverview();\n        this.clearFocusArea();\n    }\n\n    moveMouseOnOverview(evt) {\n        this.setOverviewMousePosition(evt);\n\n        if (this.isGrouped) {\n            this.initialiseOverviewCanvasCursor();\n            this.overviewModel.hoveredGroup = null;\n            this.overviewModel.hoveredMarker = null;\n            var found = this.checkMouseIsOnGroupAndSetGroupSelected();\n\n            if (found) {\n                this.drawTimeIndicators();\n            } else {\n                this.clearTimeIndicator();\n                this.checkAndSetSelectedOverviewMarker();\n            }\n        } else if (!this.isCompressed && !this.focusAreaIsFixed) {\n            this.drawFocus(evt);\n        }\n    }\n\n    setOverviewMousePosition(evt) {\n        this.overviewModel.mousePosition = this.getMousePos(evt, this.focusAreaCanvas);\n    }\n\n    getMousePos(evt, canvas) {\n        var rect = canvas.getBoundingClientRect();\n\n        return {\n            x: evt.clientX - rect.left,\n            y: evt.clientY - rect.top\n        };\n    }\n\n    checkMouseIsOnGroupAndSetGroupSelected() {\n        for (var overviewIndex = 0; overviewIndex < this.overviewModel.metricList.length; ++overviewIndex) {\n            var metric = this.overviewModel.metricList[overviewIndex];\n\n            if (metric) {\n                // only check if mouse is on a metric graph\n                if (this.isBetween(this.overviewModel.mousePosition.x, metric.startX, metric.endX)) {\n                    this.overviewModel.selectedMetric = metric;\n                    this.overviewModel.mousePositionXOffset = this.overviewModel.mousePosition.x - metric.startX;\n\n                    if (this.checkAndSetSelectedGroup(metric)) {\n                        return true;\n                    }\n                }\n            }\n        }\n\n        return false;\n    }\n\n    checkAndSetSelectedGroup(metric) {\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            for (var i = 0; i < metric.groupList.length; ++i) {\n                var group = metric.groupList[i];\n\n                if (this.checkGroupIsSelected(group)) {\n                    return true;\n                }\n            }\n        } else {\n            for (var i = 0; i < this.overviewModel.groupList.length; ++i) {\n                var group = this.overviewModel.groupList[i];\n\n                if (this.checkGroupIsSelected(group)) {\n                    return true;\n                }\n            }\n        }\n\n        return false;\n    }\n\n    checkGroupIsSelected(group) {\n        if (this.isBetween(this.overviewModel.mousePosition.y, group.y, group.y + this.config.overview.groupedPointHeight)) {\n            this.overviewModel.hoveredGroup = group;\n            this.overviewCursor = \"pointer\";\n            return true;\n        }\n    }\n\n    checkAndSetSelectedOverviewMarker() {\n        for (var markerIndex = 0; markerIndex < this.overviewModel.groupMarkerList.length; ++markerIndex) {\n            var marker = this.overviewModel.groupMarkerList[markerIndex];\n\n            if (this.isBetween(this.overviewModel.mousePosition.x, marker.startX, marker.endX) &&\n                this.isBetween(this.overviewModel.mousePosition.y, marker.startY, marker.endY)) {\n                this.overviewCursor = \"pointer\";\n                this.overviewModel.hoveredMarker = marker;\n                break;\n            }\n        }\n    }\n\n    drawTimeIndicators() {\n        this.clearTimeIndicator();\n        this.timeIndicatorContext.strokeStyle = \"black\";\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.drawTimeIndicatorWrapper(this.overviewModel.selectedMetric);\n        } else {\n            this.overviewModel.metricList.forEach((metric) => {\n                this.drawTimeIndicatorWrapper(metric);\n            });\n        }\n\n        this.drawSelectedTimeLabel();\n    }\n\n    drawTimeIndicatorWrapper(metric) {\n        // horizontal line\n        var horizontalLineY = this.overviewModel.hoveredGroup.y - this.config.overview.marginBetweenGroups / 2;\n        this.timeIndicatorContext.beginPath();\n        this.timeIndicatorContext.moveTo(metric.startX, horizontalLineY);\n        this.timeIndicatorContext.lineTo(metric.endX, horizontalLineY);\n        this.timeIndicatorContext.stroke();\n        this.timeIndicatorContext.closePath();\n\n        // vertical line\n        var verticalLineX = metric.startX + this.overviewModel.mousePositionXOffset\n        this.timeIndicatorContext.beginPath();\n        this.timeIndicatorContext.moveTo(verticalLineX, horizontalLineY);\n        this.timeIndicatorContext.lineTo(verticalLineX, this.overviewModel.hoveredGroup.y);\n        this.timeIndicatorContext.stroke();\n        this.timeIndicatorContext.closePath();\n    }\n\n    clearTimeIndicator() {\n        this.timeIndicatorContext.clearRect(0, 0, this.timeIndicatorCanvas.width, this.timeIndicatorCanvas.height);\n    }\n\n    drawSelectedTimeLabel() {\n        for (var metricIndex = 0; metricIndex < this.overviewModel.metricList.length; ++metricIndex) {\n            var instanceMetric = this.overviewModel.hoveredGroup.instanceList[0].metricList[metricIndex];\n            var overviewMetric = this.overviewModel.metricList[metricIndex];\n\n            if (this.isCompressed) {\n                for (var compressedTimeIndex = 0; compressedTimeIndex < overviewMetric.compressedTimeIndexList.length; ++compressedTimeIndex) {\n                    var point = instanceMetric.data[overviewMetric.compressedTimeIndexList[compressedTimeIndex]];\n\n                    if (this.checkSelectedPointAndDrawTimeLabel(point, this.config.overview.compressedPointWidth)) {\n                        return;\n                    }\n                }\n            } else {\n                for (var compressedTimeIndex = 0; compressedTimeIndex < instanceMetric.data.length; ++compressedTimeIndex) {\n                    var point = instanceMetric.data[compressedTimeIndex];\n\n                    if (this.checkSelectedPointAndDrawTimeLabel(point, this.config.overview.decompressedPointWidth)) {\n                        return;\n                    }\n                }\n            }\n        }\n    }\n\n    checkSelectedPointAndDrawTimeLabel(point, pointWidth) {\n        if (this.isBetween(this.overviewModel.mousePosition.x, point.x, point.x + pointWidth)) {\n            this.timeIndicatorContext.font = \"italic \" + this.config.overview.timeFontSize + \"px Arial\";\n            this.timeIndicatorContext.fillStyle = \"black\";\n            var date = this.getDateString(point.date * 1000);\n            var y = this.overviewModel.overviewStartY + this.overviewModel.overviewHeight + this.config.overview.marginBetweenLabelsAndOverview;\n            var x = Math.max(0, this.overviewModel.mousePosition.x - this.overviewModel.toDateWidth / 2);\n            this.timeIndicatorContext.fillText(date, x, y);\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    clickOnOverView(evt) {\n        this.setOverviewMousePosition(evt);\n\n        if (this.isGrouped) {\n            this.$timeout(() => {\n                if (this.overviewModel.hoveredGroup) {\n                    this.addOrRemoveGroupToFocus();\n                    this.drawSelectedGroupsMarkers();\n                } else if (this.overviewModel.hoveredMarker) {\n                    this.startFocusMarkerInterval(this.overviewModel.hoveredMarker.group);\n                } else {\n                    this.stopInterval();\n                }\n\n                this.drawFocusGraph();\n            });\n        } else if (!this.isCompressed) {\n            this.fixFocusArea(evt);\n        }\n    }\n\n    addOrRemoveGroupToFocus() {\n        var focusGroup = _.find(this.focusModel.groupList, (search) => {\n            return search.overviewGroup == this.overviewModel.hoveredGroup;\n        })\n\n        if (focusGroup) {\n            this.overviewModel.hoveredGroup.isSelected = false;\n\n            _.remove(this.focusModel.groupList, (group) => {\n                return group.overviewGroup == this.overviewModel.hoveredGroup;\n            });\n        } else {\n            this.overviewModel.hoveredGroup.isSelected = true;\n            this.addGroupToFocus();\n        }\n\n        this.scope.$apply();\n    }\n\n    addGroupToFocus() {\n        var focusGroup = {};\n        focusGroup.instanceList = [];\n        focusGroup.overviewGroup = this.overviewModel.hoveredGroup;\n\n        this.overviewModel.hoveredGroup.instanceList.forEach((overviewInstance) => {\n            var metricWithMostData = _.maxBy(overviewInstance.metricList, (metric) => {\n                return metric.data.length;\n            });\n\n            this.focusModel.focusedIndexList = Array.from(Array(metricWithMostData.data.length).keys());\n            var focusInstance = this.getFocusInstance(overviewInstance, this.focusModel.focusedIndexList);\n            focusGroup.instanceList.push(focusInstance);\n        });\n\n        this.focusModel.groupList.push(focusGroup);\n    }\n\n    drawSelectedGroupsMarkers() {\n        this.clearFocusArea();\n        this.overviewModel.groupMarkerList = [];\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.overviewModel.metricList.forEach((metric) => {\n                metric.groupList.forEach((group) => {\n                    this.drawOverviewGroupMarker(group, [metric])\n                });\n            });\n        } else {\n            this.overviewModel.groupList.forEach((group) => {\n                this.drawOverviewGroupMarker(group, this.overviewModel.metricList)\n            });\n        }\n    }\n\n    drawOverviewGroupMarker(group, metricList) {\n        if (group.isSelected) {\n            metricList.forEach((metric) => {\n                var marker = {};\n                marker.group = group;\n                marker.startX = metric.startX - this.config.overview.marginBetweenMarkerAndGroup + group.markerX;\n                marker.endX = marker.startX + this.config.overview.groupedPointHeight;\n                marker.startY = group.y;\n                marker.endY = marker.startY + this.config.overview.groupedPointHeight;\n                this.focusAreaContext.fillStyle = group.color;\n                this.focusAreaContext.fillRect(marker.startX, marker.startY, this.config.overview.groupedPointHeight, this.config.overview.groupedPointHeight);\n                this.overviewModel.groupMarkerList.push(marker);\n            });\n        }\n    }\n\n    startFocusMarkerInterval(group) {\n        if (this.focusGroupWithInterval != group) {\n            this.stopInterval();\n            this.focusGroupWithInterval = group;\n            this.initialiseFocusMarkerInterval();\n        }\n    }\n\n    stopInterval() {\n        this.stopOverviewMarkerInterval();\n        this.stopFocusMarkerInterval();\n    }\n\n    stopOverviewMarkerInterval() {\n        if (this.currentOverviewMarkerInterval) {\n            this.$interval.cancel(this.currentOverviewMarkerInterval);\n\n            if (this.overviewGroupWithInterval) {\n                this.overviewGroupWithInterval.overviewMarkerX = 0;\n\n                this.focusModel.overviewGroupWithIntervalList.forEach((overviewGroup) => {\n                    overviewGroup.markerX = 0;\n                });\n\n                this.drawSelectedGroupsMarkers();\n            }\n\n            this.overviewGroupWithInterval = null;\n        }\n    }\n\n    stopFocusMarkerInterval() {\n        if (this.currentFocusMarkerInterval) {\n            this.$interval.cancel(this.currentFocusMarkerInterval);\n\n            if (this.focusGroupWithInterval) {\n                this.focusGroupWithInterval.focusMarkerX = 0;\n                this.focusGroupWithInterval = null;\n                this.drawGroupFocusMarkers();\n            }\n        }\n    }\n\n    initialiseFocusMarkerInterval() {\n        this.focusMarkerMovingBackwards = false;\n        this.focusGroupWithInterval.focusMarkerX = 0;\n\n        this.currentFocusMarkerInterval = this.$interval(() => {\n            if (this.focusMarkerMovingBackwards) {\n                this.handleFocusMarkerMovingBackwardCase();\n            } else {\n                this.handleFocusMarkerMovingForwardCase();\n            }\n\n            this.drawGroupFocusMarkers();\n        }, this.config.intervalTimer);\n    }\n\n    handleFocusMarkerMovingBackwardCase() {\n        if (this.focusGroupWithInterval.focusMarkerX == 0) {\n            this.focusMarkerMovingBackwards = false;\n            ++this.focusGroupWithInterval.focusMarkerX;\n        } else {\n            --this.focusGroupWithInterval.focusMarkerX;\n        }\n    }\n\n    handleFocusMarkerMovingForwardCase() {\n        if (this.focusGroupWithInterval.focusMarkerX == Math.round(this.config.focusGraph.marginBetweenMarkers / 2)) {\n            this.focusMarkerMovingBackwards = true;\n            --this.focusGroupWithInterval.focusMarkerX;\n        } else {\n            ++this.focusGroupWithInterval.focusMarkerX;\n        }\n    }\n\n    fixFocusArea(evt) {\n        this.initialiseOverviewCanvasCursor();\n\n        if (this.focusAreaIsFixed) {\n            this.drawFocus(evt);\n        }\n\n        this.focusAreaIsFixed = !this.focusAreaIsFixed;\n    }\n\n    drawFocus(evt) {\n        this.drawFocusArea();\n\n        for (var i = 0; i < this.overviewModel.metricList.length; ++i) {\n            var metric = this.overviewModel.metricList[i];\n\n            // only update focus graph if mouse is pointing on one of metric overview graphs\n            if (this.checkMouseIsInMetric(metric)) {\n                this.drawFocusGraph();\n                break;\n            }\n        }\n    }\n\n    checkMouseIsInMetric(metric) {\n        return this.isBetween(this.overviewModel.mousePosition.x, metric.startX, metric.endX);\n    }\n\n    drawFocusArea() {\n        if (this.overviewModel.mousePosition) {\n            this.clearFocusArea();\n            var size = this.getFocusAreaSize();\n            var minimumTopY = Math.max(this.overviewModel.overviewStartY, this.overviewModel.mousePosition.y - size / 2);\n            this.focusModel.focusStartY = Math.min(minimumTopY, this.overviewModel.overviewEndY - size);\n            var size = this.getFocusAreaSize();\n            var offset = this.getFocusAreaOffset();\n\n            if (offset >= 0) {\n                this.focusAreaContext.strokeStyle = this.config.focusArea.color;\n\n                this.overviewModel.metricList.forEach((metric) => {\n                    metric.focusStartX = metric.startX + offset;\n                    this.focusAreaContext.strokeRect(metric.focusStartX, this.focusModel.focusStartY, size, size);\n                });\n            }\n        }\n    }\n\n    getFocusAreaSize() {\n        return Math.min(this.config.focusArea.focusAreaSize * 2, this.overviewModel.overviewEndY - this.overviewModel.overviewStartY);\n    }\n\n    getFocusAreaOffset() {\n        for (var i = 0; i < this.overviewModel.metricList.length; ++i) {\n            var metric = this.overviewModel.metricList[i];\n\n            if (this.checkMouseIsInMetric(metric)) {\n                this.overviewModel.mousePositionXOffset = this.overviewModel.mousePosition.x - metric.startX;\n                this.focusModel.sourceMetricIndex = i;\n\n                return Math.min(Math.max(metric.startX,\n                    this.overviewModel.mousePosition.x - this.config.focusArea.focusAreaSize),\n                    metric.endX - this.getFocusAreaSize()) - metric.startX;\n            }\n        }\n    }\n\n    drawFocusGraph() {\n        if (!this.isGrouped) {\n            this.initialiseFocusGraphData();\n        }\n\n        if ((this.isGrouped && this.focusModel.groupList.length > 0) ||\n            (!this.isGrouped && this.focusModel.data.length > 0)) {\n            this.showFocus = true;\n\n            this.$timeout(() => {\n                this.focusGraphHeight = this.overviewModel.metricList.length * this.config.focusGraph.metricMaxHeight +\n                    (this.overviewModel.metricList.length - 1) * this.config.focusGraph.marginBetweenMetrics;\n                this.focusGraphWidth = (this.focusModel.focusedIndexList.length - 1) * this.getFocusGraphPointWidth();\n                this.scope.$apply();\n\n                var focusGraphRow = this.getElementByID(\"focusGraphRow\");\n\n                if (focusGraphRow) {\n                    this.focusModel.focusRowHeight = focusGraphRow.offsetHeight;\n                    this.setFocusFromAndToDate();\n                    this.positionFocusFromAndToDate();\n                    this.drawFocusGraphData();\n                    this.autoSrollFocusGraph();\n                }\n            });\n        } else {\n            this.showFocus = false;\n        }\n    }\n\n    getFocusGraphPointWidth() {\n        return this.isGrouped ? this.config.focusGraph.groupedPointWidth : this.config.focusGraph.ungroupedPointWidth;\n    }\n\n    initialiseFocusGraphData() {\n        if (!this.focusModel.data) {\n            this.focusModel.data = [];\n        }\n\n        this.focusModel.data.length = 0;\n\n        this.overviewModel.data.forEach((overviewInstance) => {\n            if (this.checkInstanceInFocus(overviewInstance)) {\n                this.focusModel.focusedIndexList = this.getIndexesOfPointsInFocus(overviewInstance);\n                var focusInstance = this.getFocusInstance(overviewInstance, this.focusModel.focusedIndexList);\n                this.focusModel.data.push(focusInstance);\n            }\n        });\n    }\n\n    checkInstanceInFocus(instance) {\n        return instance.y <= this.focusModel.focusStartY + this.getFocusAreaSize() &&\n            instance.y + this.overviewModel.overviewInstanceHeight >= this.focusModel.focusStartY\n    }\n\n    getIndexesOfPointsInFocus(overviewInstance) {\n        var indexes = [];\n\n        for (var i = 0; i < overviewInstance.metricList.length; ++i) {\n            var metric = overviewInstance.metricList[i];\n\n            if (metric.data.length > 0) {\n                var overviewMetric = this.overviewModel.metricList[i];\n\n                metric.data.forEach((point, index) => {\n                    if (this.isBetween(point.x, overviewMetric.focusStartX, overviewMetric.focusStartX + this.getFocusAreaSize())) {\n                        indexes.push(index);\n                    }\n                });\n\n                break;\n            }\n        }\n\n        return indexes;\n    }\n\n    getFocusInstance(overviewInstance, indexList) {\n        var focusInstance = {};\n        focusInstance.instance = overviewInstance.instance;\n        focusInstance.overviewInstance = overviewInstance;\n        this.initialiseFocusInstanceData(focusInstance, overviewInstance, indexList);\n        return focusInstance;\n    }\n\n    initialiseFocusInstanceData(focusInstance, overviewInstance, indexList) {\n        focusInstance.metricList = [];\n        this.addFocusMetrics(focusInstance, overviewInstance, indexList);\n        this.initialiseInstanceLayers(focusInstance);\n    }\n\n    addFocusMetrics(focusInstance, overviewInstance, indexList) {\n        this.overviewModel.metricList.forEach((metric, metricIndex) => {\n            var focusMetric = {};\n            focusMetric.data = [];\n            focusMetric.layerList = [];\n\n            indexList.forEach((index) => {\n                var point = overviewInstance.metricList[metricIndex].data[index];\n\n                if (point) {\n                    focusMetric.data.push(point);\n                }\n            });\n\n            focusInstance.metricList.push(focusMetric);\n        });\n    }\n\n    initialiseInstanceLayers(instance) {\n        instance.metricList.forEach((metric, metricIndex) => {\n            this.panel.metricList[metricIndex].colorList.forEach(() => {\n                var layer = {};\n                layer.valueList = [];\n                metric.layerList.push(layer);\n            });\n\n            metric.data.forEach((point) => {\n                var value = point.value;\n\n                metric.layerList.forEach((layer) => {\n                    layer.valueList.push(value > 0 ? value : 0);\n                    value -= this.overviewModel.metricList[metricIndex].layerRange;\n                });\n            });\n        });\n    }\n\n    setFocusFromAndToDate() {\n        for (var instanceIndex = 0; instanceIndex < this.overviewModel.data.length; ++instanceIndex) {\n            var instance = this.overviewModel.data[instanceIndex];\n            var set = false;\n\n            for (var metricIndex = 0; metricIndex < instance.metricList.length; ++metricIndex) {\n                var metric = instance.metricList[metricIndex];\n                var fromIndex = this.focusModel.focusedIndexList[0];\n                var toIndex = this.focusModel.focusedIndexList[this.focusModel.focusedIndexList.length - 1];\n\n                if (metric.data[fromIndex] && metric.data[toIndex]) {\n                    this.focusedFromDate = this.getDateString(metric.data[fromIndex].date * 1000);\n                    this.focusedToDate = this.getDateString(metric.data[toIndex].date * 1000);\n                    set = true;\n                    break;\n                }\n            }\n\n            if (set) {\n                break;\n            }\n        }\n    }\n\n    positionFocusFromAndToDate() {\n        this.timeFontSize = this.config.overview.timeFontSize;\n        this.setOverviewContextTimeFont();\n        var canvasStartX = this.getElementByID(\"canvasCell\").offsetLeft;\n        var fromDateWidth = this.overviewContext.measureText(this.focusedFromDate).width;\n        this.fromDateLeftMargin = canvasStartX - (fromDateWidth / 2);\n        this.toDateLeftMargin = this.focusGraphWidth - fromDateWidth;\n    }\n\n    drawFocusGraphData() {\n        if (this.isGrouped) {\n            this.$timeout(() => {\n                if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n                    this.focusGraphMarkerWidth = (this.config.focusGraph.markerSize + this.config.focusGraph.marginBetweenMarkers) *\n                        this.overviewModel.metricList.length;\n                } else {\n                    this.focusGraphMarkerWidth = this.config.focusGraph.markerSize + this.config.focusGraph.marginBetweenMarkers;\n                }\n\n                this.focusGraphMarkerHeight = this.config.focusGraph.markerSize;\n                this.scope.$apply();\n                this.drawGroupFocusMarkers();\n                this.drawGroupedFocusGraph();\n            });\n        } else {\n            this.drawUngroupedFocusGraph();\n        }\n    }\n\n    drawGroupFocusMarkers() {\n        this.focusModel.groupList.forEach((group, groupIndex) => {\n            group.instanceList.forEach((instance, instanceIndex) => {\n                if (instanceIndex == 0 || group.showDetails) {\n                    this.drawGroupedFocusMarker(group, groupIndex, instance, instanceIndex);\n                }\n            });\n        });\n    }\n\n    drawGroupedFocusMarker(group, groupIndex, instance, instanceIndex) {\n        var canvas = this.getElementByID(\"focusGroupMarkerCanvas-\" + groupIndex + \"-\" + instanceIndex);\n        var context = this.getCanvasContext(canvas);\n        context.clearRect(0, 0, canvas.width, canvas.height);\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE && group.showDetails) {\n            instance.groupWithMarkerList = [];\n\n            instance.overviewInstance.groupList.forEach((instanceGroup, instanceGroupIndex) => {\n                if (instanceGroup.isSelected) {\n                    instance.groupWithMarkerList.push(instanceGroup);\n                    var x = (this.config.focusGraph.markerSize + this.config.focusGraph.marginBetweenMarkers) * instanceGroupIndex;\n                    this.drawGroupedFocusMarkerWrapper(context, instanceGroup, x);\n                }\n            });\n        } else {\n            this.drawGroupedFocusMarkerWrapper(context, group.overviewGroup, 0);\n        }\n    }\n\n    drawGroupedFocusMarkerWrapper(context, group, x) {\n        if (group == this.focusGroupWithInterval) {\n            x += this.focusGroupWithInterval.focusMarkerX;\n        }\n\n        context.fillStyle = group.color;\n        context.fillRect(x, 0, this.config.focusGraph.markerSize, this.config.focusGraph.markerSize);\n    }\n\n    drawGroupedFocusGraph() {\n        this.focusModel.groupList.forEach((group, groupIndex) => {\n            group.instanceList.forEach((instance, instanceIndex) => {\n                if (instanceIndex == 0 || group.showDetails) {\n                    this.drawGroupedFocusGraphWrapper(groupIndex, instance, instanceIndex);\n                }\n            });\n        });\n    }\n\n    drawGroupedFocusGraphWrapper(groupIndex, instance, instanceIndex) {\n        var canvas = this.getElementByID(\"focusGraphCanvas-\" + groupIndex + \"-\" + instanceIndex);\n        var context = this.getCanvasContext(canvas);\n        context.clearRect(0, 0, canvas.width, canvas.height);\n        this.drawFocusGraphInstance(instance, context);\n    }\n\n    drawFocusGraphInstance(instance, context) {\n        instance.metricList.forEach((metric, metricIndex) => {\n            metric.layerList.forEach((layer, layerIndex) => {\n                // start drawing from bottom\n                var y = (this.config.focusGraph.metricMaxHeight + this.config.focusGraph.marginBetweenMetrics) * metricIndex +\n                    this.config.focusGraph.metricMaxHeight;\n                context.beginPath();\n                context.moveTo(0, y);\n                var x = 0;\n                var previousX = 0;\n                var previousValue = 0;\n\n                layer.valueList.forEach((value, valueIndex) => {\n                    x = this.getFocusGraphPointWidth() * valueIndex;\n                    this.moveContextBasedOnValue(context, value, previousX, previousValue, layerIndex, x, y,\n                        this.overviewModel.metricList[metricIndex].layerRange);\n                    previousX = x;\n                    previousValue = value;\n                });\n\n                context.lineTo(x, y);\n                context.lineTo(this.focusModel.graphBeginX, y);\n                context.closePath();\n                context.fillStyle = this.panel.metricList[metricIndex].colorList[layerIndex];\n                context.fill();\n            });\n        });\n    }\n\n    drawUngroupedFocusGraph() {\n        this.focusModel.data.forEach((instance, instanceIndex) => {\n            var canvas = this.getElementByID(\"focusGraphCanvas-\" + instanceIndex);\n            var context = this.getCanvasContext(canvas);\n            context.clearRect(0, 0, canvas.width, canvas.height);\n            this.drawFocusGraphInstance(instance, context);\n        });\n    }\n\n    moveContextBasedOnValue(context, value, previousX, previousValue, layerIndex, x, y, layerRange) {\n        if (value == 0) {\n            // draw line straight down to base if value is 0\n            context.lineTo(previousX, y);\n        } else {\n            // move to current position at base if previous value is 0\n            if (layerIndex > 0 && previousValue == 0) {\n                context.lineTo(x, y);\n            }\n\n            if (value >= layerRange) {\n                context.lineTo(x, y - this.config.focusGraph.metricMaxHeight);\n            } else {\n                context.lineTo(x, y - value * this.config.focusGraph.metricMaxHeight / layerRange);\n            }\n        }\n    }\n\n    autoSrollFocusGraph() {\n        if (this.isGrouped) {\n            if (this.overviewModel.hoveredGroup && this.overviewModel.hoveredGroup.isSelected) {\n                var rowCount = 0;\n\n                this.focusModel.groupList.forEach((group) => {\n                    if (group.showDetails) {\n                        rowCount += group.instanceList.length;\n                    } else {\n                        ++rowCount;\n                    }\n                });\n\n                this.focusGraphContainer.scrollTop = this.focusModel.focusRowHeight * rowCount;\n            }\n        } else {\n            this.scrollByInstance();\n        }\n    }\n\n    scrollByInstance() {\n        var instance = this.getHoveredInstance();\n\n        if (instance) {\n            for (var i = 0; i < this.focusModel.data.length; ++i) {\n                var focusModelInstance = this.focusModel.data[i];\n\n                if (instance.instance == focusModelInstance.instance) {\n                    focusModelInstance.isSelected = true;\n                    this.focusGraphContainer.scrollTop = this.focusModel.focusRowHeight * i;\n                } else {\n                    focusModelInstance.isSelected = false;\n                }\n            }\n        }\n    }\n\n    getHoveredInstance() {\n        for (var i = 0; i < this.overviewModel.data.length; ++i) {\n            var instance = this.overviewModel.data[i];\n\n            if (this.isBetween(this.overviewModel.mousePosition.y, instance.y - this.config.overview.ungroupedPointHeight, instance.y)) {\n                return instance;\n            }\n        }\n    }\n\n    moveMouseOnFocusGroup(group, instance) {\n        if (this.groupingMode == this.enumList.groupingMode.MULTIPLE || !group.showDetails) {\n            this.focusModel.overviewGroupWithIntervalList = [group.overviewGroup];\n            this.startOverviewMarkerInterval(group);\n        } else {\n            this.focusModel.overviewGroupWithIntervalList = instance.groupWithMarkerList;\n            this.startOverviewMarkerInterval(group);\n        }\n    }\n\n    startOverviewMarkerInterval(group) {\n        if (this.overviewGroupWithInterval != group) {\n            this.stopInterval();\n            this.overviewGroupWithInterval = group;\n            this.initialiseOverviewMarkerInterval();\n        }\n    }\n\n    initialiseOverviewMarkerInterval() {\n        this.overviewMarkerMovingBackwards = false;\n        this.overviewGroupWithInterval.overviewMarkerX = 0;\n\n        this.currentOverviewMarkerInterval = this.$interval(() => {\n            if (this.overviewMarkerMovingBackwards) {\n                this.handleOverviewMarkerMovingBackwardCase();\n            } else {\n                this.handleOverviewMarkerMovingForwardCase();\n            }\n\n            this.focusModel.overviewGroupWithIntervalList.forEach((overviewGroup) => {\n                overviewGroup.markerX = this.overviewGroupWithInterval.overviewMarkerX;\n            });\n\n            this.drawSelectedGroupsMarkers();\n        }, this.config.intervalTimer);\n    }\n\n    handleOverviewMarkerMovingBackwardCase() {\n        if (this.overviewGroupWithInterval.overviewMarkerX == 0) {\n            this.overviewMarkerMovingBackwards = false;\n            ++this.overviewGroupWithInterval.overviewMarkerX;\n        } else {\n            --this.overviewGroupWithInterval.overviewMarkerX;\n        }\n    }\n\n    handleOverviewMarkerMovingForwardCase() {\n        if (this.overviewGroupWithInterval.overviewMarkerX == Math.round(this.config.overview.marginBetweenMarkerAndGroup / 2)) {\n            this.overviewMarkerMovingBackwards = true;\n            --this.overviewGroupWithInterval.overviewMarkerX;\n        } else {\n            ++this.overviewGroupWithInterval.overviewMarkerX;\n        }\n    }\n\n    showNodes(group, event) {\n        event.preventDefault();\n\n        this.$timeout(() => {\n            group.showDetails = !group.showDetails;\n            this.scope.$apply();\n            this.drawFocusGraphData();\n        });\n    }\n\n    selectNode(instance) {\n        if (this.isGrouped) {\n            this.focusModel.groupList.forEach((group) => {\n                group.instanceList.forEach((instance) => {\n                    instance.isSelected = false;\n                })\n            });\n        } else {\n            this.focusModel.data.forEach((focusInstance) => {\n                focusInstance.isSelected = false;\n            });\n        }\n\n        instance.isSelected = true;\n        this.updateVariable(instance);\n    }\n\n    updateVariable(instance) {\n        this.variableSrv.variables.forEach((v) => {\n            if (v.name == \"node\") {\n                this.variableSrv.setOptionAsCurrent(v, {\n                    text: instance.instance,\n                    value: instance.instance\n                });\n\n                this.isUpdatingVariable = true;\n                this.variableSrv.variableUpdated(v, true);\n            }\n        });\n    }\n\n    removeMetric(metric) {\n        _.remove(this.panel.metricList, (search) => {\n            return search == metric;\n        });\n    }\n\n    addMetric() {\n        var metric = {};\n        metric.color = \"#000000\";\n        this.panel.metricList.push(metric);\n    }\n}\n\nHeatmapCtrl.templateUrl = \"module.html\";"],"file":"heatmap_ctrl.js"}