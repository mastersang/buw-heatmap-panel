{"version":3,"sources":["../src/heatmap_ctrl.js"],"names":["MetricsPanelCtrl","moment","_","HeatmapCtrl","$scope","$injector","$timeout","$interval","variableSrv","timeSrv","scope","initialiseConfig","initialisePanelDefaults","initialisePredefinedMetricOptionList","initialiseMetricsColorList","initialiseStartingVariables","events","on","onInitEditMode","bind","onDataReceived","initialiseGeneralConfig","initialiseOverviewConfig","initialiseFocusAreaConfig","initialiseHistogramConfig","initialiseTimeIndicatorConfig","initialiseFocusGraphConfig","config","apiAddress","dateFormat","colorCount","maxLuminanceChange","marginBetweenOverviewAndFocus","groupingThresholdCount","startingGreyColor","endingGrayColor","intervalTimer","overview","topAndBottomPadding","metricFontSize","timeFontSize","marginBetweenLabelsAndOverview","pointWidth","ungroupedPointHeight","groupedPointHeight","compressedMarginBetweenMetrics","decompressedMarginBetweenMetrics","marginBetweenGroups","groupSizeBarWidth","pieRadius","marginBetweenMarkerAndGroup","marginBetweenMetricAndGroupSize","groupSizeColor","focusArea","color","focusAreaSize","xCrossSize","timeIndicator","histogram","marginBetweenAxesAndNumbers","verticalAxisLength","barWidth","minimumBarHeight","marginBetweenSliderAndChart","thresholdBarLength","focusGraph","maxWidth","maxHeight","groupedPointWidth","ungroupedPointWidth","metricMaxHeight","marginBetweenMetrics","panelDefaults","predefinedMetricList","name","unit","query","defaults","panel","metricList","predefinedMetricOptionList","forEach","metric","push","initialiseColorListByMetric","colorList","luminanceChange","i","changeColorLuminance","firstLoad","overviewModel","histogramModel","groupMarkerList","focusModel","groupList","hex","lum","String","replace","length","rgb","c","parseInt","substr","Math","round","min","max","toString","index","isCustom","predefinedMetric","JSON","parse","stringify","elem","initialiseControl","initialiseUIElements","enumList","groupingMode","SINGLE","MULTIPLE","groupSizeChart","HORIZONTAL_BAR","PIE","timeHighlightMode","POINT","RANGE","groupingThreshold","initialiseOverviewCanvasCursor","overviewCursor","isGrouped","overviewCanvas","getElementByID","overviewContext","getCanvasContext","focusAreaCanvas","focusAreaContext","histogramCanvas","histogramCanvasContext","overviewTimeIndicatorCanvas","overviewTimeIndicatorContext","focusGraphWidth","focusGraphHeight","focusGraphContainer","id","find","canvas","getContext","addEditorTab","data","load","isLoading","$apply","loadCount","fromDate","getDateInSeconds","timeRange","from","_d","toDate","to","getDataFromAPI","processRawData","date","getTime","xmlHttp","XMLHttpRequest","onreadystatechange","readyState","status","responseText","result","url","encodeURIComponent","open","send","includes","convertDataToFloat","initialiseMetricMinMaxTotal","initialiseColorMap","initialiseOverviewData","initialiseOverviewGroups","initialiseCompressedTimeIndexes","renderOverview","instance","values","value","parseFloat","metricIndex","point","checkAndSetOverviewMinMax","console","log","overviewMetric","panelMetric","initialiseColorMapByMetric","layerRange","colorMap","getColorMap","Map","threshold","average","set","populateOverviewDataAndInitialiseHistogramData","calculateInstanceMetricTotalMinMax","sortOverviewData","metricInstance","newInstance","search","initaliseNewInstance","has","occurences","get","sort","first","second","setHistogramMinMax","total","map","isBetween","target","start","end","initialiseSingleMetricGroups","initialiseMultiMetricGroups","initialiseSingleMetricGroupsByMetric","initialiseSingleMetricGroupsColor","initialiseSingleMetricInstanceGroupList","thresholdGroupListMap","populateSingleMetricGroupList","groupIndex","group","checkInstanceIsInGroup","initialiseNewSingleMetricGroup","instanceList","groupTotal","instanceTotal","thresholdValue","markerX","originalColor","getCurrentSingleMetricGroupList","populateMultiMetricGroupList","initialiseMultiMetricGroupsColor","findExistingMultiMetricGroup","initialiseNewMultiMetricGroup","instanceMetric","groupMetric","greyValue","compressedTimeIndexList","initialiseInstanceCompressedTimeRangeList","compressedIndexRangeList","range","presviousRange","pointIndex","thresholdAverage","getThresholdAverage","initialiseNewCompressedTimeRange","clearFocusArea","drawOverview","hasFocus","clearRect","width","height","setOverviewCanvasSize","focusGraphMarginTop","overviewCanvasHeight","drawOverviewData","setOverviewContextLabelFont","labelTextHeight","measureText","overviewStartY","setOverviewWidth","setOverviewHeight","setOverviewContextTimeFont","getMarginBetweenMetrics","overviewWidth","isCompressed","getMaxMetricLength","overviewCanvasWidth","convertDateToString","toDateWidth","setGroupedOverviewCanvasWidth","instanceWithMostPoints","maxBy","getMaxGroupSizeBarLength","getMaxMultiMetricGroupSize","largestGroup","getCurrentMultiMetricGroupList","groupCount","getMaxGroupCount","instanceHeight","overviewHeight","font","overviewEndY","setOverviewMetricStartXAndEndX","drawGroupedOverview","drawUngroupedOverview","drawMetricLabels","drawToDateLabel","setOverviewMetricStartX","endX","startX","previousMetric","maxGroupSizeBarLength","drawSingeMetricGroupedOverview","drawMultiMetricGroupedOverview","drawGroupSize","drawGroupedOverviewWrapper","drawMetricSeparator","metricIndexList","y","drawOverviewInstance","pointHeight","endY","drawOverviewInstancePoints","rangeIndex","drawOverviewInstancePoint","x","getColorFromMap","fillStyle","fillRect","getAllMetricIndexList","Array","keys","label","groupSizeLabelWidth","drawSingleMetricGroupSize","drawMultipleMetricGroupSize","drawSingleMetricBarGroupSize","drawSingleMetricPieGroupSize","drawGroupSizeLabel","drawBarGroupSizeWrapper","isSelected","overlapMap","startOverlapX","count","overlappingGroup","beginPath","moveTo","lineTo","closePath","fill","startAngle","PI","drawPieGroupSizeWrapper","size","endAngle","arc","fillText","maxEndX","strokeStyle","stroke","instanceIndex","getMetricDarkestColor","format","showHistogram","changedColorThreshold","temp","addOrRemoveGroupToFocus","overviewGroup","drawFocusGraph","removeExisting","focusGroup","remove","addGroupToFocus","setShowMergeGroupsButton","showMergeSelectedGroups","setShowMergeGroupsButtonWrapper","selectedGroupCount","drawOverviewGroupMarker","marker","startY","initialiseFocusGraphData","showFocus","focusedIndexList","getFocusGraphPointWidth","focusGraphRow","focusRowHeight","offsetHeight","setFocusFromAndToDate","positionFocusFromAndToDate","drawFocusGraphData","autoSrollFocusGraph","evt","mousePosition","getMousePos","isSelectingBar","setNewThresholdValue","checkAndSetSelectedHistogramThresholdBar","horizontalAxisStartX","selectedBar","drawHistogram","histogramCursor","topY","sliderY","bottomY","thresholdBarList","bar","leftX","rightX","changeGroupingSelection","clearTimeIndicator","deselectAllGroups","deselectSingleMetricGroups","deselectMultiMetricGroups","originalGroupList","previousGroupThreshold","timeRangeIndexList","mergeSingleMetricGroups","mergeMultipleMetricGroups","mergeFocusGroupList","initialiseGroupsOverlapMap","drawSelectedGroupsMarkers","mergeSelectedGroupsWrapper","currentGroupList","populateMergedGroupList","mergedGroup","mergeFocusGroupListWrapper","mainMetricIndex","selectedMetricIndex","overviewInstance","metricWithMostData","focusInstance","getFocusInstance","checkAndAddOverlappingGroupsFromOtherMetrics","overlappingMetric","overlappingGroupList","checkAndAddOverlappingGroup","overlappingCount","overlappingInstance","isSelectingMetricLabel","hoveredGroup","isSelectingTimeRange","timeRangeStartOffset","mousePositionXOffset","timeRangeGroup","histogramMetric","$watch","newValue","oldValue","drawHistogramAxes","drawHistogramMaxValueAndOccurence","drawHistogramBars","drawHistogramThresholdSlider","verticalAxisStartY","lineWdith","drawHistogramVerticalAxis","drawHistogramHorizontalAxis","verticalLabelWidth","maxOccurenceWidth","horizontalAxisY","horizontalAxisEndX","labelX","labelY","occurenceLabelY","maxValueWidth","valueLabelY","originX","occurenceStep","minHeight","drawHistogramSliderLine","drawHistogramThresholdBars","thresholdBarY","setOverviewMousePosition","setSelectedMetricIndex","setOverviewCursorToPointer","deselectMetricLabel","handleMouseMoveOnGroupedOverview","focusAreaIsFixed","drawFocus","rect","getBoundingClientRect","clientX","left","clientY","top","checkMouseIsInMetric","hoveredMarker","checkAndSetSelectedOverviewMarker","checkAndSetHoveredGroup","setSelectedTimeIndex","drawTimeIndicators","initialiseSelectedGroupTimeRangeIndexList","drawSelectedTimeRanges","markerIndex","checkAndSetHoveredGroupInGroupList","checkGroupIsHovered","compressedTimeIndex","checkDataPointIsSelected","selectedTimeIndex","drawTimeIndicatorWrapper","drawSelectedTimeLabel","horizontalLineY","drawHorizontalTimeLine","verticalLineX","getTimeIndicatorXForNonSelectedMetric","drawSelectedTimePoint","previousPointIndex","currentPointIndex","checkDataPointIsSelectedAndDrawTimeLabel","timeRangeMetricIndex","setTimeRangeStartAndEndDate","startPoint","startTimeRangeDate","endPoint","endTimeRangeDate","drawSelectedTimeRangeWrapper","startRangeIndex","endRangeIndex","getTimeRangePointWrapper","drawSelectedTimeRangeLines","startFocusMarkerInterval","updateSelectedGroupListAndDrawFocusGraph","fixFocusArea","focusGroupWithInterval","stopInterval","initialiseFocusMarkerInterval","stopOverviewMarkerInterval","stopFocusMarkerInterval","currentOverviewMarkerInterval","cancel","overviewGroupWithInterval","overviewMarkerX","overviewGroupWithIntervalList","currentFocusMarkerInterval","focusMarkerX","drawGroupFocusMarkers","focusMarkerMovingBackwards","handleFocusMarkerMovingBackwardCase","handleFocusMarkerMovingForwardCase","marginBetweenMarkers","updatedSelectedGroups","drawFocusArea","getFocusAreaSize","minimumTopY","focusStartY","offset","getFocusAreaOffset","focusStartX","strokeRect","sourceMetricIndex","checkInstanceInFocus","getIndexesOfPointsInFocus","indexes","indexList","initialiseFocusInstanceData","addFocusMetrics","initialiseInstanceLayers","focusMetric","layerList","layer","valueList","layerIndex","fromIndex","toIndex","focusedFromDate","focusedToDate","canvasStartX","offsetLeft","fromDateWidth","fromDateLeftMargin","toDateLeftMargin","focusGraphMarkerWidth","markerSize","focusGraphMarkerHeight","drawGroupedFocusGraph","drawUngroupedFocusGraph","showDetails","drawGroupedFocusMarker","context","groupWithMarkerList","instanceGroup","instanceGroupIndex","drawGroupedFocusMarkerWrapper","drawGroupedFocusGraphWrapper","maxMetricLength","getGroupedFocusCanvas","showAllMetrics","drawGroupedFocusGraphInstance","floor","focusGraphHeightoverviewGroup","valueIndexList","drawFocusGraphInstance","metricListIndex","previousX","previousValue","valueIndex","positionIndex","moveFocusGraphContextBasedOnValue","graphBeginX","getUngroupedFocusCanvas","rowCount","scrollTop","scrollByInstance","getHoveredInstance","focusModelInstance","startOverviewMarkerInterval","initialiseOverviewMarkerInterval","overviewMarkerMovingBackwards","handleOverviewMarkerMovingBackwardCase","handleOverviewMarkerMovingForwardCase","event","preventDefault","showPopup","mousePos","metricHeight","popupURL","window","templateUrl"],"mappings":"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","sourcesContent":["import { MetricsPanelCtrl } from \"app/plugins/sdk\";\nimport \"./heatmap.css!\";\nimport moment from \"moment\";\nimport _ from \"lodash\";\n\nexport class HeatmapCtrl extends MetricsPanelCtrl {\n    constructor($scope, $injector, $timeout, $interval, variableSrv, timeSrv) {\n        super($scope, $injector);\n        this.scope = $scope;\n        this.$timeout = $timeout;\n        this.$interval = $interval;\n        this.variableSrv = variableSrv;\n        this.timeSrv = timeSrv;\n\n        this.initialiseConfig();\n        this.initialisePanelDefaults();\n        this.initialisePredefinedMetricOptionList();\n        this.initialiseMetricsColorList();\n        this.initialiseStartingVariables();\n\n        this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n        this.events.on(\"data-received\", this.onDataReceived.bind(this));\n    }\n\n    initialiseConfig() {\n        this.initialiseGeneralConfig();\n        this.initialiseOverviewConfig();\n        this.initialiseFocusAreaConfig();\n        this.initialiseHistogramConfig();\n        this.initialiseTimeIndicatorConfig()\n        this.initialiseHistogramConfig();\n        this.initialiseFocusGraphConfig();\n    }\n\n    initialiseGeneralConfig() {\n        this.config = {\n            apiAddress: \"http://localhost:3000/api/datasources/proxy/1/api/v1/query_range?query=\",\n            dateFormat: \"DD/MM/YY HH:mm:ss\",\n            colorCount: 4,\n            maxLuminanceChange: 0.8,\n            marginBetweenOverviewAndFocus: 20,\n            groupingThresholdCount: 50,\n            startingGreyColor: 240,\n            endingGrayColor: 80,\n            intervalTimer: 70\n        }\n    }\n\n    initialiseOverviewConfig() {\n        this.config.overview = {\n            topAndBottomPadding: 20,\n            metricFontSize: 12,\n            timeFontSize: 10,\n            marginBetweenLabelsAndOverview: 10,\n            pointWidth: 1,\n            ungroupedPointHeight: 1,\n            groupedPointHeight: 5,\n            compressedMarginBetweenMetrics: 100,\n            decompressedMarginBetweenMetrics: 25,\n            marginBetweenGroups: 10,\n            groupSizeBarWidth: 1,\n            pieRadius: 15,\n            marginBetweenMarkerAndGroup: 15,\n            marginBetweenMetricAndGroupSize: 30,\n            groupSizeColor: \"lightgray\"\n        }\n    }\n\n    initialiseFocusAreaConfig() {\n        this.config.focusArea = {\n            color: \"Aqua\",\n            focusAreaSize: 20,\n            xCrossSize: 15\n        }\n    }\n\n    initialiseTimeIndicatorConfig() {\n        this.config.timeIndicator = {\n            color: \"DarkGray\"\n        }\n    }\n\n    initialiseHistogramConfig() {\n        this.config.histogram = {\n            marginBetweenAxesAndNumbers: 20,\n            verticalAxisLength: 500,\n            barWidth: 5,\n            minimumBarHeight: 2,\n            marginBetweenSliderAndChart: 50,\n            thresholdBarLength: 10\n        }\n    }\n\n    initialiseFocusGraphConfig() {\n        this.config.focusGraph = {\n            maxWidth: 10000,\n            maxHeight: 10000,\n            groupedPointWidth: 6,\n            ungroupedPointWidth: 35,\n            metricMaxHeight: 20,\n            marginBetweenMetrics: 10,\n            maxHeight: 10000,\n            markerSize: 20,\n            marginBetweenMarkers: 20\n        }\n    }\n\n    initialisePanelDefaults() {\n        this.panelDefaults = {\n            predefinedMetricList: [\n                {\n                    name: \"CPU\",\n                    unit: \"%\",\n                    //    query: \"node_load1{job='node'}) * 100 / count by (instance) (count by (instance, cpu) (node_cpu_seconds_total{job='node'}))\"\n                    query: \"node_load1{job='node'}\"\n                },\n\n                {\n                    name: \"Memory\",\n                    unit: \"%\",\n                    query: \"100 - (node_memory_MemTotal_bytes{job='node'} + node_memory_Buffers_bytes{job='node'} - node_memory_MemFree_bytes{job='node'} - node_memory_Cached_bytes{job='node'}) * 100 / (node_memory_MemTotal_bytes{job='node'} + node_memory_Buffers_bytes{job='node'})\",\n                },\n\n                {\n                    name: \"Disk\",\n                    unit: \"%\",\n                    query: \"100 - (sum by (instance) (node_filesystem_avail_bytes{job='node',device!~'(?:rootfs|/dev/loop.+)', mountpoint!~'(?:/mnt/nfs/|/run|/var/run|/cdrom).*'})) * 100 / (sum by (instance) (node_filesystem_size_bytes{job='node',device!~'rootfs'}))\",\n                },\n\n                {\n                    name: \"Network\",\n                    unit: \"MiB\",\n                    query: \"sum by (instance) (rate(node_network_receive_bytes_total{job='node',device!~'^(?: docker | vboxnet | veth | lo).*'}[5m])) / 1048576\",\n                },\n\n                {\n                    name: \"Disk Temperature\",\n                    unit: \"°C\",\n                    query: \"avg by (instance) (smartmon_temperature_celsius_raw_value{job='node',smart_id='194'})\",\n                }\n            ]\n        };\n\n        // this.panel.predefinedMetricList = this.panelDefaults.predefinedMetricList;\n        //   this.panel.metricList = this.panel.predefinedMetricList;\n        _.defaults(this.panel, this.panelDefaults);\n\n        if (!this.panel.metricList) {\n            this.panel.metricList = this.panel.predefinedMetricList;\n        }\n    }\n\n    initialisePredefinedMetricOptionList() {\n        this.predefinedMetricOptionList = [];\n\n        this.panelDefaults.predefinedMetricList.forEach((metric) => {\n            this.predefinedMetricOptionList.push(metric.name);\n        });\n    }\n\n    initialiseMetricsColorList() {\n        if (this.panel.metricList) {\n            this.panel.metricList.forEach((metric) => {\n                this.initialiseColorListByMetric(metric);\n            });\n        }\n    }\n\n    initialiseColorListByMetric(metric) {\n        // add lightest shade as defined by user\n        metric.colorList = [];\n        metric.colorList.push(metric.color);\n        var luminanceChange = -this.config.maxLuminanceChange / this.config.colorCount;\n\n        // add the other shades\n        for (var i = 1; i < this.config.colorCount; ++i) {\n            var color = this.changeColorLuminance(metric.color, i * luminanceChange);\n            metric.colorList.push(color);\n        }\n    }\n\n    initialiseStartingVariables() {\n        this.firstLoad = true;\n        this.overviewModel = {};\n        this.histogramModel = {};\n        this.overviewModel.groupMarkerList = [];\n        this.focusModel = {};\n        this.focusModel.groupList = [];\n    }\n\n    changeColorLuminance(hex, lum) {\n        hex = String(hex).replace(/[^0-9a-f]/gi, '');\n\n        if (hex.length < 6) {\n            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n        }\n\n        lum = lum || 0;\n        var rgb = \"#\", c, i;\n\n        for (i = 0; i < 3; i++) {\n            c = parseInt(hex.substr(i * 2, 2), 16);\n            c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\n            rgb += (\"00\" + c).substr(c.length);\n        }\n\n        return rgb;\n    }\n\n    selectPredefinedMetric(index) {\n        var metric = this.panel.metricList[index];\n\n        if (!metric.isCustom) {\n            for (var i = 0; i < this.panel.predefinedMetricList.length; ++i) {\n                var predefinedMetric = this.panel.predefinedMetricList[i];\n\n                if (metric.name == predefinedMetric.name) {\n                    this.panel.metricList[index] = JSON.parse(JSON.stringify(predefinedMetric));\n                    break;\n                }\n            }\n        }\n    }\n\n    link(scope, elem) {\n        this.scope = scope;\n        this.elem = elem;\n\n        this.initialiseControl();\n        this.initialiseUIElements();\n    }\n\n    initialiseControl() {\n        this.enumList = {\n            groupingMode: {\n                SINGLE: \"1\",\n                MULTIPLE: \"2\",\n            },\n\n            groupSizeChart: {\n                HORIZONTAL_BAR: \"1\",\n                PIE: \"2\",\n            },\n\n            timeHighlightMode: {\n                POINT: \"1\",\n                RANGE: \"2\"\n            }\n        };\n\n        this.groupingMode = this.enumList.groupingMode.SINGLE;\n        this.groupSizeChart = this.enumList.groupSizeChart.HORIZONTAL_BAR;\n        this.groupingThreshold = 0;\n        this.timeHighlightMode = this.enumList.timeHighlightMode.POINT;\n        this.initialiseOverviewCanvasCursor();\n    }\n\n    initialiseOverviewCanvasCursor() {\n        this.overviewCursor = this.isGrouped ? \"default\" : \"crosshair\";\n    }\n\n    initialiseUIElements() {\n        // overview\n        this.overviewCanvas = this.getElementByID(\"overviewCanvas\");\n        this.overviewContext = this.getCanvasContext(this.overviewCanvas);\n\n        // focus area + overview group markers\n        this.focusAreaCanvas = this.getElementByID(\"focusAreaCanvas\");\n        this.focusAreaContext = this.getCanvasContext(this.focusAreaCanvas);\n\n        // histogram\n        this.histogramCanvas = this.getElementByID(\"histogramCanvas\");\n        this.histogramCanvasContext = this.getCanvasContext(this.histogramCanvas);\n\n        // overview time indicator\n        this.overviewTimeIndicatorCanvas = this.getElementByID(\"overviewTimeIndicatorCanvas\");\n        this.overviewTimeIndicatorContext = this.getCanvasContext(this.overviewTimeIndicatorCanvas);\n\n        // focus graph\n        this.focusGraphWidth = this.config.focusGraph.maxWidth;\n        this.focusGraphHeight = this.config.focusGraph.maxHeight;\n        this.focusGraphContainer = this.getElementByID(\"focusGraphContainer\");\n    }\n\n    getElementByID(id) {\n        var find = this.elem.find(\"#\" + id);\n        return find[0];\n    }\n\n    getCanvasContext(canvas) {\n        return canvas.getContext(\"2d\");\n    }\n\n    onInitEditMode() {\n        this.addEditorTab('Options', 'public/plugins/buw-heatmap-panel/editor.html', 2);\n    }\n\n    onDataReceived(data) {\n        this.load();\n    }\n\n    load() {\n        this.$timeout(() => {\n            this.isLoading = true;\n\n            this.scope.$apply();\n\n            this.overviewModel.metricList = [];\n\n            this.panel.metricList.forEach(() => {\n                this.overviewModel.metricList.push(null);\n            });\n\n            this.loadCount = 0;\n            this.fromDate = this.getDateInSeconds(this.timeSrv.timeRange().from._d);\n            this.toDate = this.getDateInSeconds(this.timeSrv.timeRange().to._d);\n\n            this.panel.metricList.forEach((metric, index) => {\n                this.getDataFromAPI(metric.query, index);\n            });\n\n            this.processRawData();\n        });\n    }\n\n    getDateInSeconds(date) {\n        return Math.round(date.getTime() / 1000);\n    }\n\n    getDataFromAPI(query, index) {\n        var xmlHttp = new XMLHttpRequest();\n\n        xmlHttp.onreadystatechange = () => {\n            // received response\n            if (xmlHttp.readyState == 4) {\n                ++this.loadCount;\n\n                if (xmlHttp.status == 200) {\n                    var metric = {}\n                    metric.data = JSON.parse(xmlHttp.responseText).data.result;\n                    this.overviewModel.metricList[index] = metric;\n                }\n            }\n        }\n\n        var url = this.config.apiAddress + encodeURIComponent(query) + \"&start=\" + this.fromDate + \"&end=\" + this.toDate + \"&step=60\";\n        xmlHttp.open(\"GET\", url, true);\n        xmlHttp.send(null);\n    }\n\n    processRawData() {\n        this.$timeout(() => {\n            if (this.loadCount < this.overviewModel.metricList.length) {\n                this.processRawData.bind(this)();\n            } else {\n                this.isLoading = false;\n\n                if (!this.overviewModel.metricList.includes(null)) {\n                    this.convertDataToFloat();\n                    this.initialiseMetricMinMaxTotal();\n                    this.initialiseColorMap();\n                    this.initialiseOverviewData();\n                    this.initialiseOverviewGroups();\n                    this.initialiseCompressedTimeIndexes();\n                    this.renderOverview();\n                }\n            }\n        }, 100);\n    }\n\n    convertDataToFloat() {\n        this.overviewModel.metricList.forEach((metric) => {\n            metric.data.forEach((instance) => {\n                instance.values.forEach((value) => {\n                    value[0] = parseFloat(value[0]);\n                    value[1] = Math.round(parseFloat(value[1]));\n                });\n            });\n        });\n    }\n\n    initialiseMetricMinMaxTotal() {\n        this.overviewModel.metricList.forEach((metric, metricIndex) => {\n            metric.min = -1;\n            metric.max = -1;\n\n            metric.data.forEach((instance) => {\n                instance.values.forEach((point) => {\n                    this.checkAndSetOverviewMinMax(metric, point);\n                });\n\n                if (metricIndex == 0 && metric.max > 100) {\n                    console.log(instance.metric.instance);\n                }\n            });\n        });\n    }\n\n    checkAndSetOverviewMinMax(metric, point) {\n        var value = point[1];\n\n        if (metric.min == -1) {\n            metric.min = value;\n            metric.max = value;\n        } else {\n            if (value < metric.min) {\n                metric.min = value;\n            }\n\n            if (value > metric.max) {\n                metric.max = value;\n            }\n        }\n    }\n\n    initialiseColorMap() {\n        this.overviewModel.metricList.forEach((overviewMetric, index) => {\n            var panelMetric = this.panel.metricList[index];\n            this.initialiseColorMapByMetric(overviewMetric, panelMetric);\n        });\n    }\n\n    initialiseColorMapByMetric(overviewMetric, panelMetric) {\n        var colorList = panelMetric.colorList;\n        overviewMetric.layerRange = Math.round(overviewMetric.max / colorList.length);\n\n        // map a range of values to a color\n        overviewMetric.colorMap = this.getColorMap(overviewMetric, colorList);\n    }\n\n    getColorMap(metric, colorList) {\n        var colorMap = new Map();\n\n        for (var i = 0; i < colorList.length; ++i) {\n            var threshold = {};\n            threshold.min = i * metric.layerRange;\n            threshold.max = threshold.min + metric.layerRange;\n            threshold.average = (threshold.max + threshold.min) / 2;\n            colorMap.set(threshold, colorList[i]);\n        }\n\n        return colorMap;\n    }\n\n    initialiseOverviewData() {\n        this.overviewModel.data = [];\n        this.populateOverviewDataAndInitialiseHistogramData();\n        this.calculateInstanceMetricTotalMinMax();\n        this.sortOverviewData();\n    }\n\n    populateOverviewDataAndInitialiseHistogramData() {\n        this.overviewModel.metricList.forEach((metric, metricIndex) => {\n            metric.histogram = {};\n            metric.histogram.data = new Map();\n\n            metric.data.forEach((metricInstance) => {\n                var newInstance = _.find(this.overviewModel.data, (search) => {\n                    return metricInstance.metric.instance == search.instance;\n                });\n\n                if (!newInstance) {\n                    newInstance = this.initaliseNewInstance(metricInstance);\n                }\n\n                metricInstance.values.forEach((value) => {\n                    var point = {};\n                    point.date = value[0];\n                    point.value = value[1];\n                    newInstance.metricList[metricIndex].data.push(point);\n\n                    if (metric.histogram.data.has(point.value)) {\n                        var occurences = metric.histogram.data.get(point.value);\n                        metric.histogram.data.set(point.value, occurences + 1);\n                    } else {\n                        metric.histogram.data.set(point.value, 1);\n                    }\n                });\n            });\n\n            metric.histogram.data = new Map([...metric.histogram.data].sort((first, second) => {\n                return first[0] - second[0];\n            }));\n\n            this.setHistogramMinMax(metric.histogram);\n        });\n    }\n\n    setHistogramMinMax(histogram) {\n        histogram.min = -1;\n        histogram.max = -1;\n\n        histogram.data.forEach((occurences, value) => {\n            if (histogram.min == -1) {\n                histogram.min = occurences;\n                histogram.max = occurences;\n            } else {\n                if (histogram.min > occurences) {\n                    histogram.min = occurences;\n                }\n\n                if (histogram.max < occurences) {\n                    histogram.max = occurences;\n                }\n            }\n        });\n    }\n\n    initaliseNewInstance(metricInstance) {\n        var newInstance = {};\n        newInstance.instance = metricInstance.metric.instance;\n\n        newInstance.metricList = [];\n\n        for (var i = 0; i < this.overviewModel.metricList.length; ++i) {\n            var metric = {};\n            metric.data = [];\n            newInstance.metricList.push(metric);\n        }\n\n        this.overviewModel.data.push(newInstance);\n        return newInstance;\n    }\n\n    calculateInstanceMetricTotalMinMax() {\n        this.overviewModel.data.forEach((instance) => {\n            instance.metricList.forEach((metric, metricIndex) => {\n                metric.total = 0;\n                metric.min = -1;\n                metric.max = -1;\n\n                metric.data.forEach((point) => {\n                    // sum the \"threshold\" average of each data point instead of the actual value of the data point \n                    //    metric.total += this.getThresholdAverage(point.value, this.overviewModel.metricList[metricIndex].colorMap);\n                    metric.total += point.value;\n\n                    if (metric.min == -1 || point.value < metric.min) {\n                        metric.min = point.value;\n                    }\n\n                    if (metric.max == -1 || point.value > metric.max) {\n                        metric.max = point.value;\n                    }\n                })\n            });\n        });\n    }\n\n    getThresholdAverage(value, map) {\n        var result;\n\n        map.forEach((color, threshold) => {\n            if (this.isBetween(value, threshold.min, threshold.max)) {\n                result = threshold.average;\n            }\n        });\n\n        return result;\n    }\n\n    isBetween(target, start, end) {\n        return start <= target && target <= end;\n    }\n\n    sortOverviewData() {\n        this.overviewModel.data.sort((first, second) => {\n            for (var i = 0; i < first.metricList.length; ++i) {\n                if (first.metricList[i].total != second.metricList[i].total) {\n                    return first.metricList[i].total - second.metricList[i].total;\n                }\n            }\n\n            return 0;\n        });\n    }\n\n    initialiseOverviewGroups() {\n        this.initialiseSingleMetricGroups();\n        this.initialiseMultiMetricGroups();\n    }\n\n    initialiseSingleMetricGroups() {\n        this.overviewModel.metricList.forEach((metric, metricIndex) => {\n            this.initialiseSingleMetricGroupsByMetric(metric, metricIndex);\n            this.initialiseSingleMetricGroupsColor(metric, metricIndex);\n        });\n\n        this.initialiseSingleMetricInstanceGroupList();\n    }\n\n    initialiseSingleMetricGroupsByMetric(metric, metricIndex) {\n        metric.thresholdGroupListMap = new Map();\n\n        for (var groupingThreshold = 0; groupingThreshold <= this.config.groupingThresholdCount; ++groupingThreshold) {\n            var groupList = [];\n            this.populateSingleMetricGroupList(groupList, metricIndex, groupingThreshold);\n\n            groupList.sort((first, second) => {\n                return first.total - second.total;\n            });\n\n            for (var groupIndex = 0; groupIndex < groupList.length; ++groupIndex) {\n                var group = groupList[groupIndex];\n                group.name = this.panel.metricList[metricIndex].name + \" group \" + (groupIndex + 1);\n            }\n\n            metric.thresholdGroupListMap.set(groupingThreshold, groupList);\n        }\n    }\n\n    populateSingleMetricGroupList(groupList, metricIndex, groupingThreshold) {\n        this.overviewModel.data.forEach((instance) => {\n            var group = _.find(groupList, (search) => {\n                return this.checkInstanceIsInGroup(search.total, instance.metricList[metricIndex].total, groupingThreshold);\n            });\n\n            if (!group) {\n                group = this.initialiseNewSingleMetricGroup(instance, metricIndex);\n                groupList.push(group);\n            }\n\n            group.instanceList.push(instance);\n        });\n    }\n\n    checkInstanceIsInGroup(groupTotal, instanceTotal, groupingThreshold) {\n        var thresholdValue = groupingThreshold * 0.01;\n        var min = groupTotal * (1 - thresholdValue);\n        var max = groupTotal * (1 + thresholdValue);\n        return this.isBetween(instanceTotal, min, max);\n    }\n\n    initialiseNewSingleMetricGroup(instance, metricIndex) {\n        var group = {};\n        group.instanceList = [];\n        group.markerX = 0;\n        group.total = instance.metricList[metricIndex].total;\n        return group;\n    }\n\n    initialiseSingleMetricGroupsColor(metric, metricIndex) {\n        var originalColor = this.panel.metricList[metricIndex].colorList[0];\n\n        metric.thresholdGroupListMap.forEach((groupList) => {\n            var luminanceChange = -this.config.maxLuminanceChange / groupList.length;\n\n            groupList.forEach((group, groupIndex) => {\n                group.color = this.changeColorLuminance(originalColor, groupIndex * luminanceChange);\n            });\n        });\n    }\n\n    initialiseSingleMetricInstanceGroupList() {\n        this.overviewModel.data.forEach((instance) => {\n            instance.groupList = [];\n\n            this.overviewModel.metricList.forEach((metric, metricIndex) => {\n                var groupList = this.getCurrentSingleMetricGroupList(metric);\n\n                for (var i = 0; i < groupList.length; ++i) {\n                    var group = groupList[i];\n\n                    if (this.checkInstanceIsInGroup(group.total, instance.metricList[metricIndex].total, this.groupingThreshold)) {\n                        instance.groupList.push(group);\n                        break;\n                    }\n                }\n            });\n        });\n    }\n\n    initialiseMultiMetricGroups() {\n        this.overviewModel.thresholdGroupListMap = new Map();\n\n        for (var groupingThreshold = 0; groupingThreshold <= this.config.groupingThresholdCount; ++groupingThreshold) {\n            var groupList = [];\n            this.populateMultiMetricGroupList(groupList, groupingThreshold);\n            this.overviewModel.thresholdGroupListMap.set(groupingThreshold, groupList);\n        }\n\n        this.initialiseMultiMetricGroupsColor();\n    }\n\n    populateMultiMetricGroupList(groupList, groupingThreshold) {\n        this.overviewModel.data.forEach((instance) => {\n            var group = this.findExistingMultiMetricGroup(groupList, instance, groupingThreshold);\n\n            if (!group) {\n                group = this.initialiseNewMultiMetricGroup(instance, groupList);\n                groupList.push(group);\n            }\n\n            group.instanceList.push(instance);\n\n            for (var i = 0; i < instance.metricList.length; ++i) {\n                var metric = group.metricList[i];\n                metric.total = (metric.total * (group.instanceList.length - 1) + instance.metricList[i].total) / group.instanceList.length;\n            }\n        });\n    }\n\n    findExistingMultiMetricGroup(groupList, instance, groupingThreshold) {\n        var group = _.find(groupList, (search) => {\n            for (var i = 0; i < instance.metricList.length; ++i) {\n                var metric = search.metricList[i];\n\n                if (!this.checkInstanceIsInGroup(metric.total, instance.metricList[i].total, groupingThreshold)) {\n                    return false;\n                }\n            }\n\n            return true;\n        });\n\n        return group;\n    }\n\n    initialiseNewMultiMetricGroup(instance, groupList) {\n        var group = {};\n        group.metricList = [];\n        group.instanceList = [];\n        group.name = \"Group \" + (groupList.length + 1);\n        group.markerX = 0;\n\n        instance.metricList.forEach((instanceMetric) => {\n            var groupMetric = {};\n            groupMetric.total = instanceMetric.total;\n            group.metricList.push(groupMetric);\n        });\n\n        return group;\n    }\n\n    initialiseMultiMetricGroupsColor() {\n        this.overviewModel.thresholdGroupListMap.forEach((groupList) => {\n            var luminanceChange = (this.config.startingGreyColor - this.config.endingGrayColor) / groupList.length;\n\n            groupList.forEach((group, groupIndex) => {\n                var greyValue = Math.round(this.config.startingGreyColor - luminanceChange * groupIndex);\n                group.color = \"rgba(\" + greyValue + \", \" + greyValue + \", \" + greyValue + \", 1)\";\n            });\n        })\n    }\n\n    initialiseCompressedTimeIndexes() {\n        this.overviewModel.metricList.forEach((overviewMetric, metricIndex) => {\n            overviewMetric.compressedTimeIndexList = [0];\n\n            this.overviewModel.data.forEach((instance) => {\n                this.initialiseInstanceCompressedTimeRangeList(instance, overviewMetric, metricIndex);\n            });\n\n            this.overviewModel.data.forEach((instance) => {\n                var instanceMetric = instance.metricList[metricIndex];\n\n                instanceMetric.compressedIndexRangeList.forEach((range) => {\n                    if (!overviewMetric.compressedTimeIndexList.includes(range.end)) {\n                        overviewMetric.compressedTimeIndexList.push(range.end);\n                    }\n                });\n            });\n\n            overviewMetric.compressedTimeIndexList.sort((first, second) => {\n                return first - second;\n            });\n        });\n    }\n\n    initialiseInstanceCompressedTimeRangeList(instance, overviewMetric, metricIndex) {\n        var instanceMetric = instance.metricList[metricIndex];\n        instanceMetric.compressedIndexRangeList = [];\n        var presviousRange;\n\n        instanceMetric.data.forEach((point, pointIndex) => {\n            var thresholdAverage = this.getThresholdAverage(point.value, overviewMetric.colorMap);\n\n            if (pointIndex == 0) {\n                presviousRange = this.initialiseNewCompressedTimeRange(instanceMetric, thresholdAverage);\n            } else {\n                if (thresholdAverage != presviousRange.value || pointIndex == instanceMetric.data.length - 1) {\n                    presviousRange.end = pointIndex;\n\n                    if (thresholdAverage != presviousRange.value) {\n                        presviousRange = this.initialiseNewCompressedTimeRange(instanceMetric, thresholdAverage);\n                    }\n                }\n            }\n        });\n    }\n\n    initialiseNewCompressedTimeRange(instanceMetric, thresholdAverage) {\n        var range = {};\n        instanceMetric.compressedIndexRangeList.push(range);\n        range.value = thresholdAverage;\n        range.end = 0;\n        return range;\n    }\n\n    renderOverview() {\n        this.clearFocusArea();\n        this.drawOverview();\n    }\n\n    clearFocusArea() {\n        this.hasFocus = false;\n        this.focusAreaContext.clearRect(0, 0, this.focusAreaCanvas.width, this.focusAreaCanvas.height);\n    }\n\n    drawOverview() {\n        if (!this.isLoading) {\n            this.$timeout(() => {\n                this.overviewContext.clearRect(0, 0, this.overviewCanvas.width, this.overviewCanvas.height);\n                this.setOverviewCanvasSize();\n                this.focusGraphMarginTop = this.overviewCanvasHeight + this.config.marginBetweenOverviewAndFocus;\n                this.scope.$apply();\n                this.drawOverviewData();\n            });\n        }\n    }\n\n    setOverviewCanvasSize() {\n        this.setOverviewContextLabelFont();\n        this.overviewModel.labelTextHeight = this.overviewContext.measureText(\"M\").width;\n        this.overviewModel.overviewStartY = this.overviewModel.labelTextHeight + this.config.overview.marginBetweenLabelsAndOverview;\n        this.setOverviewWidth();\n        this.setOverviewHeight();\n    }\n\n    setOverviewWidth() {\n        this.setOverviewContextTimeFont();\n        var marginBetweenMetrics = this.getMarginBetweenMetrics();\n\n        this.overviewModel.overviewWidth = this.config.overview.marginBetweenMarkerAndGroup * this.overviewModel.metricList.length +\n            marginBetweenMetrics * (this.overviewModel.metricList.length - 1);\n\n        // total width of overiew graph\n        if (this.isCompressed) {\n            this.overviewModel.metricList.forEach((metric) => {\n                this.overviewModel.overviewWidth += metric.compressedTimeIndexList.length * this.config.overview.pointWidth;\n            });\n        } else {\n            this.overviewModel.overviewWidth += this.getMaxMetricLength() * this.overviewModel.metricList.length * this.config.overview.pointWidth;\n        }\n\n        this.overviewCanvasWidth = this.overviewModel.overviewWidth;\n        this.overviewModel.toDate = this.convertDateToString(this.toDate * 1000);\n        this.overviewModel.toDateWidth = this.overviewContext.measureText(this.overviewModel.toDate).width;\n\n        if (this.isGrouped) {\n            this.setGroupedOverviewCanvasWidth();\n        } else {\n            this.overviewCanvasWidth += this.overviewModel.toDateWidth / 2;\n        }\n    }\n\n    getMarginBetweenMetrics() {\n        var marginBetweenMetrics;\n\n        if (this.isGrouped) {\n            if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n                marginBetweenMetrics = this.config.overview.decompressedMarginBetweenMetrics;\n            } else {\n                marginBetweenMetrics = this.config.overview.compressedMarginBetweenMetrics;\n            }\n        } else if (this.isCompressed) {\n            marginBetweenMetrics = this.config.overview.compressedMarginBetweenMetrics;\n        } else {\n            marginBetweenMetrics = this.config.overview.decompressedMarginBetweenMetrics;\n        }\n\n        return marginBetweenMetrics;\n    }\n\n    getMaxMetricLength() {\n        var length = 0;\n\n        this.overviewModel.metricList.forEach((metric) => {\n            var instanceWithMostPoints = _.maxBy(metric.data, (point) => {\n                return point.values.length;\n            });\n\n            length = instanceWithMostPoints.values.length;\n        });\n\n        return length;\n    }\n\n    setGroupedOverviewCanvasWidth() {\n        this.overviewCanvasWidth += this.config.overview.marginBetweenMarkerAndGroup * this.overviewModel.metricList.length;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.overviewCanvasWidth += this.config.overview.marginBetweenMetricAndGroupSize * this.overviewModel.metricList.length;\n\n            this.overviewModel.metricList.forEach((metric) => {\n                this.overviewCanvasWidth += this.getMaxGroupSizeBarLength(metric) * this.config.overview.groupSizeBarWidth;\n            });\n\n            /*\n            if (this.groupSizeChart == this.enumList.groupSizeChart.HORIZONTAL_BAR) {\n                this.overviewModel.metricList.forEach((metric) => {\n                    this.overviewCanvasWidth += this.getMaxGroupSizeBarLength(metric) * this.config.overview.groupSizeBarWidth;\n                });\n            } else {\n                this.overviewCanvasWidth += this.overviewModel.metricList.length + this.config.overview.pieRadius * 2;\n            }*/\n        } else {\n            if (this.groupSizeChart == this.enumList.groupSizeChart.HORIZONTAL_BAR) {\n                this.overviewCanvasWidth += this.config.overview.marginBetweenMetricAndGroupSize +\n                    this.getMaxMultiMetricGroupSize() * this.config.overview.groupSizeBarWidth;\n            } else {\n                this.overviewCanvasWidth += this.config.overview.pieRadius * 2;\n            }\n        }\n    }\n\n    getMaxGroupSizeBarLength(metric) {\n        var groupList = this.getCurrentSingleMetricGroupList(metric);\n\n        var largestGroup = _.maxBy(groupList, (group) => {\n            return group.instanceList.length;\n        });\n\n        return largestGroup.instanceList.length * this.config.overview.groupSizeBarWidth;\n    }\n\n    getCurrentSingleMetricGroupList(metric) {\n        return metric.thresholdGroupListMap.get(this.groupingThreshold);\n    }\n\n    getMaxMultiMetricGroupSize() {\n        var result = 0;\n        var groupList = this.getCurrentMultiMetricGroupList();\n\n        groupList.forEach((group) => {\n            if (group.instanceList.length > result) {\n                result = group.instanceList.length;\n            }\n        });\n\n        return result;\n    }\n\n    getCurrentMultiMetricGroupList() {\n        return this.overviewModel.thresholdGroupListMap.get(this.groupingThreshold);\n    }\n\n    setOverviewHeight() {\n        // height of tallest graph\n        if (this.isGrouped) {\n            var groupCount = this.getMaxGroupCount();\n\n            if (this.groupSizeChart == this.enumList.groupSizeChart.HORIZONTAL_BAR) {\n                this.overviewModel.instanceHeight = this.config.overview.groupedPointHeight + this.config.overview.marginBetweenGroups;\n            } else {\n                this.overviewModel.instanceHeight = this.config.overview.pieRadius * 2 + this.config.overview.marginBetweenGroups;\n            }\n\n            this.overviewModel.overviewHeight = groupCount * this.overviewModel.instanceHeight;\n        } else {\n            this.overviewModel.instanceHeight = this.config.overview.ungroupedPointHeight;\n            this.overviewModel.overviewHeight = this.overviewModel.data.length * this.config.overview.ungroupedPointHeight;\n        }\n\n        // 2 = Metric and time labels\n        this.overviewCanvasHeight = this.overviewModel.overviewHeight +\n            (this.overviewModel.labelTextHeight + this.config.overview.marginBetweenLabelsAndOverview) * 2;\n    }\n\n    getMaxGroupCount() {\n        var groupCount = 0;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.overviewModel.metricList.forEach((metric) => {\n                var groupList = this.getCurrentSingleMetricGroupList(metric);\n                var length = groupList.length;\n\n                if (length > groupCount) {\n                    groupCount = length;\n                }\n            });\n        } else {\n            var groupList = this.getCurrentMultiMetricGroupList();\n            groupCount = groupList.length;\n        }\n\n        return groupCount;\n    }\n\n    setOverviewContextLabelFont() {\n        this.overviewContext.font = \"bold \" + this.config.overview.metricFontSize + \"px Arial\";\n    }\n\n    drawOverviewData() {\n        this.overviewModel.overviewEndY = 0;\n        this.setOverviewMetricStartXAndEndX();\n\n        if (this.isGrouped) {\n            this.drawGroupedOverview();\n        } else {\n            this.drawUngroupedOverview();\n        }\n\n        this.drawMetricLabels();\n        this.drawToDateLabel();\n    }\n\n    setOverviewMetricStartXAndEndX() {\n        var marginBetweenMetrics = this.getMarginBetweenMetrics();\n\n        this.overviewModel.metricList.forEach((metric, metricIndex) => {\n            this.setOverviewMetricStartX(metric, metricIndex, marginBetweenMetrics);\n\n            if (this.isCompressed) {\n                metric.endX = metric.startX + metric.compressedTimeIndexList.length * this.config.overview.pointWidth;\n            } else {\n                metric.endX = metric.startX + this.getMaxMetricLength() * this.config.overview.pointWidth;\n            }\n        });\n    }\n\n    setOverviewMetricStartX(metric, metricIndex, marginBetweenMetrics) {\n        if (metricIndex > 0) {\n            var previousMetric = this.overviewModel.metricList[metricIndex - 1];\n            metric.startX = previousMetric.endX + marginBetweenMetrics;\n\n            if (this.isGrouped) {\n                metric.startX += this.config.overview.marginBetweenMarkerAndGroup;\n\n                if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n                    metric.startX += this.config.overview.marginBetweenMetricAndGroupSize;\n\n                    if (this.groupSizeChart == this.enumList.groupSizeChart.HORIZONTAL_BAR) {\n                        var maxGroupSizeBarLength = this.getMaxGroupSizeBarLength(previousMetric);\n                        metric.startX += maxGroupSizeBarLength;\n                    } else {\n                        metric.startX += this.config.overview.pieRadius * 2;\n                    }\n                }\n            }\n        } else {\n            metric.startX = this.config.overview.marginBetweenMarkerAndGroup;\n        }\n    }\n\n    drawGroupedOverview() {\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.drawSingeMetricGroupedOverview();\n        } else {\n            this.drawMultiMetricGroupedOverview();\n        }\n\n        this.drawGroupSize();\n    }\n\n    drawSingeMetricGroupedOverview() {\n        this.overviewModel.metricList.forEach((metric, metricIndex) => {\n            var groupList = this.getCurrentSingleMetricGroupList(metric);\n\n            groupList.forEach((group, groupIndex) => {\n                this.drawGroupedOverviewWrapper(group, groupIndex, [metricIndex]);\n            });\n\n            if (metricIndex < this.overviewModel.metricList.length - 1) {\n                this.drawMetricSeparator(metric);\n            }\n        });\n    }\n\n    drawGroupedOverviewWrapper(group, groupIndex, metricIndexList) {\n        var instance = group.instanceList[0];\n        instance.y = this.overviewModel.overviewStartY + groupIndex * this.overviewModel.instanceHeight;\n\n        if (this.groupSizeChart == this.enumList.groupSizeChart.PIE) {\n            instance.y += this.overviewModel.instanceHeight / 2;\n        }\n\n        this.drawOverviewInstance(instance, this.config.overview.groupedPointHeight, metricIndexList);\n        group.y = instance.y;\n    }\n\n    drawOverviewInstance(instance, pointHeight, metricIndexList) {\n        var endY = instance.y + this.overviewModel.instanceHeight;\n\n        if (endY > this.overviewModel.overviewEndY) {\n            this.overviewModel.overviewEndY = endY;\n        }\n\n        metricIndexList.forEach((metricIndex) => {\n            this.drawOverviewInstancePoints(instance, metricIndex, pointHeight);\n        });\n    }\n\n    drawOverviewInstancePoints(instance, metricIndex, pointHeight) {\n        var overviewMetric = this.overviewModel.metricList[metricIndex];\n        var instanceMetric = instance.metricList[metricIndex];\n\n        if (this.isCompressed) {\n            overviewMetric.compressedTimeIndexList.forEach((pointIndex, rangeIndex) => {\n                var point = instanceMetric.data[pointIndex];\n\n                if (point) {\n                    this.drawOverviewInstancePoint(instance, metricIndex, overviewMetric, point, rangeIndex, this.config.overview.pointWidth, pointHeight);\n                }\n            });\n        } else {\n            instanceMetric.data.forEach((point, pointIndex) => {\n                this.drawOverviewInstancePoint(instance, metricIndex, overviewMetric, point, pointIndex, this.config.overview.pointWidth, pointHeight);\n            });\n        }\n    }\n\n    drawOverviewInstancePoint(instance, metricIndex, overviewMetric, point, pointIndex, pointWidth, pointHeight) {\n        point.x = overviewMetric.startX + pointIndex * pointWidth;\n        point.color = this.getColorFromMap(point.value, this.overviewModel.metricList[metricIndex].colorMap);\n        this.overviewContext.fillStyle = point.color;\n        this.overviewContext.fillRect(point.x, instance.y, pointWidth, pointHeight);\n    }\n\n    getColorFromMap(value, map) {\n        var result = null;\n\n        map.forEach((color, threshold) => {\n            if (!result && this.isBetween(value, threshold.min, threshold.max)) {\n                result = color;\n            }\n        });\n\n        return result;\n    }\n\n    drawMultiMetricGroupedOverview() {\n        var groupList = this.getCurrentMultiMetricGroupList();\n\n        groupList.forEach((group, groupIndex) => {\n            var metricIndexList = this.getAllMetricIndexList();\n            this.drawGroupedOverviewWrapper(group, groupIndex, metricIndexList);\n        });\n\n        this.drawMetricSeparator(this.overviewModel.metricList[this.overviewModel.metricList.length - 1]);\n    }\n\n    getAllMetricIndexList() {\n        return Array.from(Array(this.overviewModel.metricList.length).keys());\n    }\n\n    drawGroupSize() {\n        this.setOverviewContextLabelFont();\n        var label = \"Groups size\";\n        this.overviewModel.groupSizeLabelWidth = this.overviewContext.measureText(label).width;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.drawSingleMetricGroupSize();\n        } else {\n            this.drawMultipleMetricGroupSize();\n        }\n    }\n\n    drawSingleMetricGroupSize() {\n        this.overviewModel.metricList.forEach((metric) => {\n            var startX = metric.endX + this.config.overview.marginBetweenMetricAndGroupSize;\n            var groupList = this.getCurrentSingleMetricGroupList(metric);\n\n            groupList.forEach((group) => {\n                if (this.groupSizeChart == this.enumList.groupSizeChart.HORIZONTAL_BAR) {\n                    this.drawSingleMetricBarGroupSize(group, startX);\n                } else {\n                    this.drawSingleMetricPieGroupSize(group, startX);\n                }\n            });\n\n            if (this.groupSizeChart == this.enumList.groupSizeChart.HORIZONTAL_BAR) {\n                var maxGroupSizeBarLength = this.getMaxGroupSizeBarLength(metric);\n                this.drawGroupSizeLabel((startX * 2 + maxGroupSizeBarLength - this.overviewModel.groupSizeLabelWidth) / 2);\n            } else {\n                this.drawGroupSizeLabel((startX * 2 + this.config.overview.pieRadius - this.overviewModel.groupSizeLabelWidth) / 2);\n            }\n        });\n    }\n\n    drawSingleMetricBarGroupSize(group, startX) {\n        this.drawBarGroupSizeWrapper(group, startX, group.instanceList.length, this.config.overview.groupSizeColor);\n\n        if (group.isSelected && group.overlapMap) {\n            var startOverlapX = startX;\n\n            group.overlapMap.forEach((count, overlappingGroup) => {\n                startOverlapX = this.drawBarGroupSizeWrapper(group, startOverlapX, count, overlappingGroup.color);\n            });\n        }\n    }\n\n    drawBarGroupSizeWrapper(group, startX, length, color) {\n        var endX = startX + length * this.config.overview.groupSizeBarWidth;\n        var endY = group.y + this.config.overview.groupedPointHeight;\n        this.overviewContext.beginPath();\n        this.overviewContext.moveTo(startX, group.y);\n        this.overviewContext.lineTo(endX, group.y);\n        this.overviewContext.lineTo(endX, endY);\n        this.overviewContext.lineTo(startX, endY);\n        this.overviewContext.closePath();\n        this.overviewContext.fillStyle = color;\n        this.overviewContext.fill();\n        return endX;\n    }\n\n    drawSingleMetricPieGroupSize(group, startX) {\n        var startAngle = -0.5 * Math.PI;\n        this.drawPieGroupSizeWrapper(group, startX, startAngle, group.instanceList.length, this.config.overview.groupSizeColor);\n\n        if (group.isSelected && group.overlapMap) {\n            group.overlapMap.forEach((count, overlappingGroup) => {\n                startAngle = this.drawPieGroupSizeWrapper(group, startX, startAngle, count, overlappingGroup.color);\n            });\n        }\n    }\n\n    drawPieGroupSizeWrapper(group, startX, startAngle, size, color) {\n        var x = startX + this.config.overview.pieRadius;\n        var endAngle = startAngle + size * 2 * Math.PI / 360;\n        this.overviewContext.beginPath();\n        this.overviewContext.moveTo(x, group.y);\n        this.overviewContext.arc(x, group.y, this.config.overview.pieRadius, startAngle, endAngle);\n        this.overviewContext.lineTo(x, group.y);\n        this.overviewContext.closePath();\n        this.overviewContext.fillStyle = color;\n        this.overviewContext.fill();\n        return endAngle;\n    }\n\n    drawGroupSizeLabel(x) {\n        this.overviewContext.fillStyle = \"black\";\n        this.overviewContext.fillText(\"Groups size\", x, this.overviewModel.labelTextHeight);\n    }\n\n    drawMultipleMetricGroupSize() {\n        var startX = this.overviewModel.overviewWidth + this.config.overview.marginBetweenMetricAndGroupSize +\n            this.overviewModel.groupSizeLabelWidth / 2;\n        var maxEndX = 0;\n        var groupList = this.getCurrentMultiMetricGroupList();\n\n        groupList.forEach((group, groupIndex) => {\n            var endX = this.drawBarGroupSizeWrapper(group, startX, group.instanceList.length, this.config.overview.groupSizeColor);\n\n            if (endX > maxEndX) {\n                maxEndX = endX;\n            }\n        });\n\n        this.drawGroupSizeLabel((startX + maxEndX - this.overviewModel.groupSizeLabelWidth) / 2);\n    }\n\n    drawMetricSeparator(metric) {\n        this.overviewContext.strokeStyle = \"gray\";\n        var x = metric.endX + this.config.overview.decompressedMarginBetweenMetrics / 2;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            x += this.config.overview.marginBetweenMetricAndGroupSize;\n\n            if (this.groupSizeChart == this.enumList.groupSizeChart.HORIZONTAL_BAR) {\n                var maxGroupSizeBarLength = this.getMaxGroupSizeBarLength(metric);\n                x += maxGroupSizeBarLength;\n            } else {\n                x += this.config.overview.pieRadius * 2;\n            }\n        }\n\n        this.overviewContext.beginPath();\n        this.overviewContext.moveTo(x, this.overviewModel.overviewStartY);\n        this.overviewContext.lineTo(x, this.overviewModel.overviewStartY + this.overviewModel.overviewHeight);\n        this.overviewContext.stroke();\n        this.overviewContext.closePath();\n    }\n\n    drawUngroupedOverview() {\n        this.overviewModel.data.forEach((instance, instanceIndex) => {\n            var metricIndexList = this.getAllMetricIndexList();\n            instance.y = this.overviewModel.overviewStartY + instanceIndex * this.overviewModel.instanceHeight;\n            this.drawOverviewInstance(instance, this.overviewModel.instanceHeight, metricIndexList);\n        });\n    }\n\n    drawMetricLabels() {\n        this.setOverviewContextLabelFont();\n\n        for (var metricIndex = 0; metricIndex < this.overviewModel.metricList.length; ++metricIndex) {\n            var metric = this.overviewModel.metricList[metricIndex];\n            var label = this.panel.metricList[metricIndex].name;\n            var width = this.overviewContext.measureText(label).width;\n            this.overviewContext.fillStyle = this.getMetricDarkestColor(this.panel.metricList[metricIndex]);\n            this.overviewContext.fillText(label, (metric.startX + metric.endX - width) / 2, this.overviewModel.labelTextHeight);\n        }\n    }\n\n    getMetricDarkestColor(metric) {\n        var colorList = metric.colorList;\n        return colorList[colorList.length - 1];\n    }\n\n    drawToDateLabel() {\n        this.setOverviewContextTimeFont();\n        var y = this.overviewModel.overviewStartY + this.overviewModel.overviewHeight + this.config.overview.marginBetweenLabelsAndOverview;\n        var metric = this.overviewModel.metricList[this.overviewModel.metricList.length - 1];\n        this.overviewContext.fillStyle = \"black\";\n        this.overviewContext.fillText(this.overviewModel.toDate, metric.endX - this.overviewModel.toDateWidth / 2, y);\n    }\n\n    setOverviewContextTimeFont() {\n        this.overviewContext.font = \"italic \" + this.config.overview.timeFontSize + \"px Arial\";\n    }\n\n    convertDateToString(date) {\n        return moment(date).format(this.config.dateFormat);\n    }\n\n    closeHistogram() {\n        this.showHistogram = false;\n\n        if (this.changedColorThreshold) {\n            this.changedColorThreshold = false;\n            this.drawOverview();\n\n            if (this.isGrouped) {\n                var temp = this.focusModel.groupList;\n                this.focusModel.groupList = [];\n\n                temp.forEach((group) => {\n                    this.addOrRemoveGroupToFocus(group.overviewGroup, true);\n                });\n\n                this.drawFocusGraph();\n            } else {\n                this.drawFocusGraph();\n            }\n        }\n    }\n\n    addOrRemoveGroupToFocus(group, removeExisting) {\n        var focusGroup = _.find(this.focusModel.groupList, (search) => {\n            return search.overviewGroup == group;\n        });\n\n        if (focusGroup) {\n            if (removeExisting) {\n                group.isSelected = false;\n\n                _.remove(this.focusModel.groupList, (search) => {\n                    return search.overviewGroup == group;\n                });\n            }\n        } else {\n            group.isSelected = true;\n            this.addGroupToFocus(group);\n        }\n\n        this.setShowMergeGroupsButton();\n    }\n\n    setShowMergeGroupsButton() {\n        this.showMergeSelectedGroups = false;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.overviewModel.metricList.forEach((metric) => {\n                var groupList = this.getCurrentSingleMetricGroupList(metric);\n                this.setShowMergeGroupsButtonWrapper(groupList);\n            });\n        } else {\n            var groupList = this.getCurrentMultiMetricGroupList();\n            this.setShowMergeGroupsButtonWrapper(groupList);\n        }\n    }\n\n    setShowMergeGroupsButtonWrapper(groupList) {\n        var selectedGroupCount = 0;\n\n        for (var i = 0; i < groupList.length; ++i) {\n            var group = groupList[i];\n\n            if (group.isSelected) {\n                ++selectedGroupCount;\n            }\n\n            if (selectedGroupCount == 2) {\n                this.showMergeSelectedGroups = true;\n                return;\n            }\n        };\n    }\n\n    drawSelectedGroupsMarkers() {\n        this.$timeout(() => {\n            this.clearFocusArea();\n            this.overviewModel.groupMarkerList = [];\n\n            if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n                this.overviewModel.metricList.forEach((metric) => {\n                    var groupList = this.getCurrentSingleMetricGroupList(metric);\n\n                    groupList.forEach((group) => {\n                        this.drawOverviewGroupMarker(group, [metric])\n                    });\n                });\n            } else {\n                var groupList = this.getCurrentMultiMetricGroupList();\n\n                groupList.forEach((group) => {\n                    this.drawOverviewGroupMarker(group, this.overviewModel.metricList)\n                });\n            }\n        });\n    }\n\n    drawOverviewGroupMarker(group, metricList) {\n        if (group.isSelected) {\n            metricList.forEach((metric) => {\n                var marker = {};\n                marker.group = group;\n                marker.startX = metric.startX - this.config.overview.marginBetweenMarkerAndGroup + group.markerX;\n                marker.endX = marker.startX + this.config.overview.groupedPointHeight;\n                marker.startY = group.y;\n                marker.endY = marker.startY + this.config.overview.groupedPointHeight;\n                this.focusAreaContext.fillStyle = group.color;\n                this.focusAreaContext.fillRect(marker.startX, marker.startY, this.config.overview.groupedPointHeight, this.config.overview.groupedPointHeight);\n                this.overviewModel.groupMarkerList.push(marker);\n            });\n        }\n    }\n\n    drawFocusGraph() {\n        if (!this.isGrouped) {\n            this.initialiseFocusGraphData();\n        }\n\n        if ((this.isGrouped && this.focusModel.groupList.length > 0) ||\n            (!this.isGrouped && this.focusModel.data.length > 0)) {\n            this.showFocus = true;\n\n            this.$timeout(() => {\n                this.focusGraphHeight = this.overviewModel.metricList.length * this.config.focusGraph.metricMaxHeight +\n                    (this.overviewModel.metricList.length - 1) * this.config.focusGraph.marginBetweenMetrics;\n                this.focusGraphWidth = (this.focusModel.focusedIndexList.length - 1) * this.getFocusGraphPointWidth();\n                this.scope.$apply();\n\n                var focusGraphRow = this.getElementByID(\"focusGraphRow\");\n\n                if (focusGraphRow) {\n                    this.focusModel.focusRowHeight = focusGraphRow.offsetHeight;\n                    this.setFocusFromAndToDate();\n                    this.positionFocusFromAndToDate();\n                    this.drawFocusGraphData();\n                    this.autoSrollFocusGraph();\n                }\n            });\n        } else {\n            this.showFocus = false;\n        }\n    }\n\n    moveMouseOnHistogram(evt) {\n        this.histogramModel.mousePosition = this.getMousePos(evt, this.histogramCanvas);\n\n        if (this.histogramModel.isSelectingBar) {\n            this.setNewThresholdValue();\n        } else {\n            this.checkAndSetSelectedHistogramThresholdBar();\n        }\n    }\n\n    setNewThresholdValue() {\n        this.changedColorThreshold = true;\n        var value = Math.round((this.histogramModel.mousePosition.x - this.histogramModel.horizontalAxisStartX) / this.config.histogram.barWidth);\n        value = Math.max(value, 1);\n        value = Math.min(value, this.histogramModel.metric.max - 1);\n\n        this.histogramModel.metric.colorMap.forEach((color, threshold) => {\n            if (threshold != this.histogramModel.selectedBar.threshold) {\n                if (value >= this.histogramModel.selectedBar.threshold.max) {\n                    // move right\n                    if (threshold.min == this.histogramModel.selectedBar.threshold.max) {\n                        value = Math.min(value, threshold.max - 1);\n                        threshold.min = value;\n                    }\n                } else {\n                    // move left\n                    if (this.histogramModel.selectedBar.threshold.min == 0) {\n                        // left most threshold\n                        if (threshold.min == this.histogramModel.selectedBar.threshold.max) {\n                            threshold.min = value;\n                        }\n                    } else {\n                        // left threshold\n                        if (threshold.max == this.histogramModel.selectedBar.threshold.min) {\n                            value = Math.max(value, threshold.max + 1);\n                        }\n\n                        // right threshold\n                        if (threshold.min == this.histogramModel.selectedBar.threshold.max) {\n                            threshold.min = value;\n                        }\n                    }\n                }\n            }\n        });\n\n        this.histogramModel.selectedBar.threshold.max = value;\n        this.drawHistogram();\n    }\n\n    checkAndSetSelectedHistogramThresholdBar() {\n        this.histogramCursor = \"default\";\n        this.histogramModel.selectedBar = null;\n        var topY = this.histogramModel.sliderY - this.config.histogram.thresholdBarLength / 2;\n        var bottomY = this.histogramModel.sliderY + this.config.histogram.thresholdBarLength / 2;\n\n        if (this.isBetween(this.histogramModel.mousePosition.y, topY, bottomY)) {\n            for (var i = 0; i < this.histogramModel.thresholdBarList.length; ++i) {\n                var bar = this.histogramModel.thresholdBarList[i];\n                var leftX = bar.x - this.config.histogram.barWidth;\n                var rightX = bar.x + this.config.histogram.barWidth;\n\n                if (this.isBetween(this.histogramModel.mousePosition.x, leftX, rightX)) {\n                    this.histogramCursor = \"pointer\";\n                    this.histogramModel.selectedBar = bar;\n                    break;\n                }\n            }\n        }\n    }\n\n    mouseDownOnHistogram() {\n        if (this.histogramModel.selectedBar) {\n            this.histogramModel.isSelectingBar = true;\n        }\n    }\n\n    mouseUpOnHistogram() {\n        this.histogramModel.isSelectingBar = false;\n        this.histogramModel.selectedBar = null;\n        this.histogramCursor = \"default\";\n    }\n\n    selectGroupingMode() {\n        this.changeGroupingSelection();\n    }\n\n    changeGroupingSelection() {\n        this.drawOverview();\n        this.clearFocusArea();\n        this.clearTimeIndicator();\n        this.deselectAllGroups();\n        this.showFocus = false;\n        this.showMergeSelectedGroups = false;\n    }\n\n    deselectAllGroups() {\n        this.focusModel.groupList = [];\n        this.deselectSingleMetricGroups();\n        this.deselectMultiMetricGroups();\n    }\n\n    deselectSingleMetricGroups() {\n        this.overviewModel.metricList.forEach((metric) => {\n            if (metric.originalGroupList) {\n                metric.thresholdGroupListMap.set(this.previousGroupThreshold, metric.originalGroupList);\n                metric.originalGroupList = null;\n            }\n\n            var groupList = this.getCurrentSingleMetricGroupList(metric);\n\n            if (groupList) {\n                groupList.forEach((group) => {\n                    group.isSelected = false;\n                    group.timeRangeIndexList = null;\n                });\n            }\n        });\n    }\n\n    deselectMultiMetricGroups() {\n        if (this.overviewModel.originalGroupList) {\n            this.overviewModel.thresholdGroupListMap.set(this.previousGroupThreshold, this.overviewModel.originalGroupList);\n            this.overviewModel.originalGroupList = null;\n        }\n\n        var groupList = this.getCurrentMultiMetricGroupList();\n\n        groupList.forEach((group) => {\n            group.isSelected = false;\n            group.timeRangeIndexList = null;\n        });\n    }\n\n    changeGroupingThreshold() {\n        this.initialiseSingleMetricInstanceGroupList();\n        this.changeGroupingSelection();\n    }\n\n    selectGroupsizeChart() {\n        this.drawOverview();\n    }\n\n    groupUngroup() {\n        this.isGrouped = !this.isGrouped;\n\n        if (!this.isLoading) {\n            this.changeGroupingSelection();\n        }\n    }\n\n    mergeSelectedGroups() {\n        this.showMergeSelectedGroups = false;\n\n        // store current threshold value to restore original groups when threshold is changed\n        this.previousGroupThreshold = this.groupingThreshold;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.mergeSingleMetricGroups();\n        } else {\n            this.mergeMultipleMetricGroups();\n        }\n\n        this.mergeFocusGroupList();\n        this.initialiseGroupsOverlapMap();\n        this.drawOverview();\n        this.drawSelectedGroupsMarkers();\n        this.drawFocusGraph();\n    }\n\n    mergeSingleMetricGroups() {\n        this.overviewModel.metricList.forEach((metric) => {\n            var groupList = this.getCurrentSingleMetricGroupList(metric);\n\n            if (!metric.originalGroupList) {\n                metric.originalGroupList = [];\n\n                groupList.forEach((group) => {\n                    metric.originalGroupList.push(group);\n                });\n            }\n\n            this.mergeSelectedGroupsWrapper(groupList);\n        });\n    }\n\n    mergeSelectedGroupsWrapper(groupList) {\n        var currentGroupList = [];\n\n        groupList.forEach((group) => {\n            currentGroupList.push(group);\n        });\n\n        groupList.length = 0;\n        this.populateMergedGroupList(currentGroupList, groupList);\n    }\n\n    populateMergedGroupList(currentGroupList, groupList) {\n        var mergedGroup;\n\n        currentGroupList.forEach((group) => {\n            if (group.isSelected) {\n                if (mergedGroup) {\n                    group.instanceList.forEach((instance) => {\n                        mergedGroup.instanceList.push(instance)\n                    });\n                } else {\n                    mergedGroup = JSON.parse(JSON.stringify(group));\n                    groupList.push(mergedGroup);\n                }\n            } else {\n                groupList.push(group);\n            }\n        });\n    }\n\n    mergeFocusGroupList() {\n        this.focusModel.groupList = [];\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.overviewModel.metricList.forEach((metric) => {\n                var groupList = this.getCurrentSingleMetricGroupList(metric);\n                this.mergeFocusGroupListWrapper(groupList);\n            })\n        } else {\n            this.mergeFocusGroupListWrapper(this.getCurrentMultiMetricGroupList());\n        }\n    }\n\n    mergeFocusGroupListWrapper(groupList) {\n        groupList.forEach((group) => {\n            if (group.isSelected) {\n                this.addGroupToFocus(group);\n            }\n        });\n    }\n\n    addGroupToFocus(group) {\n        var focusGroup = {};\n        focusGroup.instanceList = [];\n        focusGroup.overviewGroup = group;\n        focusGroup.mainMetricIndex = this.overviewModel.selectedMetricIndex;\n\n        group.instanceList.forEach((overviewInstance) => {\n            var metricWithMostData = _.maxBy(overviewInstance.metricList, (metric) => {\n                return metric.data.length;\n            });\n\n            this.focusModel.focusedIndexList = Array.from(Array(metricWithMostData.data.length).keys());\n            var focusInstance = this.getFocusInstance(overviewInstance, this.focusModel.focusedIndexList);\n            focusGroup.instanceList.push(focusInstance);\n        });\n\n        this.focusModel.groupList.push(focusGroup);\n    }\n\n    initialiseGroupsOverlapMap() {\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.overviewModel.metricList.forEach((metric) => {\n                var groupList = this.getCurrentSingleMetricGroupList(metric);\n\n                groupList.forEach((group) => {\n                    group.overlapMap = new Map();\n                    this.checkAndAddOverlappingGroupsFromOtherMetrics(group, metric);\n                })\n            });\n\n            this.drawOverview();\n        }\n    }\n\n    checkAndAddOverlappingGroupsFromOtherMetrics(group, metric) {\n        for (var metricIndex = 0; metricIndex < this.overviewModel.metricList.length; ++metricIndex) {\n            var overlappingMetric = this.overviewModel.metricList[metricIndex];\n\n            if (metric != overlappingMetric) {\n                var overlappingGroupList = this.getCurrentSingleMetricGroupList(overlappingMetric);\n\n                overlappingGroupList.forEach((overlappingGroup) => {\n                    this.checkAndAddOverlappingGroup(group, overlappingGroup);\n                });\n\n                if (group.overlapMap.size > 0) {\n                    break;\n                }\n            }\n        }\n    }\n\n    checkAndAddOverlappingGroup(group, overlappingGroup) {\n        if (group != overlappingGroup && overlappingGroup.isSelected) {\n            var overlappingCount = 0;\n\n            group.instanceList.forEach((instance) => {\n                var overlappingInstance = _.find(overlappingGroup.instanceList, (search) => {\n                    return search.instance == instance.instance;\n                });\n\n                if (overlappingInstance) {\n                    ++overlappingCount;\n                }\n            });\n\n            if (overlappingCount > 0) {\n                group.overlapMap.set(overlappingGroup, overlappingCount);\n            }\n        }\n    }\n\n    mergeMultipleMetricGroups() {\n        var groupList = this.getCurrentMultiMetricGroupList();\n\n        if (!this.overviewModel.originalGroupList) {\n            this.overviewModel.originalGroupList = [];\n\n            groupList.forEach((group) => {\n                this.overviewModel.originalGroupList.push(group);\n            });\n        }\n\n        this.mergeSelectedGroupsWrapper(groupList);\n    }\n\n    compressDecompress() {\n        this.isCompressed = !this.isCompressed;\n        this.changeGroupingSelection();\n    }\n\n    selectTimeHighlightMode() {\n        this.clearTimeIndicator();\n\n        if (this.overviewModel.thresholdGroupListMap) {\n            this.overviewModel.thresholdGroupListMap.forEach((group) => {\n                group.timeRangeIndexList = [];\n            });\n        }\n\n        if (this.overviewModel.metricList) {\n            this.overviewModel.metricList.forEach((metric) => {\n                metric.thresholdGroupListMap.forEach((group) => {\n                    group.timeRangeIndexList = [];\n                });\n            });\n        }\n    }\n\n    clearTimeIndicator() {\n        this.overviewTimeIndicatorContext.clearRect(0, 0, this.overviewTimeIndicatorCanvas.width, this.overviewTimeIndicatorCanvas.height);\n    }\n\n    mouseDownOnOverview(evt) {\n        if (this.isSelectingMetricLabel) {\n            this.showHistogram = true;\n            this.drawHistogram();\n        } else if (this.isGrouped && this.overviewModel.hoveredGroup && this.timeHighlightMode == this.enumList.timeHighlightMode.RANGE) {\n            this.overviewModel.isSelectingTimeRange = true;\n            this.overviewModel.timeRangeStartOffset = this.overviewModel.mousePositionXOffset;\n            this.overviewModel.timeRangeGroup = this.overviewModel.hoveredGroup;\n        }\n    }\n\n    drawHistogram() {\n        this.histogramCanvasContext.clearRect(0, 0, this.histogramCanvas.width, this.histogramCanvas.height);\n        this.histogramModel.metric = this.overviewModel.metricList[this.overviewModel.selectedMetricIndex];\n        this.histogramMetric = this.panel.metricList[this.overviewModel.selectedMetricIndex];\n\n        this.scope.$watch(\"ctrl.histogramMetric.color\", (newValue, oldValue) => {\n            if (newValue != oldValue) {\n                this.initialiseColorListByMetric(this.histogramMetric);\n                this.initialiseColorMapByMetric(this.histogramModel.metric, this.histogramMetric);\n                this.drawHistogram();\n            }\n        });\n\n        this.drawHistogramAxes();\n        this.drawHistogramMaxValueAndOccurence();\n        this.drawHistogramBars();\n        this.drawHistogramThresholdSlider();\n    }\n\n    drawHistogramAxes() {\n        this.histogramCanvasContext.font = this.config.overview.metricFontSize + \"px Arial\";\n        this.histogramModel.verticalAxisStartY = this.overviewModel.labelTextHeight + this.config.histogram.marginBetweenAxesAndNumbers;\n        this.histogramCanvasContext.lineWdith = 1;\n        this.histogramCanvasContext.fillStyle = \"black\";\n        this.histogramCanvasContext.strokeStyle = \"gray\";\n        this.histogramCanvasContext.font = \"bold \" + this.config.overview.metricFontSize + \"px Arial\";\n        this.drawHistogramVerticalAxis();\n        this.drawHistogramHorizontalAxis();\n    }\n\n    drawHistogramVerticalAxis() {\n        var occurences = \"occurences\";\n        var verticalLabelWidth = this.histogramCanvasContext.measureText(occurences).width;\n        var maxOccurenceWidth = this.histogramCanvasContext.measureText(this.histogramModel.metric.histogram.max).width;\n        this.histogramModel.horizontalAxisStartX = maxOccurenceWidth + this.config.histogram.marginBetweenAxesAndNumbers;\n        this.histogramCanvasContext.fillText(\"occurences\", this.histogramModel.horizontalAxisStartX - verticalLabelWidth / 2, this.overviewModel.labelTextHeight);\n        this.histogramModel.horizontalAxisY = this.histogramModel.verticalAxisStartY + this.config.histogram.verticalAxisLength;\n        this.histogramCanvasContext.beginPath();\n        this.histogramCanvasContext.moveTo(this.histogramModel.horizontalAxisStartX, this.histogramModel.verticalAxisStartY);\n        this.histogramCanvasContext.lineTo(this.histogramModel.horizontalAxisStartX, this.histogramModel.horizontalAxisY);\n        this.histogramCanvasContext.stroke();\n        this.histogramCanvasContext.closePath();\n    }\n\n    drawHistogramHorizontalAxis() {\n        this.histogramModel.horizontalAxisEndX = this.histogramModel.horizontalAxisStartX +\n            this.config.histogram.barWidth * (this.histogramModel.metric.max + 1);\n        var labelX = this.histogramModel.horizontalAxisEndX + this.config.histogram.marginBetweenAxesAndNumbers;\n        var labelY = this.histogramModel.horizontalAxisY + this.overviewModel.labelTextHeight / 2;\n        this.histogramCanvasContext.fillText(this.histogramMetric.unit, labelX, labelY);\n        this.histogramCanvasContext.beginPath();\n        this.histogramCanvasContext.moveTo(this.histogramModel.horizontalAxisStartX, this.histogramModel.horizontalAxisY);\n        this.histogramCanvasContext.lineTo(this.histogramModel.horizontalAxisEndX, this.histogramModel.horizontalAxisY);\n        this.histogramCanvasContext.stroke();\n        this.histogramCanvasContext.closePath();\n    }\n\n    drawHistogramMaxValueAndOccurence() {\n        this.histogramCanvasContext.font = this.config.overview.metricFontSize + \"px Arial\";\n        var occurenceLabelY = this.histogramModel.verticalAxisStartY + this.overviewModel.labelTextHeight / 2\n        this.histogramCanvasContext.fillText(this.histogramModel.metric.histogram.max, 0, occurenceLabelY);\n        var maxValueWidth = this.histogramCanvasContext.measureText(this.histogramModel.metric.max).width;\n        var valueLabelY = this.histogramModel.horizontalAxisY + this.config.histogram.marginBetweenAxesAndNumbers + this.overviewModel.labelTextHeight;\n        this.histogramCanvasContext.fillText(this.histogramModel.metric.max, this.histogramModel.horizontalAxisEndX - maxValueWidth / 2, valueLabelY);\n        var originX = this.histogramModel.horizontalAxisStartX - this.overviewModel.labelTextHeight - this.config.histogram.marginBetweenAxesAndNumbers;\n        this.histogramCanvasContext.fillText(0, originX, valueLabelY);\n    }\n\n    drawHistogramBars() {\n        var occurenceStep = this.config.histogram.verticalAxisLength / this.histogramModel.metric.histogram.max;\n\n        this.histogramModel.metric.histogram.data.forEach((occurences, value) => {\n            this.histogramCanvasContext.fillStyle = this.getColorFromMap(value, this.histogramModel.metric.colorMap);\n            var x = this.histogramModel.horizontalAxisStartX + this.config.histogram.barWidth * value;\n            var y = this.histogramModel.horizontalAxisY - occurenceStep * occurences;\n            var height = this.histogramModel.horizontalAxisY - y;\n            var minHeight = this.config.histogram.minimumBarHeight;\n\n            if (height < minHeight) {\n                y = this.histogramModel.horizontalAxisY - minHeight;\n                height = minHeight;\n            }\n\n            this.histogramCanvasContext.fillRect(x, y, this.config.histogram.barWidth, height);\n        });\n    }\n\n    drawHistogramThresholdSlider() {\n        this.histogramCanvasContext.strokeStyle = \"black\";\n        this.drawHistogramSliderLine();\n        this.drawHistogramThresholdBars();\n    }\n\n    drawHistogramSliderLine() {\n        this.histogramModel.sliderY = this.histogramModel.horizontalAxisY + this.config.histogram.marginBetweenSliderAndChart;\n        this.histogramCanvasContext.beginPath();\n        this.histogramCanvasContext.moveTo(this.histogramModel.horizontalAxisStartX, this.histogramModel.sliderY);\n        this.histogramCanvasContext.lineTo(this.histogramModel.horizontalAxisEndX, this.histogramModel.sliderY);\n        this.histogramCanvasContext.stroke();\n        this.histogramCanvasContext.closePath();\n    }\n\n    drawHistogramThresholdBars() {\n        var thresholdBarY = this.histogramModel.sliderY - this.config.histogram.thresholdBarLength / 2;\n        this.histogramModel.thresholdBarList = [];\n        var i = 0;\n\n        this.histogramModel.metric.colorMap.forEach((color, threshold) => {\n            var bar = {};\n            bar.threshold = threshold;\n            bar.x = this.histogramModel.horizontalAxisStartX + this.config.histogram.barWidth * (threshold.max + 1);\n\n            // no need to draw slider bar for last threshold\n            if (i < this.histogramModel.metric.colorMap.size - 1) {\n                this.histogramCanvasContext.beginPath();\n                this.histogramCanvasContext.moveTo(bar.x, thresholdBarY);\n                this.histogramCanvasContext.lineTo(bar.x, thresholdBarY + this.config.histogram.thresholdBarLength);\n                this.histogramCanvasContext.stroke();\n                this.histogramCanvasContext.closePath();\n                ++i;\n            }\n\n            this.histogramModel.thresholdBarList.push(bar);\n        });\n    }\n\n    moveMouseOnOverview(evt) {\n        if (this.overviewModel.metricList) {\n            this.setOverviewMousePosition(evt);\n            this.setSelectedMetricIndex();\n\n            if (this.overviewModel.selectedMetricIndex >= 0) {\n                if (this.isBetween(this.overviewModel.mousePosition.y, 0, this.overviewModel.overviewStartY)) {\n                    this.isSelectingMetricLabel = true;\n                    this.setOverviewCursorToPointer();\n                } else {\n                    this.deselectMetricLabel();\n                }\n            } else {\n                this.deselectMetricLabel();\n            }\n\n            if (this.isGrouped) {\n                this.handleMouseMoveOnGroupedOverview();\n            } else if (!this.isCompressed && !this.focusAreaIsFixed) {\n                this.drawFocus(evt);\n            }\n        } else {\n            this.deselectMetricLabel();\n        }\n    }\n\n    setOverviewMousePosition(evt) {\n        this.overviewModel.mousePosition = this.getMousePos(evt, this.focusAreaCanvas);\n    }\n\n    getMousePos(evt, canvas) {\n        var rect = canvas.getBoundingClientRect();\n\n        return {\n            x: evt.clientX - rect.left,\n            y: evt.clientY - rect.top\n        };\n    }\n\n    setSelectedMetricIndex() {\n        this.overviewModel.selectedMetricIndex = -1;\n\n        for (var metricIndex = 0; metricIndex < this.overviewModel.metricList.length; ++metricIndex) {\n            var metric = this.overviewModel.metricList[metricIndex];\n\n            if (metric) {\n                // only check if mouse is on a metric graph\n                if (this.checkMouseIsInMetric(metric)) {\n                    this.overviewModel.selectedMetricIndex = metricIndex;\n                    this.overviewModel.mousePositionXOffset = this.overviewModel.mousePosition.x - metric.startX;\n                    break;\n                }\n            }\n        }\n    }\n\n    checkMouseIsInMetric(metric) {\n        return this.isBetween(this.overviewModel.mousePosition.x, metric.startX, metric.endX);\n    }\n\n    setOverviewCursorToPointer() {\n        this.overviewCursor = \"pointer\";\n    }\n\n    deselectMetricLabel() {\n        this.isSelectingMetricLabel = false;\n        this.initialiseOverviewCanvasCursor();\n    }\n\n    handleMouseMoveOnGroupedOverview() {\n        this.overviewModel.hoveredGroup = null;\n        this.overviewModel.hoveredMarker = null;\n        this.checkAndSetSelectedOverviewMarker();\n\n        if (this.overviewModel.selectedMetricIndex >= 0) {\n            this.checkAndSetHoveredGroup();\n        }\n\n        if (this.timeHighlightMode == this.enumList.timeHighlightMode.POINT) {\n            if (this.overviewModel.hoveredGroup) {\n                if (this.isCompressed && this.groupingMode == this.enumList.groupingMode.MULTIPLE) {\n                    this.setSelectedTimeIndex();\n                }\n\n                this.drawTimeIndicators();\n            } else {\n                this.clearTimeIndicator();\n            }\n        } else if (this.overviewModel.isSelectingTimeRange) {\n            this.initialiseSelectedGroupTimeRangeIndexList();\n            this.drawSelectedTimeRanges();\n        }\n    }\n\n    checkAndSetSelectedOverviewMarker() {\n        for (var markerIndex = 0; markerIndex < this.overviewModel.groupMarkerList.length; ++markerIndex) {\n            var marker = this.overviewModel.groupMarkerList[markerIndex];\n\n            if (this.isBetween(this.overviewModel.mousePosition.x, marker.startX, marker.endX) &&\n                this.isBetween(this.overviewModel.mousePosition.y, marker.startY, marker.endY)) {\n                this.overviewCursor = \"pointer\";\n                this.overviewModel.hoveredMarker = marker;\n                return;\n            }\n        }\n    }\n\n    checkAndSetHoveredGroup() {\n        var groupList;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            var metric = this.overviewModel.metricList[this.overviewModel.selectedMetricIndex];\n            groupList = this.getCurrentSingleMetricGroupList(metric);\n        } else {\n            groupList = this.getCurrentMultiMetricGroupList();\n        }\n\n        return this.checkAndSetHoveredGroupInGroupList(groupList);\n    }\n\n    checkAndSetHoveredGroupInGroupList(groupList) {\n        for (var i = 0; i < groupList.length; ++i) {\n            var group = groupList[i];\n\n            if (this.checkGroupIsHovered(group)) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    checkGroupIsHovered(group) {\n        if (this.isBetween(this.overviewModel.mousePosition.y, group.y, group.y + this.config.overview.groupedPointHeight)) {\n            this.overviewModel.hoveredGroup = group;\n            this.setOverviewCursorToPointer();\n            return true;\n        }\n    }\n\n    setSelectedTimeIndex() {\n        var overviewMetric = this.overviewModel.metricList[this.overviewModel.selectedMetricIndex];\n        var groupList = this.getCurrentMultiMetricGroupList();\n\n        for (var groupIndex = 0; groupIndex < groupList.length; ++groupIndex) {\n            var instanceMetric = groupList[groupIndex].instanceList[0].metricList[this.overviewModel.selectedMetricIndex];\n\n            for (var compressedTimeIndex = 0; compressedTimeIndex < overviewMetric.compressedTimeIndexList.length; ++compressedTimeIndex) {\n                var pointIndex = overviewMetric.compressedTimeIndexList[compressedTimeIndex];\n                var point = instanceMetric.data[pointIndex];\n\n                if (point) {\n                    if (this.checkDataPointIsSelected(point)) {\n                        this.overviewModel.selectedTimeIndex = pointIndex;\n                        return;\n                    }\n                }\n            }\n        }\n    }\n\n    checkDataPointIsSelected(point) {\n        return this.isBetween(this.overviewModel.mousePosition.x, point.x, point.x + this.config.overview.pointWidth);\n    }\n\n    drawTimeIndicators() {\n        this.clearTimeIndicator();\n        this.overviewTimeIndicatorContext.strokeStyle = this.config.timeIndicator.color;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.drawTimeIndicatorWrapper(this.overviewModel.metricList[this.overviewModel.selectedMetricIndex]);\n        } else {\n            this.overviewModel.metricList.forEach((metric, metricIndex) => {\n                this.drawTimeIndicatorWrapper(metric, metricIndex);\n            });\n        }\n\n        this.drawSelectedTimeLabel();\n    }\n\n    drawTimeIndicatorWrapper(overviewMetric, metricIndex) {\n        var horizontalLineY = this.drawHorizontalTimeLine(overviewMetric, this.overviewModel.hoveredGroup);\n        var verticalLineX;\n\n        if (this.isCompressed && this.groupingMode == this.enumList.groupingMode.MULTIPLE &&\n            metricIndex != null && metricIndex != this.overviewModel.selectedMetricIndex) {\n            verticalLineX = this.getTimeIndicatorXForNonSelectedMetric(overviewMetric, metricIndex);\n        } else {\n            verticalLineX = overviewMetric.startX + this.overviewModel.mousePositionXOffset;\n        }\n\n        this.drawSelectedTimePoint(overviewMetric, horizontalLineY, verticalLineX);\n    }\n\n    getTimeIndicatorXForNonSelectedMetric(overviewMetric, metricIndex) {\n        var previousPointIndex = 0;\n\n        for (var compressedTimeIndex = 0; compressedTimeIndex < overviewMetric.compressedTimeIndexList.length; ++compressedTimeIndex) {\n            var currentPointIndex = overviewMetric.compressedTimeIndexList[compressedTimeIndex];\n\n            if (this.isBetween(this.overviewModel.selectedTimeIndex, previousPointIndex, currentPointIndex)) {\n                var groupList = this.getCurrentMultiMetricGroupList();\n\n                for (var groupIndex = 0; groupIndex < groupList.length; ++groupIndex) {\n                    var instanceMetric = groupList[groupIndex].instanceList[0].metricList[metricIndex];\n                    var point = instanceMetric.data[overviewMetric.compressedTimeIndexList[compressedTimeIndex]];\n\n                    if (point) {\n                        return point.x;\n                    }\n                }\n            }\n\n            previousPointIndex = currentPointIndex;\n        }\n    }\n\n    drawHorizontalTimeLine(metric, group) {\n        var horizontalLineY = group.y - this.config.overview.marginBetweenGroups / 2;\n        this.overviewTimeIndicatorContext.beginPath();\n        this.overviewTimeIndicatorContext.moveTo(metric.startX, horizontalLineY);\n        this.overviewTimeIndicatorContext.lineTo(metric.endX, horizontalLineY);\n        this.overviewTimeIndicatorContext.stroke();\n        this.overviewTimeIndicatorContext.closePath();\n        return horizontalLineY;\n    }\n\n    drawSelectedTimePoint(metric, horizontalLineY, verticalLineX) {\n        this.overviewTimeIndicatorContext.beginPath();\n        this.overviewTimeIndicatorContext.moveTo(verticalLineX, horizontalLineY);\n        this.overviewTimeIndicatorContext.lineTo(verticalLineX, this.overviewModel.hoveredGroup.y);\n        this.overviewTimeIndicatorContext.stroke();\n        this.overviewTimeIndicatorContext.closePath();\n    }\n\n    drawSelectedTimeLabel() {\n        for (var metricIndex = 0; metricIndex < this.overviewModel.metricList.length; ++metricIndex) {\n            var overviewMetric = this.overviewModel.metricList[metricIndex];\n\n            // some groups are empty -> need to iterate through group list until find one that isn't\n            var groupList = this.getCurrentSingleMetricGroupList(overviewMetric)\n\n            for (var groupIndex = 0; groupIndex < groupList.length; ++groupIndex) {\n                var instanceMetric = groupList[groupIndex].instanceList[0].metricList[metricIndex];\n\n                if (this.isCompressed) {\n                    for (var compressedTimeIndex = 0; compressedTimeIndex < overviewMetric.compressedTimeIndexList.length; ++compressedTimeIndex) {\n                        var point = instanceMetric.data[overviewMetric.compressedTimeIndexList[compressedTimeIndex]];\n\n                        if (point) {\n                            if (this.checkDataPointIsSelectedAndDrawTimeLabel(point)) {\n                                return;\n                            }\n                        }\n                    }\n                } else {\n                    for (var pointIndex = 0; pointIndex < instanceMetric.data.length; ++pointIndex) {\n                        var point = instanceMetric.data[pointIndex];\n\n                        if (this.checkDataPointIsSelectedAndDrawTimeLabel(point)) {\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    checkDataPointIsSelectedAndDrawTimeLabel(point) {\n        if (this.checkDataPointIsSelected(point)) {\n            this.overviewTimeIndicatorContext.font = \"italic \" + this.config.overview.timeFontSize + \"px Arial\";\n            this.overviewTimeIndicatorContext.fillStyle = \"black\";\n            var date = this.convertDateToString(point.date * 1000);\n            var y = this.overviewModel.overviewStartY + this.overviewModel.overviewHeight + this.config.overview.marginBetweenLabelsAndOverview;\n            var x = Math.max(0, this.overviewModel.mousePosition.x - this.overviewModel.toDateWidth / 2);\n            this.overviewTimeIndicatorContext.fillText(date, x, y);\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    initialiseSelectedGroupTimeRangeIndexList() {\n        this.overviewModel.timeRangeGroup.timeRangeMetricIndex = this.overviewModel.selectedMetricIndex;\n        this.overviewModel.timeRangeGroup.timeRangeIndexList = [];\n        var instanceMetric = this.overviewModel.timeRangeGroup.instanceList[0].metricList[this.overviewModel.selectedMetricIndex];\n        var overviewMetric = this.overviewModel.metricList[this.overviewModel.selectedMetricIndex];\n        var startX = overviewMetric.startX + this.overviewModel.timeRangeStartOffset;\n        var endX = overviewMetric.startX + this.overviewModel.mousePositionXOffset;\n\n        if (startX > endX) {\n            var temp = startX;\n            startX = endX;\n            endX = temp;\n        }\n\n        instanceMetric.data.forEach((point, pointIndex) => {\n            if (this.isBetween(point.x, startX, endX)) {\n                this.overviewModel.timeRangeGroup.timeRangeIndexList.push(pointIndex);\n            }\n        });\n\n        if (this.overviewModel.timeRangeGroup.timeRangeIndexList.length > 0) {\n            this.setTimeRangeStartAndEndDate();\n        }\n    }\n\n    setTimeRangeStartAndEndDate() {\n        var timeRangeGroup = this.overviewModel.timeRangeGroup;\n        var metric = timeRangeGroup.instanceList[0].metricList[this.overviewModel.selectedMetricIndex];\n        var timeRangeIndexList = timeRangeGroup.timeRangeIndexList;\n        var startPoint = metric.data[timeRangeIndexList[0]];\n        timeRangeGroup.startTimeRangeDate = this.convertDateToString(startPoint.date * 1000);\n        var endPoint = metric.data[timeRangeIndexList[timeRangeIndexList.length - 1]];\n        timeRangeGroup.endTimeRangeDate = this.convertDateToString(endPoint.date * 1000);\n    }\n\n    drawSelectedTimeRanges() {\n        this.clearTimeIndicator();\n        this.overviewTimeIndicatorContext.strokeStyle = this.config.timeIndicator.color;\n        this.overviewTimeIndicatorContext.fillStyle = this.config.timeIndicator.color;\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n            this.overviewModel.metricList.forEach((metric) => {\n                var groupList = this.getCurrentSingleMetricGroupList(metric);\n\n                groupList.forEach((group) => {\n                    this.drawSelectedTimeRangeWrapper(group, [group.timeRangeMetricIndex]);\n                });\n            });\n        } else {\n            var groupList = this.getCurrentMultiMetricGroupList();\n\n            groupList.forEach((group) => {\n                this.drawSelectedTimeRangeWrapper(group, Array.from(Array(this.overviewModel.metricList.length).keys()));\n            });\n        }\n    }\n\n    drawSelectedTimeRangeWrapper(group, metricIndexList) {\n        if (group.timeRangeIndexList && group.timeRangeIndexList.length > 0) {\n            metricIndexList.forEach((metricIndex) => {\n                var instanceMetric = group.instanceList[0].metricList[metricIndex];\n                var overviewMetric = this.overviewModel.metricList[metricIndex];\n                var startPoint, endPoint;\n                var startRangeIndex = group.timeRangeIndexList[0];\n                var endRangeIndex = group.timeRangeIndexList[group.timeRangeIndexList.length - 1];\n\n                if (this.isCompressed && metricIndex != group.timeRangeMetricIndex) {\n                    var previousPointIndex = 0;\n                    var groupList = this.getCurrentMultiMetricGroupList();\n\n                    for (var compressedTimeIndex = 0; compressedTimeIndex < overviewMetric.compressedTimeIndexList.length; ++compressedTimeIndex) {\n                        var currentPointIndex = overviewMetric.compressedTimeIndexList[compressedTimeIndex];\n\n                        if (this.isBetween(startRangeIndex, previousPointIndex, currentPointIndex)) {\n                            startPoint = this.getTimeRangePointWrapper(previousPointIndex, groupList, metricIndex);\n                        }\n\n                        if (this.isBetween(endRangeIndex, previousPointIndex, currentPointIndex)) {\n                            endPoint = this.getTimeRangePointWrapper(currentPointIndex, groupList, metricIndex);\n                        }\n\n                        previousPointIndex = currentPointIndex;\n                    }\n\n                } else {\n                    startPoint = instanceMetric.data[startRangeIndex];\n                    endPoint = instanceMetric.data[endRangeIndex];\n                }\n\n                if (startPoint) {\n                    this.drawSelectedTimeRangeLines(overviewMetric, group, startPoint, endPoint);\n                }\n            });\n        }\n    }\n\n    getTimeRangePointWrapper(pointIndex, groupList, metricIndex) {\n        for (var groupIndex = 0; groupIndex < groupList.length; ++groupIndex) {\n            var instance = groupList[groupIndex].instanceList[0];\n            var point = instance.metricList[metricIndex].data[pointIndex];\n\n            if (point) {\n                return point;\n            }\n        }\n    }\n\n    drawSelectedTimeRangeLines(overviewMetric, group, startPoint, endPoint) {\n        var startY = this.drawHorizontalTimeLine(overviewMetric, group);\n        var startX = startPoint.x;\n        var endX = endPoint.x + this.config.overview.pointWidth;\n        var width = endX - startX;\n        var height = group.y - startY;\n        this.overviewTimeIndicatorContext.fillRect(startX, startY, width, height);\n    }\n\n    mouseUpOnOverView(evt) {\n        if (this.isGrouped) {\n            if (this.overviewModel.hoveredMarker) {\n                this.startFocusMarkerInterval(this.overviewModel.hoveredMarker.group);\n            } else {\n                this.updateSelectedGroupListAndDrawFocusGraph();\n            }\n        } else if (!this.isCompressed) {\n            this.fixFocusArea(evt);\n        }\n    }\n\n    startFocusMarkerInterval(group) {\n        if (this.focusGroupWithInterval != group) {\n            this.stopInterval();\n            this.focusGroupWithInterval = group;\n            this.initialiseFocusMarkerInterval();\n        }\n    }\n\n    stopInterval() {\n        this.stopOverviewMarkerInterval();\n        this.stopFocusMarkerInterval();\n    }\n\n    stopOverviewMarkerInterval() {\n        if (this.currentOverviewMarkerInterval) {\n            this.$interval.cancel(this.currentOverviewMarkerInterval);\n\n            if (this.overviewGroupWithInterval) {\n                this.overviewGroupWithInterval.overviewMarkerX = 0;\n\n                if (this.focusModel.overviewGroupWithIntervalList) {\n                    this.focusModel.overviewGroupWithIntervalList.forEach((overviewGroup) => {\n                        overviewGroup.markerX = 0;\n                    });\n                }\n\n                this.drawSelectedGroupsMarkers();\n            }\n\n            this.overviewGroupWithInterval = null;\n        }\n    }\n\n    stopFocusMarkerInterval() {\n        if (this.currentFocusMarkerInterval) {\n            this.$interval.cancel(this.currentFocusMarkerInterval);\n\n            if (this.focusGroupWithInterval) {\n                this.focusGroupWithInterval.focusMarkerX = 0;\n                this.focusGroupWithInterval = null;\n                this.drawGroupFocusMarkers();\n            }\n        }\n    }\n\n    initialiseFocusMarkerInterval() {\n        this.focusMarkerMovingBackwards = false;\n        this.focusGroupWithInterval.focusMarkerX = 0;\n\n        this.currentFocusMarkerInterval = this.$interval(() => {\n            if (this.focusMarkerMovingBackwards) {\n                this.handleFocusMarkerMovingBackwardCase();\n            } else {\n                this.handleFocusMarkerMovingForwardCase();\n            }\n\n            this.drawGroupFocusMarkers();\n        }, this.config.intervalTimer);\n    }\n\n    handleFocusMarkerMovingBackwardCase() {\n        if (this.focusGroupWithInterval.focusMarkerX == 0) {\n            this.focusMarkerMovingBackwards = false;\n            ++this.focusGroupWithInterval.focusMarkerX;\n        } else {\n            --this.focusGroupWithInterval.focusMarkerX;\n        }\n    }\n\n    handleFocusMarkerMovingForwardCase() {\n        if (this.focusGroupWithInterval.focusMarkerX == Math.round(this.config.focusGraph.marginBetweenMarkers / 2)) {\n            this.focusMarkerMovingBackwards = true;\n            --this.focusGroupWithInterval.focusMarkerX;\n        } else {\n            ++this.focusGroupWithInterval.focusMarkerX;\n        }\n    }\n\n    updateSelectedGroupListAndDrawFocusGraph() {\n        this.$timeout(() => {\n            var updatedSelectedGroups = false;\n\n            if (this.timeHighlightMode == this.enumList.timeHighlightMode.POINT) {\n                if (this.overviewModel.hoveredGroup) {\n                    this.addOrRemoveGroupToFocus(this.overviewModel.hoveredGroup, true);\n                    updatedSelectedGroups = true;\n                } else {\n                    this.stopInterval();\n                }\n            } else if (this.overviewModel.isSelectingTimeRange) {\n                var removeExisting = this.overviewModel.timeRangeStartOffset == this.overviewModel.mousePositionXOffset;\n                this.addOrRemoveGroupToFocus(this.overviewModel.timeRangeGroup, removeExisting);\n                updatedSelectedGroups = true;\n            }\n\n            this.scope.$apply();\n\n            if (updatedSelectedGroups) {\n                this.initialiseGroupsOverlapMap();\n                this.drawSelectedGroupsMarkers();\n                this.drawFocusGraph();\n            }\n\n            this.overviewModel.isSelectingTimeRange = false;\n        });\n    }\n\n    fixFocusArea(evt) {\n        this.initialiseOverviewCanvasCursor();\n\n        if (this.focusAreaIsFixed) {\n            this.drawFocus(evt);\n        }\n\n        this.focusAreaIsFixed = !this.focusAreaIsFixed;\n    }\n\n    drawFocus(evt) {\n        this.drawFocusArea();\n\n        for (var i = 0; i < this.overviewModel.metricList.length; ++i) {\n            var metric = this.overviewModel.metricList[i];\n\n            if (metric) {\n                // only update focus graph if mouse is pointing on one of metric overview graphs\n                if (this.checkMouseIsInMetric(metric)) {\n                    this.drawFocusGraph();\n                    break;\n                }\n            }\n        }\n    }\n\n    drawFocusArea() {\n        if (this.overviewModel.mousePosition) {\n            this.clearFocusArea();\n            var size = this.getFocusAreaSize();\n            var minimumTopY = Math.max(this.overviewModel.overviewStartY, this.overviewModel.mousePosition.y - size / 2);\n            this.focusModel.focusStartY = Math.min(minimumTopY, this.overviewModel.overviewEndY - size);\n            var size = this.getFocusAreaSize();\n            var offset = this.getFocusAreaOffset();\n\n            if (offset >= 0) {\n                this.focusAreaContext.strokeStyle = this.config.focusArea.color;\n\n                this.overviewModel.metricList.forEach((metric) => {\n                    metric.focusStartX = metric.startX + offset;\n                    this.focusAreaContext.strokeRect(metric.focusStartX, this.focusModel.focusStartY, size, size);\n                });\n            }\n        }\n    }\n\n    getFocusAreaSize() {\n        return Math.min(this.config.focusArea.focusAreaSize * 2, this.overviewModel.overviewEndY - this.overviewModel.overviewStartY);\n    }\n\n    getFocusAreaOffset() {\n        for (var i = 0; i < this.overviewModel.metricList.length; ++i) {\n            var metric = this.overviewModel.metricList[i];\n\n            if (metric) {\n                if (this.checkMouseIsInMetric(metric)) {\n                    this.overviewModel.mousePositionXOffset = this.overviewModel.mousePosition.x - metric.startX;\n                    this.focusModel.sourceMetricIndex = i;\n\n                    return Math.min(Math.max(metric.startX,\n                        this.overviewModel.mousePosition.x - this.config.focusArea.focusAreaSize),\n                        metric.endX - this.getFocusAreaSize()) - metric.startX;\n                }\n            }\n        }\n    }\n\n    getFocusGraphPointWidth() {\n        return this.isGrouped ? this.config.focusGraph.groupedPointWidth : this.config.focusGraph.ungroupedPointWidth;\n    }\n\n    initialiseFocusGraphData() {\n        if (!this.focusModel.data) {\n            this.focusModel.data = [];\n        }\n\n        this.focusModel.data.length = 0;\n\n        this.overviewModel.data.forEach((overviewInstance) => {\n            if (this.checkInstanceInFocus(overviewInstance)) {\n                this.focusModel.focusedIndexList = this.getIndexesOfPointsInFocus(overviewInstance);\n                var focusInstance = this.getFocusInstance(overviewInstance, this.focusModel.focusedIndexList);\n                this.focusModel.data.push(focusInstance);\n            }\n        });\n    }\n\n    checkInstanceInFocus(instance) {\n        return instance.y <= this.focusModel.focusStartY + this.getFocusAreaSize() &&\n            instance.y + this.overviewModel.instanceHeight >= this.focusModel.focusStartY\n    }\n\n    getIndexesOfPointsInFocus(overviewInstance) {\n        var indexes = [];\n\n        for (var i = 0; i < overviewInstance.metricList.length; ++i) {\n            var metric = overviewInstance.metricList[i];\n\n            if (metric.data.length > 0) {\n                var overviewMetric = this.overviewModel.metricList[i];\n\n                metric.data.forEach((point, index) => {\n                    if (this.isBetween(point.x, overviewMetric.focusStartX, overviewMetric.focusStartX + this.getFocusAreaSize())) {\n                        indexes.push(index);\n                    }\n                });\n\n                break;\n            }\n        }\n\n        return indexes;\n    }\n\n    getFocusInstance(overviewInstance, indexList) {\n        var focusInstance = {};\n        focusInstance.instance = overviewInstance.instance;\n        focusInstance.overviewInstance = overviewInstance;\n        this.initialiseFocusInstanceData(focusInstance, overviewInstance, indexList);\n        return focusInstance;\n    }\n\n    initialiseFocusInstanceData(focusInstance, overviewInstance, indexList) {\n        focusInstance.metricList = [];\n        this.addFocusMetrics(focusInstance, overviewInstance, indexList);\n        this.initialiseInstanceLayers(focusInstance);\n    }\n\n    addFocusMetrics(focusInstance, overviewInstance, indexList) {\n        this.overviewModel.metricList.forEach((metric, metricIndex) => {\n            var focusMetric = {};\n            focusMetric.data = [];\n            focusMetric.layerList = [];\n\n            indexList.forEach((index) => {\n                var point = overviewInstance.metricList[metricIndex].data[index];\n\n                if (point) {\n                    focusMetric.data.push(point);\n                }\n            });\n\n            focusInstance.metricList.push(focusMetric);\n        });\n    }\n\n    initialiseInstanceLayers(instance) {\n        instance.metricList.forEach((instanceMetric, metricIndex) => {\n            for (var i = 0; i < this.config.colorCount; ++i) {\n                var layer = {};\n                layer.valueList = [];\n                instanceMetric.layerList.push(layer);\n            }\n\n            var overviewMetric = this.overviewModel.metricList[metricIndex];\n\n            instanceMetric.data.forEach((point) => {\n                var value = point.value;\n                var colorList = this.panel.metricList[metricIndex].colorList;\n\n                instanceMetric.layerList.forEach((layer, layerIndex) => {\n                    overviewMetric.colorMap.forEach((color, threshold) => {\n                        if (color == colorList[layerIndex]) {\n                            layer.valueList.push(value > 0 ? value : 0);\n                            value -= threshold.max;\n                            layer.range = threshold.max - threshold.min;\n                        }\n                    });\n                });\n            });\n        });\n    }\n\n    setFocusFromAndToDate() {\n        for (var instanceIndex = 0; instanceIndex < this.overviewModel.data.length; ++instanceIndex) {\n            var instance = this.overviewModel.data[instanceIndex];\n            var set = false;\n\n            for (var metricIndex = 0; metricIndex < instance.metricList.length; ++metricIndex) {\n                var metric = instance.metricList[metricIndex];\n                var fromIndex = this.focusModel.focusedIndexList[0];\n                var toIndex = this.focusModel.focusedIndexList[this.focusModel.focusedIndexList.length - 1];\n\n                if (metric.data[fromIndex] && metric.data[toIndex]) {\n                    this.focusedFromDate = this.convertDateToString(metric.data[fromIndex].date * 1000);\n                    this.focusedToDate = this.convertDateToString(metric.data[toIndex].date * 1000);\n                    set = true;\n                    break;\n                }\n            }\n\n            if (set) {\n                break;\n            }\n        }\n    }\n\n    positionFocusFromAndToDate() {\n        this.timeFontSize = this.config.overview.timeFontSize;\n        this.setOverviewContextTimeFont();\n        var canvasStartX = this.getElementByID(\"canvasCell\").offsetLeft;\n        var fromDateWidth = this.overviewContext.measureText(this.focusedFromDate).width;\n        this.fromDateLeftMargin = canvasStartX - (fromDateWidth / 2);\n        this.toDateLeftMargin = this.focusGraphWidth - fromDateWidth;\n    }\n\n    drawFocusGraphData() {\n        if (this.isGrouped) {\n            this.$timeout(() => {\n                if (this.groupingMode == this.enumList.groupingMode.SINGLE) {\n                    this.focusGraphMarkerWidth = (this.config.focusGraph.markerSize + this.config.focusGraph.marginBetweenMarkers) *\n                        this.overviewModel.metricList.length;\n                } else {\n                    this.focusGraphMarkerWidth = this.config.focusGraph.markerSize + this.config.focusGraph.marginBetweenMarkers;\n                }\n\n                this.focusGraphMarkerHeight = this.config.focusGraph.markerSize;\n                this.scope.$apply();\n                this.drawGroupFocusMarkers();\n                this.drawGroupedFocusGraph();\n            });\n        } else {\n            this.drawUngroupedFocusGraph();\n        }\n    }\n\n    drawGroupFocusMarkers() {\n        this.focusModel.groupList.forEach((group, groupIndex) => {\n            group.instanceList.forEach((instance, instanceIndex) => {\n                if (instanceIndex == 0 || group.showDetails) {\n                    this.drawGroupedFocusMarker(group, groupIndex, instance, instanceIndex);\n                }\n            });\n        });\n    }\n\n    drawGroupedFocusMarker(group, groupIndex, instance, instanceIndex) {\n        var canvas = this.getElementByID(\"focusGroupMarkerCanvas-\" + groupIndex + \"-\" + instanceIndex);\n        var context = this.getCanvasContext(canvas);\n        context.clearRect(0, 0, canvas.width, canvas.height);\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE && group.showDetails) {\n            instance.groupWithMarkerList = [];\n\n            instance.overviewInstance.groupList.forEach((instanceGroup, instanceGroupIndex) => {\n                if (instanceGroup.isSelected) {\n                    instance.groupWithMarkerList.push(instanceGroup);\n                    var x = (this.config.focusGraph.markerSize + this.config.focusGraph.marginBetweenMarkers) * instanceGroupIndex;\n                    this.drawGroupedFocusMarkerWrapper(context, instanceGroup, x);\n                }\n            });\n        } else {\n            this.drawGroupedFocusMarkerWrapper(context, group.overviewGroup, 0);\n        }\n    }\n\n    drawGroupedFocusMarkerWrapper(context, group, x) {\n        if (group == this.focusGroupWithInterval) {\n            x += this.focusGroupWithInterval.focusMarkerX;\n        }\n\n        context.fillStyle = group.color;\n        context.fillRect(x, 0, this.config.focusGraph.markerSize, this.config.focusGraph.markerSize);\n    }\n\n    drawGroupedFocusGraph() {\n        this.focusModel.groupList.forEach((group, groupIndex) => {\n            group.instanceList.forEach((instance, instanceIndex) => {\n                if (instanceIndex == 0 || group.showDetails) {\n                    this.drawGroupedFocusGraphWrapper(group, groupIndex, instance, instanceIndex);\n                }\n            });\n        });\n    }\n\n    drawGroupedFocusGraphWrapper(group, groupIndex, instance, instanceIndex) {\n        // full time range\n        var maxMetricLength = this.getMaxMetricLength();\n        var canvas = this.getGroupedFocusCanvas(groupIndex, instanceIndex);\n        var valueList = Array.from(Array(maxMetricLength).keys());\n        var metricList = instance.metricList;\n        var metricIndexList = Array.from(Array(instance.metricList.length).keys())\n\n        if (this.groupingMode == this.enumList.groupingMode.SINGLE && !group.showAllMetrics) {\n            metricList = [instance.metricList[group.mainMetricIndex]];\n            metricIndexList = [group.mainMetricIndex];\n        }\n\n        this.drawGroupedFocusGraphInstance(canvas, valueList, this.getFocusGraphPointWidth(), metricList, metricIndexList);\n\n        // selected time range\n        if (group.overviewGroup.timeRangeIndexList) {\n            var canvas = this.getElementByID(\"focusGraphHighlightedTimeRangeCanvas-\" + groupIndex + \"-\" + instanceIndex);\n            var pointWidth = Math.floor(this.focusGraphWidth / focusGraphHeightoverviewGroup.timeRangeIndexList.length);\n            this.drawGroupedFocusGraphInstance(canvas, group.overviewGroup.timeRangeIndexList, pointWidth, metricList, metricIndexList);\n        }\n    }\n\n    getGroupedFocusCanvas(groupIndex, instanceIndex) {\n        return this.getElementByID(\"focusGraphCanvas-\" + groupIndex + \"-\" + instanceIndex);\n    }\n\n    drawGroupedFocusGraphInstance(canvas, valueIndexList, pointWidth, metricList, metricIndexList) {\n        var context = this.getCanvasContext(canvas);\n        context.clearRect(0, 0, canvas.width, canvas.height);\n        this.drawFocusGraphInstance(context, valueIndexList, pointWidth, metricList, metricIndexList);\n    }\n\n    drawFocusGraphInstance(context, valueIndexList, pointWidth, metricList, metricIndexList) {\n        metricList.forEach((metric, metricListIndex) => {\n            metric.layerList.forEach((layer, layerIndex) => {\n                // start drawing from bottom\n                var metricIndex = metricIndexList[metricListIndex];\n                var panelMetric = this.panel.metricList[metricIndex];\n                context.fillStyle = panelMetric.colorList[layerIndex];\n                var y = (this.config.focusGraph.metricMaxHeight + this.config.focusGraph.marginBetweenMetrics) * metricIndex +\n                    this.config.focusGraph.metricMaxHeight;\n                context.beginPath();\n                context.moveTo(0, y);\n                var x = 0;\n                var previousX = 0;\n                var previousValue = 0;\n\n                valueIndexList.forEach((valueIndex, positionIndex) => {\n                    var value = layer.valueList[valueIndex];\n\n                    if (value != null) {\n                        x = pointWidth * positionIndex;\n                        this.moveFocusGraphContextBasedOnValue(context, value, previousValue, layer, layerIndex, x, y, previousX);\n                        previousX = x;\n                        previousValue = value;\n                    }\n                });\n\n                context.lineTo(x, y);\n                context.lineTo(this.focusModel.graphBeginX, y);\n                context.closePath();\n                context.fill();\n            });\n        });\n    }\n\n    drawUngroupedFocusGraph() {\n        this.focusModel.data.forEach((instance, instanceIndex) => {\n            var canvas = this.getUngroupedFocusCanvas(instanceIndex);\n            var context = this.getCanvasContext(canvas);\n            context.clearRect(0, 0, canvas.width, canvas.height);\n            var valueIndexList = Array.from(Array(this.getMaxMetricLength()).keys());\n            var metricIndexList = Array.from(Array(instance.metricList.length).keys());\n            this.drawFocusGraphInstance(context, valueIndexList, this.config.focusGraph.ungroupedPointWidth, instance.metricList, metricIndexList);\n        });\n    }\n\n    getUngroupedFocusCanvas(instanceIndex) {\n        return this.getElementByID(\"focusGraphCanvas-\" + instanceIndex);\n    }\n\n    moveFocusGraphContextBasedOnValue(context, value, previousValue, layer, layerIndex, x, y, previousX) {\n        if (value == 0) {\n            // draw line straight down to base if value is 0\n            context.lineTo(x, y);\n        } else {\n            // move to previous position at base if previous value is 0\n            if (layerIndex > 0 && previousValue == 0) {\n                context.lineTo(previousX, y);\n            }\n\n            var height;\n\n            if (value >= layer.range) {\n                height = this.config.focusGraph.metricMaxHeight;\n            } else {\n                height = value * this.config.focusGraph.metricMaxHeight / layer.range;\n            }\n\n            height = Math.max(5, height);\n            context.lineTo(x, y - height);\n        }\n    }\n\n    autoSrollFocusGraph() {\n        if (this.isGrouped) {\n            if (this.overviewModel.hoveredGroup && this.overviewModel.hoveredGroup.isSelected) {\n                var rowCount = 0;\n\n                this.focusModel.groupList.forEach((group) => {\n                    if (group.showDetails) {\n                        rowCount += group.instanceList.length;\n                    } else {\n                        ++rowCount;\n                    }\n                });\n\n                this.focusGraphContainer.scrollTop = this.focusModel.focusRowHeight * rowCount;\n            }\n        } else {\n            this.scrollByInstance();\n        }\n    }\n\n    scrollByInstance() {\n        var instance = this.getHoveredInstance();\n\n        if (instance) {\n            for (var i = 0; i < this.focusModel.data.length; ++i) {\n                var focusModelInstance = this.focusModel.data[i];\n\n                if (instance.instance == focusModelInstance.instance) {\n                    focusModelInstance.isSelected = true;\n                    this.focusGraphContainer.scrollTop = this.focusModel.focusRowHeight * i;\n                } else {\n                    focusModelInstance.isSelected = false;\n                }\n            }\n        }\n    }\n\n    getHoveredInstance() {\n        for (var i = 0; i < this.overviewModel.data.length; ++i) {\n            var instance = this.overviewModel.data[i];\n\n            if (this.isBetween(this.overviewModel.mousePosition.y, instance.y - this.config.overview.ungroupedPointHeight, instance.y)) {\n                return instance;\n            }\n        }\n    }\n\n    moveMouseOnFocusGroup(group, instance) {\n        if (this.groupingMode == this.enumList.groupingMode.MULTIPLE || !group.showDetails) {\n            this.focusModel.overviewGroupWithIntervalList = [group.overviewGroup];\n            this.startOverviewMarkerInterval(group);\n        } else {\n            this.focusModel.overviewGroupWithIntervalList = instance.groupWithMarkerList;\n            this.startOverviewMarkerInterval(group);\n        }\n    }\n\n    startOverviewMarkerInterval(group) {\n        if (this.overviewGroupWithInterval != group) {\n            this.stopInterval();\n            this.overviewGroupWithInterval = group;\n            this.initialiseOverviewMarkerInterval();\n        }\n    }\n\n    initialiseOverviewMarkerInterval() {\n        this.overviewMarkerMovingBackwards = false;\n        this.overviewGroupWithInterval.overviewMarkerX = 0;\n\n        this.currentOverviewMarkerInterval = this.$interval(() => {\n            if (this.overviewMarkerMovingBackwards) {\n                this.handleOverviewMarkerMovingBackwardCase();\n            } else {\n                this.handleOverviewMarkerMovingForwardCase();\n            }\n\n            if (this.focusModel.overviewGroupWithIntervalList) {\n                this.focusModel.overviewGroupWithIntervalList.forEach((overviewGroup) => {\n                    overviewGroup.markerX = this.overviewGroupWithInterval.overviewMarkerX;\n                });\n            }\n\n            this.drawSelectedGroupsMarkers();\n        }, this.config.intervalTimer);\n    }\n\n    handleOverviewMarkerMovingBackwardCase() {\n        if (this.overviewGroupWithInterval.overviewMarkerX == 0) {\n            this.overviewMarkerMovingBackwards = false;\n            ++this.overviewGroupWithInterval.overviewMarkerX;\n        } else {\n            --this.overviewGroupWithInterval.overviewMarkerX;\n        }\n    }\n\n    handleOverviewMarkerMovingForwardCase() {\n        if (this.overviewGroupWithInterval.overviewMarkerX == Math.round(this.config.overview.marginBetweenMarkerAndGroup / 2)) {\n            this.overviewMarkerMovingBackwards = true;\n            --this.overviewGroupWithInterval.overviewMarkerX;\n        } else {\n            ++this.overviewGroupWithInterval.overviewMarkerX;\n        }\n    }\n\n    showNodes(group, event) {\n        event.preventDefault();\n\n        this.$timeout(() => {\n            group.showDetails = !group.showDetails;\n            this.scope.$apply();\n            this.drawFocusGraphData();\n        });\n    }\n\n    showHideAllMetrics() {\n        this.drawFocusGraph();\n    }\n\n    selectGroup(instance, evt, groupIndex, instanceIndex) {\n        if (this.isGrouped) {\n            this.focusModel.groupList.forEach((group) => {\n                group.instanceList.forEach((instance) => {\n                    instance.isSelected = false;\n                })\n            });\n        } else {\n            this.focusModel.data.forEach((focusInstance) => {\n                focusInstance.isSelected = false;\n            });\n        }\n\n        instance.isSelected = true;\n        var canvas = this.getGroupedFocusCanvas(groupIndex, instanceIndex);\n        this.showPopup(instance, evt, groupIndex, instanceIndex, canvas)\n    }\n\n    showPopup(instance, evt, canvas) {\n        var mousePos = this.getMousePos(evt, canvas);\n        var metricHeight = this.config.focusGraph.metricMaxHeight + this.config.focusGraph.marginBetweenMetrics;\n\n        for (var i = 0; i < this.overviewModel.metricList.length; ++i) {\n            if (this.isBetween(mousePos.y, i * metricHeight, (i + 1) * metricHeight)) {\n                var metric = this.panel.metricList[i];\n\n                if (metric.popupURL && metric.popupURL != \"\") {\n                    window.open(metric.popupURL + \"?orgId=1&var-node=\" + instance.instance,\n                        instance.instance, \"top=300, left=300, width=600, height=500\");\n                }\n\n                break;\n            }\n        }\n    }\n\n    selectNode(index, evt) {\n        var instance = this.focusModel.data[index];\n        instance.isSelected = true;\n        var canvas = this.getUngroupedFocusCanvas(index);\n        this.showPopup(instance, evt, canvas)\n    }\n\n    removeMetric(metric) {\n        _.remove(this.panel.metricList, (search) => {\n            return search == metric;\n        });\n    }\n\n    addMetric() {\n        var metric = {};\n        metric.color = \"#000000\";\n        this.panel.metricList.push(metric);\n    }\n}\n\nHeatmapCtrl.templateUrl = \"module.html\";"],"file":"heatmap_ctrl.js"}