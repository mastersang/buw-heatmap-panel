{"version":3,"sources":["../src/heatmap_ctrl.js"],"names":["MetricsPanelCtrl","_","HeatmapCtrl","$scope","$injector","$timeout","variableSrv","timeSrv","events","on","onDataReceived","bind","overviewModel","focusModel","initialiseConfig","config","apiAddress","instancePropertyName","dateFormat","focusAreaColor","focusAreaSize","colors","overviewPointWidth","overviewPointHeight","verticalMarginBetweenOverviewMetrics","horizontalMarginBetweenOverviewMetrics","marginBetweenInstances","focusGraphLeftMargin","xCrossSize","marginBetweenOverviewAndFocus","fontSize","focusPointWidth","focusMetricMaxHeight","marginBetweenFocusMetrics","marginBetweenFocusInstances","scope","elem","attrs","ctrl","overviewMode","linkingMode","parent","selectOverviewMode","selectLinker","moveFocusArea","evt","fixFocusArea","selectNode","initialiseCanvases","data","isUpdatingVariable","load","isLoading","$apply","metricList","loadCount","fromDate","Math","round","timeRange","from","_d","getTime","toDate","to","getDataFromAPI","processRawData","metric","index","xmlHttp","XMLHttpRequest","onreadystatechange","readyState","status","JSON","parse","responseText","result","url","encodeURIComponent","open","send","length","includes","convertDataToFloat","initialiseMetricMinMax","initialiseColorMap","initiliseOverviewData","renderOverview","forEach","instance","values","value","parseFloat","min","max","point","checkAndSetOverviewMinMax","layerRange","colorMap","getColorMap","Map","i","threshold","set","metricInstance","newInstance","find","search","initaliseNewInstance","date","push","overviewContext","clearRect","overviewCanvas","width","height","clearFocus","drawOverviewData","drawOverviewDataWrapper","getInstanceHorizontalLength","overviewInstantHeight","overviewWidth","overviewHeight","drawSingleOverview","drawMultipleOverview","focusGraphMarginTop","firstInstance","instanceIndex","y","metricIndex","pointIndex","x","color","getColorFromMap","fillStyle","fillRect","endX","overviewMetric","startX","map","getContext","focusAreaCanvas","focusAreaContext","focusGraphCanvas","focusGraphContext","font","drawFocusArea","focusAreaIsFixed","drawFocus","preventDefault","mousePosition","getMousePos","drawFocusGraph","hasFocus","canvas","rect","getBoundingClientRect","clientX","left","clientY","top","size","getFocusAreaSize","focusStartY","drawSingleFocusArea","drawMultipleFocusArea","focusStartX","strokeStyle","strokeRect","doDrawLinkers","offset","getFocusAreaOffset","drawLinkers","checkMouseIsInMetric","mousePositionXOffset","sourceMetricIndex","pixelData","getImageData","getLinkerTargetInstance","drawLinkerByMode","drawXCross","drawNormalCross","changeInstanceColor","centerX","leftBeginX","rightBeginX","bottomInstance","drawXCrossLine","startY","endY","drawLineOnFocusAreaCanvas","beginPath","moveTo","lineTo","stroke","closePath","focusSize","centertX","distanceBetweenLines","leftLineX","rightLineX","topLineY","bottomLineY","drawNormalCrossLines","instancePoint","metricInstanceIndex","metricPoint","initialiseFocusGraphData","drawFocusGraphLabels","drawFocusGraphData","overviewInstance","modalInstance","addFocusMetrics","getIndexesOfPointsInFocus","initialiseInstanceLayers","indexes","focusMetric","layerList","layer","valueList","horizontalX","setLineDash","instanceHeight","drawFocusGraphLabelByInstance","label","metrics","measureText","labelY","fillText","drawSeperator","lineY","layerIndex","previousX","previousValue","valueIndex","moveContextBasedOnValue","fill","mousePos","event","updateVariable","variables","v","name","setOptionAsCurrent","text","variableUpdated","templateUrl"],"mappings":"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","sourcesContent":["import { MetricsPanelCtrl } from \"app/plugins/sdk\";\nimport \"./heatmap.css!\";\nimport _ from \"lodash\";\n\nexport class HeatmapCtrl extends MetricsPanelCtrl {\n    constructor($scope, $injector, $timeout, variableSrv, timeSrv) {\n        super($scope, $injector);\n        this.$timeout = $timeout;\n        this.variableSrv = variableSrv;\n        this.timeSrv = timeSrv;\n        this.events.on(\"data-received\", this.onDataReceived.bind(this));\n        this.overviewModel = {};\n        this.focusModel = {};\n        this.initialiseConfig();\n    }\n\n    initialiseConfig() {\n        this.config = {\n            apiAddress: \"http://localhost:3000/api/datasources/proxy/1/api/v1/query_range?query=\",\n            instancePropertyName: \"instance\",\n            dateFormat: \"DD-MM-YYYY HH:mm\",\n            focusAreaColor: \"Aqua\",\n            focusAreaSize: 20,\n            colors: [\n                [\"f2d9e6\", \"d98cb3\", \"bf4080\", \"73264d\"],\n                [\"ccddff\", \"6699ff\", \"0055ff\", \"003399\"],\n                [\"eeeedd\", \"cccc99\", \"aaaa55\", \"666633\"]\n            ],\n            overviewPointWidth: 1,\n            overviewPointHeight: 1,\n            verticalMarginBetweenOverviewMetrics: 2,\n            horizontalMarginBetweenOverviewMetrics: 20,\n            marginBetweenInstances: 6,\n            focusGraphLeftMargin: 40,\n            xCrossSize: 15,\n            marginBetweenOverviewAndFocus: 50,\n            fontSize: 15,\n            focusPointWidth: 5,\n            focusMetricMaxHeight: 30,\n            marginBetweenFocusMetrics: 10,\n            marginBetweenFocusInstances: 20\n        }\n    }\n\n    link(scope, elem, attrs, ctrl) {\n        this.scope = scope;\n        this.scope.ctrl.overviewMode = \"1\";\n        this.scope.ctrl.linkingMode = \"xCross\";\n        this.elem = elem;\n        var parent = this;\n\n        scope.selectOverviewMode = function () {\n            parent.selectOverviewMode();\n        }\n\n        scope.selectLinker = function () {\n            parent.selectLinker();\n        }\n\n        scope.moveFocusArea = function (evt) {\n            parent.moveFocusArea.bind(parent, evt)();\n        }\n\n        scope.fixFocusArea = function (evt) {\n            parent.fixFocusArea.bind(parent, evt)();\n        }\n\n        scope.selectNode = function () {\n            parent.selectNode.bind(parent)();\n        }\n\n        this.initialiseCanvases();\n    }\n\n    onDataReceived(data) {\n        if (this.isUpdatingVariable) {\n            this.isUpdatingVariable = false;\n        } else {\n            this.load();\n        }\n    }\n\n    load() {\n        this.$timeout(() => {\n            if (this.scope.ctrl.isLoading) {\n                this.load();\n            } else {\n                this.scope.ctrl.isLoading = true;\n                this.scope.$apply();\n                this.overviewModel.metricList = [null, null, null];\n                this.loadCount = 0;\n                this.fromDate = Math.round(this.timeSrv.timeRange().from._d.getTime() / 1000);\n                this.toDate = Math.round(this.timeSrv.timeRange().to._d.getTime() / 1000);\n\n                this.getDataFromAPI(\"node_load1{job='node'}\", 0);\n\n                this.getDataFromAPI(`\n                        100 - (node_memory_MemFree_bytes{job='node'} - node_memory_Cached_bytes{job='node'}) \n                                * 100 / \n                                (node_memory_MemTotal_bytes{job='node'} + node_memory_Buffers_bytes{job='node'})\n                    `, 1);\n\n                this.getDataFromAPI(`\n                    100 - (sum by (instance) (node_filesystem_avail_bytes{job='node',device!~'(?:rootfs|/dev/loop.+)',\n                                                                            mountpoint!~'(?:/mnt/nfs/|/run|/var/run|/cdrom).*'})) \n                                * 100 / \n                            (sum by (instance) (node_filesystem_size_bytes{job='node',device!~'rootfs'}))\n                `, 2);\n\n                this.processRawData();\n            }\n        }, 100);\n    }\n\n    getDataFromAPI(metric, index) {\n        var xmlHttp = new XMLHttpRequest();\n\n        xmlHttp.onreadystatechange = () => {\n            if (xmlHttp.readyState == 4) {\n                ++this.loadCount;\n\n                if (xmlHttp.status == 200) {\n                    var metric = {}\n                    metric.data = JSON.parse(xmlHttp.responseText).data.result;\n                    this.overviewModel.metricList[index] = metric;\n                }\n            }\n        }\n\n        var url = this.config.apiAddress + encodeURIComponent(metric) + \"&start=\" + this.fromDate + \"&end=\" + this.toDate + \"&step=15\";\n        xmlHttp.open(\"GET\", url, true);\n        xmlHttp.send(null);\n    }\n\n    processRawData() {\n        this.$timeout(() => {\n            if (this.loadCount < this.overviewModel.metricList.length) {\n                this.processRawData.bind(this)();\n            } else {\n                this.scope.ctrl.isLoading = false;\n\n                if (!this.overviewModel.metricList.includes(null)) {\n                    this.convertDataToFloat();\n                    this.initialiseMetricMinMax();\n                    this.initialiseColorMap();\n                    this.initiliseOverviewData();\n                    this.renderOverview();\n                }\n            }\n        }, 100);\n    }\n\n    convertDataToFloat() {\n        this.overviewModel.metricList.forEach((metric) => {\n            metric.data.forEach((instance) => {\n                instance.values.forEach((value) => {\n                    value[0] = parseFloat(value[0]);\n                    value[1] = parseFloat(value[1]);\n                });\n            });\n        });\n    }\n\n    initialiseMetricMinMax() {\n        this.overviewModel.metricList.forEach((metric) => {\n            metric.min = -1;\n            metric.max = -1;\n\n            metric.data.forEach((instance) => {\n                instance.values.forEach((point) => {\n                    this.checkAndSetOverviewMinMax(metric, point);\n                });\n            });\n        });\n    }\n\n    checkAndSetOverviewMinMax(metric, point) {\n        var value = point[1];\n\n        if (metric.min == -1) {\n            metric.min = value;\n            metric.max = value;\n        } else {\n            if (value < metric.min) {\n                metric.min = value;\n            }\n\n            if (value > metric.max) {\n                metric.max = value;\n            }\n        }\n    }\n\n    initialiseColorMap() {\n        this.overviewModel.metricList.forEach((metric, index) => {\n            var colors = this.config.colors[index];\n            metric.layerRange = metric.max / (colors.length - 0.5);\n            metric.colorMap = this.getColorMap(metric, colors);\n        });\n    }\n\n    getColorMap(metric, colors) {\n        var colorMap = new Map();\n\n        for (var i = 0; i < colors.length; ++i) {\n            var threshold = {};\n            threshold.min = i * metric.layerRange;\n            threshold.max = threshold.min + metric.layerRange;\n            colorMap.set(threshold, colors[i]);\n        }\n\n        return colorMap;\n    }\n\n    initiliseOverviewData() {\n        this.overviewModel.data = [];\n\n        this.overviewModel.metricList.forEach((metric, index) => {\n            metric.data.forEach((metricInstance) => {\n                var newInstance = _.find(this.overviewModel.data, (search) => {\n                    return metricInstance.metric.instance == search.instance;\n                });\n\n                if (!newInstance) {\n                    newInstance = this.initaliseNewInstance(metricInstance);\n                }\n\n                metricInstance.values.forEach((value) => {\n                    var point = {};\n                    point.date = value[0];\n                    point.value = value[1];\n                    newInstance.metricList[index].push(point);\n                });\n            });\n        });\n    }\n\n    initaliseNewInstance(metricInstance) {\n        var newInstance = {};\n        newInstance.instance = metricInstance.metric.instance;\n        newInstance.metricList = [\n            [],\n            [],\n            []\n        ];\n        this.overviewModel.data.push(newInstance);\n        return newInstance;\n    }\n\n    renderOverview() {\n        if (this.overviewModel.data.length > 0) {\n            this.overviewContext.clearRect(0, 0, this.overviewCanvas.width, this.overviewCanvas.height);\n            this.clearFocus();\n            this.drawOverviewData();\n        }\n    }\n\n    drawOverviewData() {\n        var parent = this;\n\n        this.$timeout(() => {\n            parent.drawOverviewDataWrapper.bind(parent)();\n        }, 100);\n    }\n\n    drawOverviewDataWrapper() {\n        var length = this.getInstanceHorizontalLength();\n\n        if (this.scope.ctrl.overviewMode == \"1\") {\n            this.overviewModel.overviewInstantHeight = this.config.overviewPointHeight * this.overviewModel.metricList.length +\n                this.config.verticalMarginBetweenOverviewMetrics * (this.overviewModel.metricList.length - 1) + this.config.marginBetweenInstances;\n            this.scope.ctrl.overviewWidth = length * this.config.overviewPointWidth;\n            this.scope.ctrl.overviewHeight = this.overviewModel.data.length * this.overviewModel.overviewInstantHeight;\n            this.scope.$apply();\n            this.drawSingleOverview();\n        } else {\n            this.scope.ctrl.overviewWidth = length * this.config.overviewPointWidth;\n            this.scope.ctrl.overviewHeight = this.overviewModel.data.length * this.config.overviewPointHeight;\n            this.scope.$apply();\n            this.drawMultipleOverview();\n        };\n\n        this.scope.ctrl.focusGraphMarginTop = this.scope.ctrl.overviewHeight + this.config.marginBetweenOverviewAndFocus;\n    }\n\n    getInstanceHorizontalLength() {\n        var firstInstance = this.overviewModel.data[0];\n        var length = 0;\n\n        firstInstance.metricList.forEach((metric, index) => {\n            if (this.scope.ctrl.overviewMode == \"1\") {\n                if (metric.length > length) {\n                    length = metric.length;\n                }\n            } else {\n                length += metric.length;\n\n                if (index > 0) {\n                    length += this.config.horizontalMarginBetweenOverviewMetrics;\n                }\n            }\n        });\n\n        return length;\n    }\n\n    drawSingleOverview() {\n        this.overviewModel.data.forEach((instance, instanceIndex) => {\n            instance.y = instanceIndex * this.overviewModel.overviewInstantHeight;\n\n            instance.metricList.forEach((metric, metricIndex) => {\n                metric.forEach((point, pointIndex) => {\n                    point.x = pointIndex * this.config.overviewPointWidth;\n                    point.color = this.getColorFromMap(point.value, this.overviewModel.metricList[metricIndex].colorMap);\n                    this.overviewContext.fillStyle = point.color;\n                    var y = instance.y + metricIndex * this.config.overviewPointHeight * this.config.verticalMarginBetweenOverviewMetrics;\n                    this.overviewContext.fillRect(point.x, y, this.config.overviewPointHeight, this.config.overviewPointHeight);\n                });\n            });\n        });\n    }\n\n    drawMultipleOverview() {\n        this.overviewModel.overviewInstantHeight = this.config.overviewPointHeight;\n\n        this.overviewModel.data.forEach((instance, instanceIndex) => {\n            var endX = 0;\n\n            instance.metricList.forEach((metric, metricIndex) => {\n                instance.y = instanceIndex * this.config.overviewPointHeight;\n                var overviewMetric = this.overviewModel.metricList[metricIndex];\n                overviewMetric.startX = endX;\n\n                if (metricIndex > 0) {\n                    overviewMetric.startX += this.config.horizontalMarginBetweenOverviewMetrics\n                }\n\n                metric.forEach((point, pointIndex) => {\n                    point.x = overviewMetric.startX + pointIndex * this.config.overviewPointWidth;\n                    point.color = this.getColorFromMap(point.value, this.overviewModel.metricList[metricIndex].colorMap);\n                    this.overviewContext.fillStyle = point.color;\n                    this.overviewContext.fillRect(point.x, instance.y, this.config.overviewPointHeight, this.config.overviewPointHeight);\n                    endX = point.x;\n                });\n\n                overviewMetric.endX = endX;\n            });\n        });\n    }\n\n    getColorFromMap(value, map) {\n        var result;\n\n        map.forEach((color, threshold) => {\n            if (threshold.min <= value && value <= threshold.max) {\n                result = color;\n            }\n        });\n\n        return \"#\" + result;\n    }\n\n    initialiseCanvases() {\n        this.overviewCanvas = this.elem.find(\"#overviewCanvas\")[0];\n        this.overviewContext = this.overviewCanvas.getContext(\"2d\");\n\n        this.focusAreaCanvas = this.elem.find(\"#focusAreaCanvas\")[0];\n        this.focusAreaContext = this.focusAreaCanvas.getContext(\"2d\");\n\n        this.focusGraphCanvas = this.elem.find(\"#focusGraphCanvas\")[0];\n        this.focusGraphContext = this.focusGraphCanvas.getContext(\"2d\");\n        this.focusGraphContext.font = this.config.fontSize + \"px arial\";\n    }\n\n    selectOverviewMode() {\n        this.drawOverviewData();\n    }\n\n    selectLinker() {\n        this.drawFocusArea();\n    }\n\n    moveFocusArea(evt) {\n        if (!this.focusAreaIsFixed) {\n            this.drawFocus(evt);\n            evt.preventDefault();\n        }\n    }\n\n    fixFocusArea(evt) {\n        if (this.focusAreaIsFixed) {\n            this.drawFocus(evt);\n        }\n\n        this.focusAreaIsFixed = !this.focusAreaIsFixed;\n        evt.preventDefault();\n    }\n\n    drawFocus(evt) {\n        this.focusModel.mousePosition = this.getMousePos(evt, this.overviewCanvas);\n        this.drawFocusArea();\n        this.drawFocusGraph();\n    }\n\n    clearFocus() {\n        this.hasFocus = false;\n        this.focusAreaContext.clearRect(0, 0, this.focusAreaCanvas.width, this.focusAreaCanvas.height);\n        this.focusGraphContext.clearRect(0, 0, this.focusGraphCanvas.width, this.focusGraphCanvas.height);\n    }\n\n    getMousePos(evt, canvas) {\n        var rect = canvas.getBoundingClientRect();\n\n        return {\n            x: evt.clientX - rect.left,\n            y: evt.clientY - rect.top\n        };\n    }\n\n    drawFocusArea() {\n        if (this.focusModel.mousePosition) {\n            var size = this.getFocusAreaSize();\n            this.focusModel.focusStartY = Math.min(Math.max(0, this.focusModel.mousePosition.y - size / 2), this.overviewCanvas.height - size);\n\n            if (this.scope.ctrl.overviewMode == \"1\") {\n                this.drawSingleFocusArea();\n            } else {\n                this.drawMultipleFocusArea(true);\n            }\n        }\n    }\n\n    getFocusAreaSize() {\n        return this.config.focusAreaSize * 2;\n    }\n\n    drawSingleFocusArea() {\n        this.clearFocus();\n        var size = this.getFocusAreaSize();\n        this.focusModel.focusStartY = Math.min(Math.max(0, this.focusModel.mousePosition.y - size / 2), this.overviewCanvas.height - this.getFocusAreaSize());\n        this.focusModel.focusStartX = Math.min(Math.max(0, this.focusModel.mousePosition.x - this.config.focusAreaSize), this.overviewCanvas.width - size);\n        this.focusAreaContext.strokeStyle = this.config.focusAreaColor;\n        this.focusAreaContext.strokeRect(this.focusModel.focusStartX, this.focusModel.focusStartY, size, size);\n    }\n\n    drawMultipleFocusArea(doDrawLinkers) {\n        var size = this.getFocusAreaSize();\n        var offset = this.getFocusAreaOffset();\n\n        if (offset >= 0) {\n            if (doDrawLinkers) {\n                this.clearFocus();\n            }\n\n            this.focusAreaContext.strokeStyle = this.config.focusAreaColor;\n\n            this.overviewModel.metricList.forEach((metric) => {\n                metric.focusStartX = metric.startX + offset;\n                this.focusAreaContext.strokeRect(metric.focusStartX, this.focusModel.focusStartY, size, size);\n            });\n\n            if (doDrawLinkers) {\n                this.drawLinkers();\n            }\n        }\n    }\n\n    getFocusAreaOffset() {\n        for (var i = 0; i < this.overviewModel.metricList.length; ++i) {\n            var metric = this.overviewModel.metricList[i];\n\n            if (this.checkMouseIsInMetric(metric)) {\n                this.focusModel.mousePositionXOffset = this.focusModel.mousePosition.x - metric.startX;\n                this.focusModel.sourceMetricIndex = i;\n                return Math.min(Math.max(metric.startX,\n                    this.focusModel.mousePosition.x - this.config.focusAreaSize),\n                    metric.endX - this.getFocusAreaSize()) - metric.startX;\n            }\n        }\n    }\n\n    checkMouseIsInMetric(metric) {\n        return metric.startX <= this.focusModel.mousePosition.x && this.focusModel.mousePosition.x <= metric.endX;\n    }\n\n    drawLinkers() {\n        var pixelData = this.overviewContext.getImageData(this.focusModel.mousePosition.x, this.focusModel.mousePosition.y, 1, 1).data;\n        this.focusAreaContext.strokeStyle = \"rgb(\" + pixelData[0] + \",\" + pixelData[1] + \",\" + pixelData[2] + \")\";\n        var instance = this.getLinkerTargetInstance();\n\n        if (instance) {\n            this.overviewModel.metricList.forEach((metric, index) => {\n                if (!this.checkMouseIsInMetric(metric)) {\n                    this.drawLinkerByMode(metric, instance, index);\n                }\n            });\n        }\n    }\n\n    getLinkerTargetInstance() {\n        for (var i = 0; i < this.overviewModel.data.length; ++i) {\n            var instance = this.overviewModel.data[i];\n\n            if (instance.y <= this.focusModel.mousePosition.y && this.focusModel.mousePosition.y <= instance.y + this.config.overviewPointHeight) {\n                return instance;\n            }\n        }\n    }\n\n    drawLinkerByMode(metric, instance, index) {\n        switch (this.scope.ctrl.linkingMode) {\n            case \"xCross\":\n                this.drawXCross(metric, instance);\n                break;\n\n            case \"normalCross\":\n                this.drawNormalCross(metric, instance);\n                break;\n\n            case \"changeColor\":\n                this.changeInstanceColor(metric, instance, index);\n                break;\n\n            default:\n                break;\n        }\n    }\n\n    drawXCross(metric, instance) {\n        var centerX = metric.startX + this.focusModel.mousePositionXOffset;\n        var leftBeginX = centerX - this.config.xCrossSize;\n        var rightBeginX = centerX + this.config.overviewPointWidth;\n        var bottomInstance = instance.y + this.config.overviewPointHeight;\n\n        this.drawXCrossLine(leftBeginX, instance.y - this.config.xCrossSize, instance.y);\n        this.drawXCrossLine(rightBeginX, instance.y, instance.y - this.config.xCrossSize);\n        this.drawXCrossLine(leftBeginX, bottomInstance + this.config.xCrossSize, bottomInstance);\n        this.drawXCrossLine(rightBeginX, bottomInstance, bottomInstance + this.config.xCrossSize);\n    }\n\n    drawXCrossLine(startX, startY, endY) {\n        this.drawLineOnFocusAreaCanvas(startX, startY, startX + this.config.xCrossSize, endY);\n    }\n\n    drawLineOnFocusAreaCanvas(startX, startY, endX, endY) {\n        this.focusAreaContext.beginPath();\n        this.focusAreaContext.moveTo(startX, startY);\n        this.focusAreaContext.lineTo(endX, endY);\n        this.focusAreaContext.stroke();\n        this.focusAreaContext.closePath();\n    }\n\n    drawNormalCross(metric, instance) {\n        var focusSize = this.getFocusAreaSize();\n        var centertX = metric.startX + this.focusModel.mousePositionXOffset;\n        var endX = metric.focusStartX + focusSize;\n        var distanceBetweenLines = this.config.overviewPointWidth * 2;\n        var leftLineX = centertX - distanceBetweenLines;\n        var rightLineX = centertX + distanceBetweenLines;\n        var topLineY = instance.y - distanceBetweenLines;\n        var bottomLineY = instance.y + distanceBetweenLines;\n        var endY = this.focusModel.focusStartY + focusSize;\n\n        this.drawNormalCrossLines(metric, endX, leftLineX, rightLineX, topLineY, bottomLineY, endY);\n    }\n\n    drawNormalCrossLines(metric, endX, leftLineX, rightLineX, topLineY, bottomLineY, endY) {\n        // top horizontal\n        this.drawLineOnFocusAreaCanvas(metric.focusStartX, topLineY, leftLineX, topLineY);\n        this.drawLineOnFocusAreaCanvas(rightLineX, topLineY, endX, topLineY);\n\n        // botton horizontal\n        this.drawLineOnFocusAreaCanvas(metric.focusStartX, bottomLineY, leftLineX, bottomLineY);\n        this.drawLineOnFocusAreaCanvas(rightLineX, bottomLineY, endX, bottomLineY);\n\n        // left vertical\n        this.drawLineOnFocusAreaCanvas(leftLineX, this.focusModel.focusStartY, leftLineX, topLineY);\n        this.drawLineOnFocusAreaCanvas(leftLineX, bottomLineY, leftLineX, endY);\n\n        // right vertical\n        this.drawLineOnFocusAreaCanvas(rightLineX, this.focusModel.focusStartY, rightLineX, topLineY);\n        this.drawLineOnFocusAreaCanvas(rightLineX, bottomLineY, rightLineX, endY);\n    }\n\n    changeInstanceColor(metric, instance, index) {\n        if (index == 0) {\n            this.clearFocus();\n        }\n\n        instance.metricList[index].forEach((instancePoint, pointIndex) => {\n            var colorMap = this.getColorMap(metric, this.config.colors[this.focusModel.sourceMetricIndex]);\n            this.focusAreaContext.fillStyle = this.getColorFromMap(instancePoint.value, colorMap);\n            this.focusAreaContext.fillRect(instancePoint.x, instance.y, this.config.overviewPointHeight, this.config.overviewPointHeight);\n\n            if (instancePoint.x == metric.startX + this.focusModel.mousePositionXOffset) {\n                metric.data.forEach((metricInstance, metricInstanceIndex) => {\n                    var metricPoint = metricInstance.values[pointIndex];\n                    var value = metricPoint ? metricPoint[1] : 0\n                    this.focusAreaContext.fillStyle = this.getColorFromMap(value, colorMap);\n                    this.focusAreaContext.fillRect(instancePoint.x, this.overviewModel.data[metricInstanceIndex].y,\n                        this.config.overviewPointHeight, this.config.overviewPointHeight);\n                });\n            }\n        });\n\n        if (index == instance.metricList.length - 1) {\n            this.drawMultipleFocusArea(false);\n        }\n    }\n\n    drawFocusGraph() {\n        this.initialiseFocusGraphData();\n        this.drawFocusGraphLabels();\n        this.drawFocusGraphData();\n    }\n\n    initialiseFocusGraphData() {\n        this.focusModel.data = [];\n\n        this.overviewModel.data.forEach((overviewInstance) => {\n            if (overviewInstance.y <= this.focusModel.focusStartY + this.getFocusAreaSize() &&\n                overviewInstance.y + this.overviewModel.overviewInstantHeight >= this.focusModel.focusStartY) {\n                var modalInstance = {};\n                modalInstance.instance = overviewInstance.instance;\n                modalInstance.metricList = [];\n                this.addFocusMetrics(modalInstance, overviewInstance, this.getIndexesOfPointsInFocus(overviewInstance));\n                this.initialiseInstanceLayers(modalInstance);\n                this.focusModel.data.push(modalInstance);\n            }\n        });\n    }\n\n    getIndexesOfPointsInFocus(instance) {\n        var indexes = [];\n\n        for (var i = 0; i < instance.metricList.length; ++i) {\n            var metric = instance.metricList[i];\n\n            if (metric.length > 0) {\n                var overviewMetric = this.overviewModel.metricList[i];\n\n                metric.forEach((point, index) => {\n                    if (overviewMetric.focusStartX <= point.x && point.x <= overviewMetric.focusStartX + this.getFocusAreaSize()) {\n                        indexes.push(index);\n                    }\n                });\n\n                break;\n            }\n        }\n\n        return indexes;\n    }\n\n    addFocusMetrics(modalInstance, overviewInstance, indexes) {\n        this.overviewModel.metricList.forEach((metric, metricIndex) => {\n            var focusMetric = {};\n            focusMetric.data = [];\n            focusMetric.layerList = [];\n\n            indexes.forEach((index) => {\n                var point = overviewInstance.metricList[metricIndex][index];\n\n                if (point) {\n                    focusMetric.data.push(point);\n                }\n            });\n\n            modalInstance.metricList.push(focusMetric);\n        });\n    }\n\n    initialiseInstanceLayers(instance) {\n        instance.metricList.forEach((metric, index) => {\n            this.config.colors.forEach(() => {\n                var layer = {};\n                layer.valueList = [];\n                metric.layerList.push(layer);\n            });\n\n            metric.data.forEach((point) => {\n                var value = point.value;\n\n                metric.layerList.forEach((layer) => {\n                    layer.valueList.push(value > 0 ? value : 0);\n                    value -= this.overviewModel.metricList[index].layerRange;\n                });\n            });\n        });\n    }\n\n    drawFocusGraphLabels() {\n        this.focusModel.horizontalX = 0;\n        this.focusGraphContext.setLineDash([10, 10]);\n        this.focusGraphContext.fillStyle = \"black\";\n        this.focusModel.instanceHeight = this.config.focusMetricMaxHeight * this.overviewModel.metricList.length +\n            this.config.marginBetweenFocusMetrics * (this.overviewModel.metricList.length - 1) + this.config.marginBetweenFocusInstances;\n\n        this.focusModel.data.forEach((instance, index) => {\n            this.drawFocusGraphLabelByInstance(instance, index);\n        });\n\n        this.focusModel.horizontalX += this.config.focusGraphLeftMargin;\n    }\n\n    drawFocusGraphLabelByInstance(instance, index) {\n        var label = instance.instance;\n        var metrics = this.focusGraphContext.measureText(label);\n        instance.y = index * this.focusModel.instanceHeight;\n        var labelY = instance.y + this.focusModel.instanceHeight / 2;\n        this.focusGraphContext.fillText(label, 0, labelY);\n\n        if (index > 0) {\n            this.drawSeperator(instance);\n        }\n\n        if (metrics.width > this.focusModel.horizontalX) {\n            this.focusModel.horizontalX = metrics.width;\n        }\n    }\n\n    drawSeperator(instance) {\n        var lineY = instance.y - this.config.marginBetweenFocusInstances / 2;\n        this.focusGraphContext.beginPath();\n        this.focusGraphContext.moveTo(0, lineY);\n        this.focusGraphContext.lineTo(10000, lineY);\n        this.focusGraphContext.stroke();\n    }\n\n    drawFocusGraphData() {\n        this.focusModel.data.forEach((instance) => {\n            instance.metricList.forEach((metric, metricIndex) => {\n                metric.layerList.forEach((layer, layerIndex) => {\n                    var y = instance.y + (this.config.focusMetricMaxHeight + this.config.marginBetweenFocusMetrics) * metricIndex + this.config.focusMetricMaxHeight;\n                    this.focusGraphContext.beginPath();\n                    this.focusGraphContext.moveTo(this.focusModel.horizontalX, y);\n                    var x = this.focusModel.horizontalX;\n                    var previousX = x;\n                    var previousValue = 0;\n\n                    layer.valueList.forEach((value, valueIndex) => {\n                        x += valueIndex * this.config.focusPointWidth;\n                        this.moveContextBasedOnValue(value, previousX, previousValue, layerIndex, x, y, this.overviewModel.metricList[metricIndex].layerRange);\n                        previousX = x;\n                        previousValue = value;\n                    });\n\n                    this.focusGraphContext.lineTo(x, y);\n                    this.focusGraphContext.lineTo(this.focusModel.horizontalX, y);\n                    this.focusGraphContext.closePath();\n                    this.focusGraphContext.fillStyle = \"#\" + this.config.colors[metricIndex][layerIndex];\n                    this.focusGraphContext.fill();\n                });\n            });\n        });\n    }\n\n    moveContextBasedOnValue(value, previousX, previousValue, layerIndex, x, y, layerRange) {\n        if (value == 0) {\n            this.focusGraphContext.lineTo(previousX, y);\n        } else {\n            if (layerIndex > 0 && previousValue == 0) {\n                this.focusGraphContext.lineTo(x, y);\n            }\n\n            if (value >= layerRange) {\n                this.focusGraphContext.lineTo(x, y - this.config.focusMetricMaxHeight);\n            } else {\n                this.focusGraphContext.lineTo(x, y - value * this.config.focusMetricMaxHeight / layerRange);\n            }\n        }\n    }\n\n    selectNode() {\n        if (!this.isUpdatingVariable) {\n            var mousePos = this.getMousePos(event, this.focusGraphCanvas);\n            var height = this.focusModel.instanceHeight;\n\n            for (var i = 0; i < this.focusModel.data.length; ++i) {\n                if (height * i <= mousePos.y && mousePos.y <= height * (i + 1)) {\n                    this.updateVariable(this.focusModel.data[i]);\n                    break;\n                }\n            }\n        }\n    }\n\n    updateVariable(instance) {\n        this.variableSrv.variables.forEach((v) => {\n            if (v.name == \"node\") {\n                this.variableSrv.setOptionAsCurrent(v, {\n                    text: instance.instance,\n                    value: instance.instance\n                });\n\n                this.isUpdatingVariable = true;\n                this.variableSrv.variableUpdated(v, true);\n            }\n        });\n    }\n}\n\nHeatmapCtrl.templateUrl = \"module.html\";"],"file":"heatmap_ctrl.js"}